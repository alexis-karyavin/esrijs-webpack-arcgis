{"code":"(function(){(this||window).webpackJsonp.registerAbsMids({\"esri/arcade/featureSetCollection\":\"./node_modules/arcgis-js-api/arcade/featureSetCollection.js\",\"esri/arcade/featureSetUtils\":\"./node_modules/arcgis-js-api/arcade/featureSetUtils.js\",\"esri/arcade/featureset/actions/Adapted\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/Adapted.js\",\"esri/arcade/featureset/actions/AttributeFilter\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js\",\"esri/arcade/featureset/actions/GroupBy\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/GroupBy.js\",\"esri/arcade/featureset/actions/OrderBy\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js\",\"esri/arcade/featureset/actions/SpatialFilter\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/SpatialFilter.js\",\"esri/arcade/featureset/actions/Top\":\"./node_modules/arcgis-js-api/arcade/featureset/actions/Top.js\",\"esri/arcade/featureset/sources/Empty\":\"./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js\",\"esri/arcade/featureset/sources/FeatureLayerDynamic\":\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerDynamic.js\",\"esri/arcade/featureset/sources/FeatureLayerMemory\":\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerMemory.js\",\"esri/arcade/featureset/sources/FeatureLayerRelated\":\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerRelated.js\",\"esri/arcade/featureset/support/FeatureSet\":\"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\",\"esri/arcade/featureset/support/FeatureSetIterator\":\"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSetIterator.js\",\"esri/arcade/featureset/support/IdSet\":\"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\",\"esri/arcade/featureset/support/OrderbyClause\":\"./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js\",\"esri/arcade/featureset/support/StatsField\":\"./node_modules/arcgis-js-api/arcade/featureset/support/StatsField.js\",\"esri/arcade/featureset/support/cache\":\"./node_modules/arcgis-js-api/arcade/featureset/support/cache.js\",\"esri/arcade/featureset/support/sqlUtils\":\"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\",\"esri/arcade/featureset/support/stats\":\"./node_modules/arcgis-js-api/arcade/featureset/support/stats.js\",\"esri/arcade/functions/featuresetbase\":\"./node_modules/arcgis-js-api/arcade/functions/featuresetbase.js\",\"esri/arcade/functions/featuresetgeom\":\"./node_modules/arcgis-js-api/arcade/functions/featuresetgeom.js\",\"esri/arcade/functions/featuresetstats\":\"./node_modules/arcgis-js-api/arcade/functions/featuresetstats.js\",\"esri/arcade/functions/featuresetstring\":\"./node_modules/arcgis-js-api/arcade/functions/featuresetstring.js\",\"esri/core/MD5\":\"./node_modules/arcgis-js-api/core/MD5.js\",\"esri/geometry/geometryEngineAsync\":\"./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js\"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{\"./node_modules/arcgis-js-api/arcade/featureSetCollection.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r){return function(){function e(){this.declaredRootClass=\"esri.arcade.featureSetCollection\",this._layerById={},this._layerByName={}}return e.prototype.add=function(e,t,r){this._layerById[t]=r,this._layerByName[e]=r},e.prototype.featureSetByName=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=[\"*\"]),void 0===this._layerByName[e]?this.resolvePromise(null):this.resolvePromise(this._layerByName[e])},e.prototype.featureSetById=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=[\"*\"]),void 0===this._layerById[e]?this.resolvePromise(null):this.resolvePromise(this._layerById[e])},e.prototype.castToText=function(){return\"object, FeatureSetCollection\"},e.prototype.resolvePromise=function(e){return r.resolve(e)},e}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureSetCollection.js?')},\"./node_modules/arcgis-js-api/arcade/featureSetUtils.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../request */ \"./node_modules/arcgis-js-api/request.js\"),__webpack_require__(/*! ./featureSetCollection */ \"./node_modules/arcgis-js-api/arcade/featureSetCollection.js\"),__webpack_require__(/*! ./featureset/sources/FeatureLayerDynamic */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerDynamic.js\"),__webpack_require__(/*! ./featureset/sources/FeatureLayerMemory */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerMemory.js\"),__webpack_require__(/*! ./featureset/sources/FeatureLayerRelated */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerRelated.js\"),__webpack_require__(/*! ./featureset/support/cache */ \"./node_modules/arcgis-js-api/arcade/featureset/support/cache.js\"),__webpack_require__(/*! ./featureset/support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../layers/FeatureLayer */ \"./node_modules/arcgis-js-api/layers/FeatureLayer.js\"),__webpack_require__(/*! ../portal/Portal */ \"./node_modules/arcgis-js-api/portal/Portal.js\"),__webpack_require__(/*! ../portal/PortalItem */ \"./node_modules/arcgis-js-api/portal/PortalItem.js\"),__webpack_require__(/*! ./featureset/actions/OrderBy */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js\"),__webpack_require__(/*! ./featureset/actions/Top */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/Top.js\"),__webpack_require__(/*! ./featureset/actions/SpatialFilter */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/SpatialFilter.js\"),__webpack_require__(/*! ./featureset/actions/AttributeFilter */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js\"),__webpack_require__(/*! ./featureset/actions/GroupBy */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/GroupBy.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,a,n,i,l,o,s,u,c,d,f,h,p){function y(e,t){if(s.applicationCache){var r=s.applicationCache.getLayerInfo(e);if(r)return r.then((function(r){return c.resolve(new f({url:e,outFields:t,sourceJSON:r}))}));var a=new f({url:e,outFields:t}),n=c.create((function(e,t){a.load().then((function(){e(a.sourceJSON)}),(function(e){t(e)}))}));return s.applicationCache&&(s.applicationCache.setLayerInfo(e,n),n=n.catch((function(t){throw s.applicationCache.clearLayerInfo(e),t}))),n.then((function(){return c.resolve(a)}))}return c.resolve(new f({url:e,outFields:t}))}function m(e,t,r,a,n){return y(e,[\"*\"]).then((function(e){return c.resolve(v(e,t,r,a,n))}))}function v(e,t,r,a,n){return void 0===t&&(t=null),void 0===r&&(r=null),void 0===a&&(a=!0),void 0===n&&(n=null),!0===e._hasMemorySource()?new l({layer:e,spatialReference:t,outFields:r,includeGeometry:a,lrucache:n}):new i({layer:e,spatialReference:t,outFields:r,includeGeometry:a,lrucache:n})}function _(e){if(null!==s.applicationCache){var t=s.applicationCache.getLayerInfo(e);if(null!==t)return t}var r=a(e,{responseType:\"json\",query:{f:\"json\"}}).then((function(e){if(e.data){var t=e.data;return t.layers||(t.layers=[]),t.tables||(t.tables=[]),c.resolve(t)}return c.resolve({layers:[],tables:[]})}));return null!==s.applicationCache&&(s.applicationCache.setLayerInfo(e,r),r=r.catch((function(t){throw s.applicationCache.clearLayerInfo(e),t}))),r}Object.defineProperty(t,\"__esModule\",{value:!0}),t.initialiseMetaDataCache=function(){null===s.applicationCache&&(s.applicationCache=new s)},t.constructFeatureSetFromUrl=m,t.constructFeatureSet=v,t.constructAssociationMetaDataFeatureSetFromUrl=function(e,t){var n={metadata:null,networkId:-1,unVersion:3,terminals:[],queryelem:null,layerNameLkp:{},lkp:null};return _(e).then((function(i){if(n.metadata=i,i.controllerDatasetLayers&&void 0!==i.controllerDatasetLayers.utilityNetworkLayerId&&null!==i.controllerDatasetLayers.utilityNetworkLayerId){if(i.layers)for(var l=0,o=i.layers;l<o.length;l++){var u=o[l];n.layerNameLkp[u.id]=u.name}if(i.tables)for(var f=0,h=i.tables;f<h.length;f++){u=h[f];n.layerNameLkp[u.id]=u.name}var p=i.controllerDatasetLayers.utilityNetworkLayerId;return n.networkId=p,function(e,t){var r=\"QUERYDATAELEMTS:\"+t.toString()+\":\"+e;if(null!==s.applicationCache){var n=s.applicationCache.getLayerInfo(r);if(null!==n)return n}var i=a(e+\"/queryDataElements\",{method:\"post\",responseType:\"json\",query:{layers:JSON.stringify([t.toString()]),f:\"json\"}}).then((function(e){if(e.data){var t=e.data;if(t.layerDataElements&&t.layerDataElements[0])return t.layerDataElements[0]}throw new Error(\"Not Found\")}));return null!==s.applicationCache&&(s.applicationCache.setLayerInfo(r,i),i=i.catch((function(e){throw s.applicationCache.clearLayerInfo(r),e}))),i}(e,p).then((function(i){if(i){n.queryelem=i,n.queryelem&&n.queryelem.dataElement&&void 0!==n.queryelem.dataElement.schemaGeneration&&(n.unVersion=n.queryelem.dataElement.schemaGeneration),n.lkp={},n.queryelem.dataElement.domainNetworks||(n.queryelem.dataElement.domainNetworks=[]);for(var l=0,o=n.queryelem.dataElement.domainNetworks;l<o.length;l++){for(var u=o[l],f=0,h=u.edgeSources?u.edgeSources:[];f<h.length;f++){(L={layerId:(_=h[f]).layerId,sourceId:_.sourceId,className:n.layerNameLkp[_.layerId]?n.layerNameLkp[_.layerId]:null}).className&&(n.lkp[L.className]=L)}for(var y=0,v=u.junctionSources?u.junctionSources:[];y<v.length;y++){var _,L;(L={layerId:(_=v[y]).layerId,sourceId:_.sourceId,className:n.layerNameLkp[_.layerId]?n.layerNameLkp[_.layerId]:null}).className&&(n.lkp[L.className]=L)}}if(n.queryelem.dataElement.terminalConfigurations)for(var I=0,S=n.queryelem.dataElement.terminalConfigurations;I<S.length;I++)for(var F=0,g=S[I].terminals;F<g.length;F++){var N=g[F];n.terminals.push({terminalId:N.terminalId,terminalName:N.terminalName})}return function(e){if(null!==s.applicationCache){var t=s.applicationCache.getLayerInfo(e);if(null!==t)return t}var r=a(e,{responseType:\"json\",query:{f:\"json\"}}).then((function(e){if(e.data){var t=e.data;return c.resolve(t)}return c.resolve(null)}));return null!==s.applicationCache&&(s.applicationCache.setLayerInfo(e,r),r=r.catch((function(t){throw s.applicationCache.clearLayerInfo(e),t}))),r}(e+\"/\"+p).then((function(a){if(a.systemLayers&&void 0!==a.systemLayers.associationsTableId&&null!==a.systemLayers.associationsTableId){var i=[];return n.unVersion>=4&&(i.push(\"STATUS\"),i.push(\"PERCENTALONG\")),m(e+\"/\"+a.systemLayers.associationsTableId.toString(),t,r.__spreadArrays([\"OBJECTID\",\"FROMNETWORKSOURCEID\",\"TONETWORKSOURCEID\",\"FROMGLOBALID\",\"TOGLOBALID\",\"TOTERMINALID\",\"FROMTERMINALID\",\"ASSOCIATIONTYPE\",\"ISCONTENTVISIBLE\",\"GLOBALID\"],i),!1,null).then((function(e){return e.load()})).then((function(e){return n.unVersion>=4?(e=e.filter(d.WhereClause.create(\"STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62,63)\",e.getFieldsIndex()))).load():e})).then((function(e){return{lkp:n.lkp,associations:e,unVersion:n.unVersion,terminals:n.terminals}}))}return{associations:null,unVersion:n.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:n.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:n.unVersion,lkp:null,terminals:[]}}))},t.constructFeatureSetFromRelationship=function(e,t,r,a,n,i,l){void 0===a&&(a=null),void 0===n&&(n=null),void 0===i&&(i=!0),void 0===l&&(l=null);var s=e.serviceUrl();return s?m(s=\"/\"===s.charAt(s.length-1)?s+t.relatedTableId.toString():s+\"/\"+t.relatedTableId.toString(),a,n,i,l).then((function(s){return new o({layer:e,relatedLayer:s,relationship:t,objectId:r,spatialReference:a,outFields:n,includeGeometry:i,lrucache:l})})):null};var L=function(e){function t(t,r,a){void 0===r&&(r=null),void 0===a&&(a=null);var n=e.call(this)||this;return n._map=t,n._overridespref=r,n.lrucache=a,n._instantLayers=[],n}return r.__extends(t,e),t.prototype.makeAndAddFeatureSet=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=null);var a=v(e,this._overridespref,null===r?[\"*\"]:r,t,this.lrucache);return this._instantLayers.push({featureset:a,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),a},t.prototype.featureSetByName=function(e,t,a){var n=this;if(void 0===t&&(t=!0),void 0===a&&(a=null),void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((function(){try{return n.featureSetByName(e,t,a)}catch(e){return c.reject(e)}}));null===a&&(a=[\"*\"]),a=(a=a.slice(0)).sort();for(var i=JSON.stringify(a),l=0;l<this._instantLayers.length;l++){var o=this._instantLayers[l];if(o.opitem.title===e&&o.includeGeometry===t&&o.outFields===i)return this.resolvePromise(this._instantLayers[l].featureset)}var s=this._map.layers.find((function(t){return t instanceof f&&t.title===e}));if(s)return this.resolvePromise(this.makeAndAddFeatureSet(s,t,a));if(this._map.tables){var u=this._map.tables.find((function(t){return!!(t.title&&t.title===e||t.title&&t.title===e)}));if(u){if(u._materializedTable);else{var d=u.outFields?u:r.__assign(r.__assign({},u),{outFields:[\"*\"]});u._materializedTable=new f(d)}return u._materializedTable.load().then((function(){return n.resolvePromise(n.makeAndAddFeatureSet(u._materializedTable,t,a))}))}}return this.resolvePromise(null)},t.prototype.featureSetById=function(e,t,a){var n=this;if(void 0===t&&(t=!0),void 0===a&&(a=[\"*\"]),void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((function(){try{return n.featureSetById(e,t,a)}catch(e){return c.reject(e)}}));null===a&&(a=[\"*\"]),a=(a=a.slice(0)).sort();for(var i=JSON.stringify(a),l=0;l<this._instantLayers.length;l++){var o=this._instantLayers[l];if(o.opitem.id===e&&o.includeGeometry===t&&o.outFields===i)return this.resolvePromise(this._instantLayers[l].featureset)}var s=this._map.layers.find((function(t){return t instanceof f&&t.id===e}));if(s)return this.resolvePromise(this.makeAndAddFeatureSet(s,t,a));if(this._map.tables){var u=this._map.tables.find((function(t){return t.id===e}));if(u){if(u._materializedTable);else{var d=r.__assign(r.__assign({},u),{outFields:[\"*\"]});u._materializedTable=new f(d)}return u._materializedTable.load().then((function(){return n.resolvePromise(n.makeAndAddFeatureSet(u._materializedTable,t,a))}))}}return this.resolvePromise(null)},t}(n),I=function(e){function t(t,r,a){void 0===r&&(r=null),void 0===a&&(a=null);var n=e.call(this)||this;return n._url=t,n._overridespref=r,n.lrucache=a,n.metadata=null,n._instantLayers=[],n}return r.__extends(t,e),Object.defineProperty(t.prototype,\"url\",{get:function(){return this._url},enumerable:!0,configurable:!0}),t.prototype.makeAndAddFeatureSet=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=null);var a=v(e,this._overridespref,null===r?[\"*\"]:r,t,this.lrucache);return this._instantLayers.push({featureset:a,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),a},t.prototype._loadMetaData=function(){var e=this;return _(this._url).then((function(t){return e.metadata=t,t}))},t.prototype.load=function(){return this._loadMetaData()},t.prototype.clone=function(){return new t(this._url,this._overridespref,this.lrucache)},t.prototype.featureSetByName=function(e,t,r){var a=this;void 0===t&&(t=!0),void 0===r&&(r=null),null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();for(var n=JSON.stringify(r),i=0;i<this._instantLayers.length;i++){var l=this._instantLayers[i];if(l.opitem.title===e&&l.includeGeometry===t&&l.outFields===n)return this.resolvePromise(this._instantLayers[i].featureset)}return this._loadMetaData().then((function(n){for(var i=null,l=0,o=n.layers?n.layers:[];l<o.length;l++){(c=o[l]).name===e&&(i=c)}if(!i)for(var s=0,u=n.tables?n.tables:[];s<u.length;s++){var c;(c=u[s]).name===e&&(i=c)}return i?y(a._url+\"/\"+i.id,[\"*\"]).then((function(e){return a.makeAndAddFeatureSet(e,t,r)})):a.resolvePromise(null)}))},t.prototype.featureSetById=function(e,t,r){var a=this;void 0===t&&(t=!0),void 0===r&&(r=[\"*\"]),null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();var n=JSON.stringify(r);e=null!=e?e.toString():\"\";for(var i=0;i<this._instantLayers.length;i++){var l=this._instantLayers[i];if(l.opitem.id===e&&l.includeGeometry===t&&l.outFields===n)return this.resolvePromise(this._instantLayers[i].featureset)}return this._loadMetaData().then((function(n){for(var i=null,l=0,o=n.layers?n.layers:[];l<o.length;l++){null!==(c=o[l]).id&&void 0!==c.id&&c.id.toString()===e&&(i=c)}if(!i)for(var s=0,u=n.tables?n.tables:[];s<u.length;s++){var c;null!==(c=u[s]).id&&void 0!==c.id&&c.id.toString()===e&&(i=c)}return i?y(a._url+\"/\"+i.id,[\"*\"]).then((function(e){return a.makeAndAddFeatureSet(e,t,r)})):a.resolvePromise(null)}))},t}(n);t.createFeatureSetCollectionFromMap=function(e,t,r){return void 0===r&&(r=null),new L(e,t,r)},t.createFeatureSetCollectionFromService=function(e,t,r){return void 0===r&&(r=null),new I(e,t,r)},t.getPortal=function(e,t){return null===e?t:new h({url:e.field(\"url\")})},t.constructFeatureSetFromPortalItem=function(e,t,r,a,n,i,l){if(s.applicationCache){var o=s.applicationCache.getLayerInfo(e+\":\"+i.url);if(o)return o.then((function(e){try{var i=new f({url:u.extractServiceUrl(e.url)+\"/\"+t,outFields:[\"*\"]});return c.resolve(v(i,r,a,n,l))}catch(e){return c.reject(e)}}),(function(e){return c.reject(e)}))}return c.create((function(o,c){var d=new p({id:e,portal:i}).load();s.applicationCache&&s.applicationCache.setLayerInfo(e+\":\"+i.url,d),d.then((function(e){try{var i=new f({url:u.extractServiceUrl(e.url)+\"/\"+t,outFields:[\"*\"]});o(v(i,r,a,n,l))}catch(e){c(e)}}),(function(t){s.applicationCache&&s.applicationCache.clearLayerInfo(e+\":\"+i.url),c(t)}))}))}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureSetUtils.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/Adapted.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../../Graphic */ \"./node_modules/arcgis-js-api/Graphic.js\"),__webpack_require__(/*! ../../kernel */ \"./node_modules/arcgis-js-api/arcade/kernel.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../../../geometry/SpatialReference */ \"./node_modules/arcgis-js-api/geometry/SpatialReference.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,a,i,n,l,s,o,u,h,d){Object.defineProperty(t,\"__esModule\",{value:!0});var c=function(){function e(){this.sqlRewritable=!1}return e.prototype.postInitialization=function(e,t){},e}();t.AdaptedField=c;var p=function(e){function t(t){var r=e.call(this)||this;return r.field=t,r.sqlRewritable=!0,r}return r.__extends(t,e),t.prototype.extractValue=function(e){return e.attributes[this.field.name]},t.prototype.rewriteSql=function(e){return{rewritten:this.sqlRewritable,where:e}},t}(c);t.OriginalField=p;var f=function(e){function t(t,r,a){var i=e.call(this)||this;return i.originalField=t,i.sqlRewritable=!0,i.field=s.cloneField(t),i.field.name=r,i.field.alias=a,i}return r.__extends(t,e),t.prototype.rewriteSql=function(e,t){return{rewritten:this.sqlRewritable,where:o.reformulateWithoutField(e,this.field.name,this.originalField.name,t.getFieldsIndex())}},t.prototype.extractValue=function(e){return e.attributes[this.originalField.name]},t}(c);t.FieldRename=f;var v=function(e){function t(t,r,a){var i=e.call(this)||this;for(var n in i.field=t,i.codefield=r,i.lkp=a,i.reverseLkp={},a)i.reverseLkp[a[n]]=n;return i.sqlRewritable=!0,i}return r.__extends(t,e),t.prototype.rewriteSql=function(e,r){var a=this.evaluateNodeToWhereClause(e.parseTree,s.FeatureServiceDatabaseType.Standardised,this.field.name,this.codefield instanceof h.WhereClause?o.toWhereClause(this.codefield,s.FeatureServiceDatabaseType.Standardised):this.codefield,e.parameters);return a.indexOf(t.BADNESS)>=0?{rewritten:!1,where:e}:{rewritten:this.sqlRewritable,where:h.WhereClause.create(a,r._parent.getFieldsIndex())}},t.prototype.evaluateNodeToWhereClause=function(e,r,a,i,n){var l,s,u,h;switch(void 0===a&&(a=null),void 0===i&&(i=null),e.type){case\"interval\":return o.convertIntervalToSql(this.evaluateNodeToWhereClause(e.value,r,a,i,n),e.qualifier,e.op);case\"case_expression\":var d=\" CASE \";\"simple\"===e.format&&(d+=this.evaluateNodeToWhereClause(e.operand,r,a,t.BADNESS,n));for(var c=0;c<e.clauses.length;c++)d+=\" WHEN \"+this.evaluateNodeToWhereClause(e.clauses[c].operand,r,a,t.BADNESS,n)+\" THEN \"+this.evaluateNodeToWhereClause(e.clauses[c].value,r,a,t.BADNESS,n);return null!==e.else&&(d+=\" ELSE \"+this.evaluateNodeToWhereClause(e.else,r,a,t.BADNESS,n)),d+=\" END \";case\"param\":var p=n[e.value.toLowerCase()];if(\"string\"==typeof p)return\"\\'\"+n[e.value.toLowerCase()].toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\";if(p instanceof Date)return o.makeDateString(p,r);if(p instanceof Array){var f=[];for(c=0;c<p.length;c++)\"string\"==typeof p[c]?f.push(\"\\'\"+p[c].toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\"):p[c]instanceof Date?f.push(o.makeDateString(p[c],r)):f.push(p[c].toString());return f}return p.toString();case\"expr_list\":s=[];for(var v=0,g=e.value;v<g.length;v++){var _=g[v];s.push(this.evaluateNodeToWhereClause(_,r,a,i,n))}return s;case\"unary_expr\":return\" ( NOT \"+this.evaluateNodeToWhereClause(e.expr,r,a,t.BADNESS,n)+\" ) \";case\"binary_expr\":switch(e.operator){case\"AND\":return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" AND \"+this.evaluateNodeToWhereClause(e.right,r,a,i,n)+\") \";case\"OR\":return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" OR \"+this.evaluateNodeToWhereClause(e.right,r,a,i,n)+\") \";case\"IS\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IS NULL )\";case\"ISNOT\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IS NOT NULL )\";case\"IN\":if(l=[],\"expr_list\"===e.right.type){if(\"column_ref\"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){for(var S=[],N=!0,w=0,C=e.right.value;w<C.length;w++){if(\"string\"!==(F=C[w]).type){N=!1;break}if(void 0===this.lkp[F.value]){N=!1;break}S.push(this.lkp[F.value].toString())}if(N)return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IN (\"+S.join(\",\")+\")) \"}return l=this.evaluateNodeToWhereClause(e.right,r,a,i,n),\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IN (\"+l.join(\",\")+\")) \"}return(h=this.evaluateNodeToWhereClause(e.right,r,a,i,n))instanceof Array?\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IN (\"+h.join(\",\")+\")) \":\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" IN (\"+h+\")) \";case\"NOT IN\":if(l=[],\"expr_list\"===e.right.type){if(\"column_ref\"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){S=[],N=!0;for(var m=0,T=e.right.value;m<T.length;m++){var F;if(\"string\"!==(F=T[m]).type){N=!1;break}if(void 0===this.lkp[F.value]){N=!1;break}S.push(this.lkp[F.value].toString())}if(N)return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" NOT IN (\"+S.join(\",\")+\")) \"}return l=this.evaluateNodeToWhereClause(e.right,r,a,i,n),\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" NOT IN (\"+l.join(\",\")+\")) \"}return(h=this.evaluateNodeToWhereClause(e.right,r,a,i,n))instanceof Array?\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" NOT IN (\"+h.join(\",\")+\")) \":\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,i,n)+\" NOT IN (\"+h+\")) \";case\"BETWEEN\":return u=this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n),\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" BETWEEN \"+u[0]+\" AND \"+u[1]+\" ) \";case\"NOTBETWEEN\":return u=this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n),\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" NOT BETWEEN \"+u[0]+\" AND \"+u[1]+\" ) \";case\"LIKE\":return\"\"!==e.escape?\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" LIKE \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\" ESCAPE \\'\"+e.escape+\"\\') \":\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" LIKE \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\") \";case\"NOT LIKE\":return\"\"!==e.escape?\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" NOT LIKE \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\" ESCAPE \\'\"+e.escape+\"\\') \":\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" NOT LIKE \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\") \";case\"<>\":case\"=\":if(\"column_ref\"===e.left.type&&\"string\"===e.right.type){if(e.left.column.toUpperCase()===this.field.name.toUpperCase()&&void 0!==this.lkp[e.right.value.toString()])return\" (\"+i+\" \"+e.operator+\" \"+this.lkp[e.right.value.toString()].toString()+\") \"}else if(\"column_ref\"===e.right.type&&\"string\"===e.left.type&&e.right.column.toUpperCase()===this.field.name.toUpperCase())return\" (\"+this.lkp[e.right.value.toString()].toString()+\" \"+e.operator+\" \"+i+\") \";return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" \"+e.operator+\" \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\") \";case\"<\":case\">\":case\">=\":case\"<=\":case\"*\":case\"-\":case\"+\":case\"/\":return\" (\"+this.evaluateNodeToWhereClause(e.left,r,a,t.BADNESS,n)+\" \"+e.operator+\" \"+this.evaluateNodeToWhereClause(e.right,r,a,t.BADNESS,n)+\") \"}throw new Error(\"Not Supported Operator \"+e.operator);case\"null\":return\"null\";case\"bool\":return!0===e.value?\"1\":\"0\";case\"string\":return\"\\'\"+e.value.toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\";case\"timestamp\":case\"date\":return o.makeDateString(e.value,r);case\"number\":return e.value.toString();case\"current_time\":return o.makeToday(\"date\"===e.mode,r);case\"column_ref\":return a&&a.toLowerCase()===e.column.toLowerCase()?\"(\"+i+\")\":e.column;case\"function\":var y=this.evaluateNodeToWhereClause(e.args,r,a,t.BADNESS,n);return o.translateFunctionToDatabaseSpecific(e.name,y,r)}throw new Error(\"Unsupported sql syntax \"+e.type)},t.prototype.extractValue=function(e){return this.codefield instanceof h.WhereClause?this.reverseLkp[this.codefield.calculateValueCompiled(e)]:this.reverseLkp[e.attributes[this.codefield]]},t.BADNESS=\"_!!!_BAD_LKP_!!!!\",t}(c);t.StringToCodeAdapted=v;var g=function(e){function t(t,r){var a=e.call(this)||this;return a.field=t,a.sql=r,a}return r.__extends(t,e),t.prototype.rewriteSql=function(e,t){return{rewritten:!0,where:o.reformulateWithoutField(e,this.field.name,o.toWhereClause(this.sql,s.FeatureServiceDatabaseType.Standardised),t.getFieldsIndex())}},t.prototype.extractValue=function(e){return this.sql.calculateValueCompiled(e)},t}(c);t.SqlExpressionAdapted=g;var _=function(e){function t(t){var r=e.call(this,t)||this;return r._calcFunc=null,r.declaredClass=\"esri.arcade.featureset.actions.Adapted\",r.adaptedFields=null,r._extraFilter=null,r._extraFilter=t.extraFilter,r._parent=t.parentfeatureset,r._maxProcessing=30,r.adaptedFields=t.adaptedFields,r}return r.__extends(t,e),t.findField=function(e,t){for(var r=0,a=e;r<a.length;r++){var i=a[r];if(i.name.toLowerCase()===t.toString().toLowerCase())return i}return null},t.prototype._initialiseFeatureSet=function(){null!==this._parent?(this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.spatialReference=new d({wkid:4326}),this.objectIdField=\"\",this.geometryType=s.layerGeometryEsriConstants.point,this.typeIdField=\"\",this.types=null),this.fields=[];for(var e=0,t=this.adaptedFields;e<t.length;e++){var r=t[e];r.postInitialization(this,this._parent),this.fields.push(r.field)}},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._extraFilter?t._getFilteredSet(\"\",null,null,null,e):t._parent._getSet(e)})).then((function(r){return t._checkCancelled(e),t._wset=new l(r._candidates.slice(0),r._known.slice(0),r._ordered,t._clonePageDefinition(r.pagesDefinition)),t._wset})):u.resolve(this._wset)},t.prototype._isInFeatureSet=function(e){return this._parent._isInFeatureSet(e)},t.prototype._getFeatures=function(e,t,r,n){var s=this,o=[];-1!==t&&void 0===this._featureCache[t]&&o.push(t);var h=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(e,h))return this._expandPagedSet(e,h,0,0,n).then((function(){return s._getFeatures(e,t,r,n)}));for(var d=0,c=e._lastFetchedIndex;c<e._known.length&&(++d<=r&&(e._lastFetchedIndex+=1),!(void 0===this._featureCache[e._known[c]]&&(e._known[c]!==t&&o.push(e._known[c]),o.length>=h-1)));c++);if(0===o.length)return u.resolve(\"success\");e=new l([],o,e._ordered,null);var p=Math.min(o.length,r);return this._parent._getFeatures(e,-1,p,n).then((function(){s._checkCancelled(n);for(var e=[],t=0;t<p;t++){var r=s._parent._featureFromCache(o[t]);void 0!==r&&e.push({geometry:r.geometry,attributes:r.attributes,id:o[t]})}for(var l=0,u=e;l<u.length;l++){for(var h=u[l],d=[],c=0,f=s.adaptedFields;c<f.length;c++){var v=f[c];d[v.field.name]=v.extractValue(h)}s._featureCache[h.id]=new a({attributes:d,geometry:i.cloneGeometry(h.geometry)})}return\"success\"}))},t.prototype._fetchAndRefineFeatures=function(){return u.reject(new Error(\"Fetch and Refine should not be called in this featureset\"))},t.prototype._getFilteredSet=function(e,t,r,a,i){var n,s=this,u=this.reformulateWithoutAdaptions(r);n=u.cannot,r=u.where;var h=!1;if(null!==a){h=!0;for(var d=[],c=0,v=this.adaptedFields;c<v.length;c++){var g=v[c];if(!(g instanceof p)&&!0===a.scanForField(g.field.name)){if(!(g instanceof f)){a=null,h=!1;break}d.push({field:g.field.name,newfield:g.originalField.name})}}a&&d.length>0&&(a=a.replaceFields(d))}return null!==r?null!==this._extraFilter&&(r=o.combine(this._extraFilter,r)):r=this._extraFilter,this._ensureLoaded().then((function(){return s._parent._getFilteredSet(e,t,r,a,i)})).then((function(e){return s._checkCancelled(i),!0===n?new l(e._candidates.slice(0).concat(e._known.slice(0)),[],!0===h&&e._ordered,s._clonePageDefinition(e.pagesDefinition)):new l(e._candidates.slice(0),e._known.slice(0),!0===h&&e._ordered,s._clonePageDefinition(e.pagesDefinition))}))},t.prototype.reformulateWithoutAdaptions=function(e){var t={cannot:!1,where:e};if(null!==e)for(var r=0,a=this.adaptedFields;r<a.length;r++){var i=a[r];if(!0===o.scanForField(e,i.field.name)){var n=i.rewriteSql(e,this);if(!0!==n.rewritten){t.cannot=!0,t.where=null;break}t.where=n.where}}return t},t.prototype._stat=function(e,t,r,a,i,n,l){var s=this,h=!1,d=this.reformulateWithoutAdaptions(t);return h=d.cannot,t=d.where,d=this.reformulateWithoutAdaptions(i),h=h||d.cannot,null!==(i=d.where)?null!==this._extraFilter&&(i=o.combine(this._extraFilter,i)):i=this._extraFilter,!0===h?null===i&&\"\"===r&&null===a?this._manualStat(e,t,n,l):u.resolve({calculated:!1}):this._parent._stat(e,t,r,a,i,n,l).then((function(o){return!1===o.calculated?null===i&&\"\"===r&&null===a?s._manualStat(e,t,n,l):{calculated:!1}:o}))},t.prototype._canDoAggregates=function(e,t,r,a,i){if(null===this._parent)return u.resolve(!1);for(var n=0;n<e.length;n++)for(var l=0,s=this.adaptedFields;l<s.length;l++){var h=s[l];if(e[n].toLowerCase()===h.field.name.toLowerCase()&&!(h instanceof p))return u.resolve(!1)}var d=[];for(n=0;n<t.length;n++){var c=t[n];if(null!==c.workingexpr){var f=this.reformulateWithoutAdaptions(c.workingexpr);if(f.cannot)return u.resolve(!1);var v=c.clone();v.workingexpr=f.where,d.push(v)}else d.push(c)}var g=this.reformulateWithoutAdaptions(i);return g.cannot?u.resolve(!1):(null!==(i=g.where)?null!==this._extraFilter&&(i=o.combine(this._extraFilter,i)):i=this._extraFilter,this._parent._canDoAggregates(e,d,r,a,i))},t.prototype._getAggregatePagesDataSourceDefinition=function(e,t,r,a,i,n,l){if(null===this._parent)return u.reject(new Error(\"Should never be called\"));for(var s=[],h=0;h<t.length;h++){var d=t[h];if(null!==d.workingexpr){var c=this.reformulateWithoutAdaptions(d.workingexpr);if(c.cannot)return u.reject(new Error(\"Should never be called\"));var p=d.clone();p.workingexpr=c.where,s.push(p)}else s.push(d)}var f=this.reformulateWithoutAdaptions(i);return f.cannot?u.reject(new Error(\"Should never be called\")):(null!==(i=f.where)?null!==this._extraFilter&&(i=o.combine(this._extraFilter,i)):i=this._extraFilter,this._parent._getAggregatePagesDataSourceDefinition(e,s,r,a,i,n,l))},t}(n);t.AdaptedFeatureSet=_}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/Adapted.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../../../geometry/SpatialReference */ \"./node_modules/arcgis-js-api/geometry/SpatialReference.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,n,r,s,i,a,u,l,o){var c=function(e){function t(t){var n=e.call(this,t)||this;return n.declaredClass=\"esri.arcade.featureset.actions.AttributeFilter\",n._maxProcessing=1e3,n._parent=t.parentfeatureset,t.whereclause instanceof l.WhereClause?(n._whereclause=t.whereclause,n._whereClauseFunction=null):(n._whereClauseFunction=t.whereclause,n._whereclause=null),n}return n.__extends(t,e),t.prototype._initialiseFeatureSet=function(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField=\"\",this.objectIdField=\"\",this.spatialReference=new o({wkid:4326}),this.geometryType=i.layerGeometryEsriConstants.point)},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._parent._getFilteredSet(\"\",null,t._whereclause,null,e)})).then((function(n){return t._checkCancelled(e),null!==t._whereClauseFunction?t._wset=new s(n._candidates.slice(0).concat(n._known.slice(0)),[],n._ordered,t._clonePageDefinition(n.pagesDefinition)):t._wset=new s(n._candidates.slice(0),n._known.slice(0),n._ordered,t._clonePageDefinition(n.pagesDefinition)),t._wset})):u.resolve(this._wset)},t.prototype._isInFeatureSet=function(e){var t=this._parent._isInFeatureSet(e);return t===i.IdState.NotInFeatureSet?t:void 0===(t=this._idstates[e])?i.IdState.Unknown:t},t.prototype._getFeature=function(e,t,n){return this._parent._getFeature(e,t,n)},t.prototype._getFeatures=function(e,t,n,r){return this._parent._getFeatures(e,t,n,r)},t.prototype._featureFromCache=function(e){return this._parent._featureFromCache(e)},t.prototype.executeWhereClause=function(e){return this._whereclause.testFeature(e)},t.prototype.executeWhereClauseDeferred=function(e){if(null!==this._whereClauseFunction)try{var t=this._whereClauseFunction(e);return u.isPromiseLike(t)?t:u.resolve(t)}catch(e){return u.reject(e)}return u.resolve(this.executeWhereClause(e))},t.prototype._fetchAndRefineFeatures=function(e,t,n){var r=this,a=new s([],e,!1,null),l=Math.min(t,e.length);return this._parent._getFeatures(a,-1,l,n).then((function(){if(r._checkCancelled(n),null==r._whereClauseFunction){for(var s=0;s<l;s++){var a=r._parent._featureFromCache(e[s]);!0===r.executeWhereClause(a)?r._idstates[e[s]]=i.IdState.InFeatureSet:r._idstates[e[s]]=i.IdState.NotInFeatureSet}return\"success\"}var o=[];for(s=0;s<l;s++){a=r._parent._featureFromCache(e[s]);o.push(r.executeWhereClauseDeferred(a))}return u.all(o).then((function(n){for(var s=0;s<t;s++)!0===n[s]?r._idstates[e[s]]=i.IdState.InFeatureSet:r._idstates[e[s]]=i.IdState.NotInFeatureSet;return\"success\"}))}))},t.prototype._getFilteredSet=function(e,t,n,r,i){var u=this;return null!==this._whereClauseFunction||(null!==n?null!==this._whereclause&&(n=a.combine(this._whereclause,n)):n=this._whereclause),this._ensureLoaded().then((function(){return u._parent._getFilteredSet(e,t,n,r,i)})).then((function(e){return u._checkCancelled(i),null!==u._whereClauseFunction?new s(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,u._clonePageDefinition(e.pagesDefinition)):new s(e._candidates.slice(0),e._known.slice(0),e._ordered,u._clonePageDefinition(e.pagesDefinition))}))},t.prototype._stat=function(e,t,n,r,s,i,l){var o=this;if(null!==this._whereClauseFunction)return null===s&&\"\"===n&&null===r?this._manualStat(e,t,i,l):u.resolve({calculated:!1});var c=this._whereclause;return null!==s&&null!==this._whereclause&&(c=a.combine(this._whereclause,s)),this._parent._stat(e,t,n,r,c,i,l).then((function(a){return!1===a.calculated?null===s&&\"\"===n&&null===r?o._manualStat(e,t,i,l):{calculated:!1}:a}))},t.prototype._canDoAggregates=function(e,t,n,r,s){return null!==this._whereClauseFunction?u.resolve(!1):(null!==s?null!==this._whereclause&&(s=a.combine(this._whereclause,s)):s=this._whereclause,null===this._parent?u.resolve(!1):this._parent._canDoAggregates(e,t,n,r,s))},t.prototype._getAggregatePagesDataSourceDefinition=function(e,t,n,r,s,i,l){return null===this._parent?u.reject(new Error(\"Should never be called\")):(null!==s?null!==this._whereclause&&(s=a.combine(this._whereclause,s)):s=this._whereclause,this._parent._getAggregatePagesDataSourceDefinition(e,t,n,r,s,i,l))},t}(r);return r._featuresetFunctions.filter=function(e){if(\"function\"==typeof e)return new c({parentfeatureset:this,whereclause:e});var t=null;return e instanceof l.WhereClause&&(t=e),new c({parentfeatureset:this,whereclause:t})},c}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/GroupBy.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../../Graphic */ \"./node_modules/arcgis-js-api/Graphic.js\"),__webpack_require__(/*! ../../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ./Adapted */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/Adapted.js\"),__webpack_require__(/*! ./AttributeFilter */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js\"),__webpack_require__(/*! ./OrderBy */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/OrderbyClause */ \"./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../support/stats */ \"./node_modules/arcgis-js-api/arcade/featureset/support/stats.js\"),__webpack_require__(/*! ../support/StatsField */ \"./node_modules/arcgis-js-api/arcade/featureset/support/StatsField.js\"),__webpack_require__(/*! ../../../core/MD5 */ \"./node_modules/arcgis-js-api/core/MD5.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../../../geometry/SpatialReference */ \"./node_modules/arcgis-js-api/geometry/SpatialReference.js\"),__webpack_require__(/*! ../../../layers/support/Field */ \"./node_modules/arcgis-js-api/layers/support/Field.js\"),__webpack_require__(/*! ../../../layers/support/FieldsIndex */ \"./node_modules/arcgis-js-api/layers/support/FieldsIndex.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,i,r,n,a,s,l,o,d,u,f,p,c,g,h,_,y,m,b,v,F){function w(e){if(!e)return\"COUNT\";switch(e.toLowerCase()){case\"max\":return\"MAX\";case\"var\":case\"variance\":return\"VAR\";case\"avg\":case\"average\":case\"mean\":return\"AVG\";case\"min\":return\"MIN\";case\"sum\":return\"SUM\";case\"stdev\":case\"stddev\":return\"STDDEV\";case\"count\":return\"COUNT\"}return\"COUNT\"}var S=function(e){function t(t){var i=e.call(this,t)||this;return i._decodedStatsfield=[],i._decodedGroupbyfield=[],i._candosimplegroupby=!0,i.phsyicalgroupbyfields=[],i.objectIdField=\"ROW__ID\",i._internalObjectIdField=\"ROW__ID\",i._adaptedFields=[],i.declaredClass=\"esri.arcade.featureset.actions.Aggregate\",i._uniqueIds=1,i._maxQuery=10,i._maxProcessing=10,i._parent=t.parentfeatureset,i._config=t,i}return i.__extends(t,e),t.prototype.isTable=function(){return!0},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._getFilteredSet(\"\",null,null,null,e).then((function(e){return t._wset=e,t._wset})):y.resolve(this._wset)},t.prototype._isInFeatureSet=function(){return f.IdState.InFeatureSet},t.prototype.nextUniqueName=function(e){for(;1===e[\"T\"+this._uniqueIds.toString()];)this._uniqueIds++;var t=\"T\"+this._uniqueIds.toString();return e[t]=1,t},t.prototype.convertToEsriFieldType=function(e){return e},t.prototype._initialiseFeatureSet=function(){var e={},t=!1,i=1,r=this._parent?this._parent.getFieldsIndex():new F([]);for(this.objectIdField=\"ROW__ID\";!1===t;){for(var n=!1,s=0;s<this._config.groupbyfields.length;s++)if(this._config.groupbyfields[s].name.toLowerCase()===this.objectIdField.toLowerCase()){n=!0;break}if(!1===n)for(s=0;s<this._config.statsfields.length;s++)if(this._config.statsfields[s].name.toLowerCase()===this.objectIdField.toLowerCase()){n=!0;break}!1===n?t=!0:(this.objectIdField=\"ROW__ID\"+i.toString(),i++)}for(var l=0,o=this._config.statsfields;l<o.length;l++){var d=o[l],u=new h;u.field=d.name,u.tofieldname=d.name,u.workingexpr=d.expression instanceof m.WhereClause?d.expression:m.WhereClause.create(d.expression,r),u.typeofstat=w(d.statistic),this._decodedStatsfield.push(u)}this._decodedGroupbyfield=[];for(var g=0,_=this._config.groupbyfields;g<_.length;g++){var y={name:(d=_[g]).name,singlefield:null,tofieldname:d.name,expression:d.expression instanceof m.WhereClause?d.expression:m.WhereClause.create(d.expression,r)};this._decodedGroupbyfield.push(y)}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=\"\";for(var S=0,I=this._parent.fields;S<I.length;S++){e[(d=I[S]).name.toUpperCase()]=1}this.types=null}else this.geometryType=f.layerGeometryEsriConstants.point,this.typeIdField=\"\",this.types=null,this.spatialReference=new b({wkid:4326});this.fields=[];var x=new h;x.field=this.nextUniqueName(e),x.tofieldname=this.objectIdField,x.workingexpr=m.WhereClause.create(this._parent.objectIdField,this._parent.getFieldsIndex()),x.typeofstat=\"MIN\",this._decodedStatsfield.push(x);for(var D=0,k=this._decodedGroupbyfield;D<k.length;D++){var C=k[D],A=new v;if(C.name=this.nextUniqueName(e),A.name=C.tofieldname,A.alias=A.name,p.isSingleField(C.expression)){if(!(O=this._parent.getField(c.toWhereClause(C.expression,f.FeatureServiceDatabaseType.Standardised))))throw new Error(\"Field is not present for Aggregation\");C.name=O.name,C.singlefield=O.name,this.phsyicalgroupbyfields.push(O.name),A.type=O.type}else{A.type=this.convertToEsriFieldType(c.predictType(C.expression,this._parent.fields));var T=new v;T.name=C.name,T.alias=T.name,this.phsyicalgroupbyfields.push(C.name),this._adaptedFields.push(new a.SqlExpressionAdapted(T,C.expression)),this._candosimplegroupby=!1}this.fields.push(A)}if(this._adaptedFields.length>0)for(var G=0,W=this._parent.fields;G<W.length;G++){d=W[G];this._adaptedFields.push(new a.OriginalField(d))}for(s=0;s<this._decodedStatsfield.length;s++){A=new v;var O=null;(C=this._decodedStatsfield[s]).field=this.nextUniqueName(e),C.tofieldname===this.objectIdField&&(this._internalObjectIdField=C.field),A.name=C.tofieldname,A.alias=A.name;var j=null!==C.workingexpr&&p.isSingleField(C.workingexpr)?c.toWhereClause(C.workingexpr,f.FeatureServiceDatabaseType.Standardised):\"\";switch(this._decodedStatsfield[s].typeofstat){case\"SUM\":if(\"\"!==j){if(!(O=this._parent.getField(j)))throw new Error(\"Field is not present for Aggregation\");A.type=O.type}else A.type=\"double\";break;case\"MIN\":case\"MAX\":if(\"\"!==j){if(!(O=this._parent.getField(j)))throw new Error(\"Field is not present for Aggregation\");A.type=O.type}else A.type=\"double\";break;case\"COUNT\":A.type=\"integer\";break;case\"STDDEV\":case\"VAR\":case\"AVG\":if(\"\"!==j&&!(O=this._parent.getField(j)))throw new Error(\"Field is not present for Aggregation\");A.type=\"double\"}this.fields.push(A)}},t.prototype._canDoAggregates=function(){return y.resolve(!1)},t.prototype._getFeatures=function(e,t,i,r){var n=this;-1!==t&&void 0===this._featureCache[t]&&[].push(t);var a=this._maxQuery;return!0===this._checkIfNeedToExpandKnownPage(e,a)?this._expandPagedSet(e,a,0,0,r).then((function(){return n._getFeatures(e,t,i,r)})):y.resolve(\"success\")},t.prototype._getFilteredSet=function(e,t,i,r,n){var o=this;if(\"\"!==e)return y.resolve(new d([],[],!0,null));var f=null,c={ordered:!1,nowhereclause:!1};return this._ensureLoaded().then((function(){if(null!==i)for(var e=0;e<o._decodedStatsfield.length;e++)if(!0===p.scanForField(i,o._decodedStatsfield[e].tofieldname)){c.nowhereclause=!0,i=null;break}if(null!==r){c.ordered=!0;for(e=0;e<o._decodedStatsfield.length;e++)if(!0===r.scanForField(o._decodedStatsfield[e].tofieldname)){r=null,c.ordered=!1;break}if(null!==r)for(var t=0,n=o._decodedGroupbyfield;t<n.length;t++){var a=n[t];if(null===a.singlefield&&!0===r.scanForField(a.tofieldname)){r=null,c.ordered=!1;break}}}return!1===o._candosimplegroupby?y.resolve(!1):o._parent._canDoAggregates(o.phsyicalgroupbyfields,o._decodedStatsfield,\"\",null,null)})).then((function(e){if(e){var t=null;i&&(t=o._reformulateWhereClauseWithoutGroupByFields(i));var p=null;return r&&(p=o._reformulateOrderClauseWithoutGroupByFields(r)),o._parent._getAggregatePagesDataSourceDefinition(o.phsyicalgroupbyfields,o._decodedStatsfield,\"\",null,t,p,o._internalObjectIdField).then((function(e){return o._checkCancelled(n),f=!0===c.nowhereclause?new d(e._candidates.slice(0).concat(e._known.slice(0)),[],!0===c.ordered&&e._ordered,o._clonePageDefinition(e.pagesDefinition)):new d(e._candidates.slice(0),e._known.slice(0),!0===c.ordered&&e._ordered,o._clonePageDefinition(e.pagesDefinition))}))}var g=o._parent;if(o._adaptedFields.length>0&&(g=new a.AdaptedFeatureSet({parentfeatureset:o._parent,adaptedFields:o._adaptedFields,extraFilter:null})),!0===c.nowhereclause)f=new d([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:o._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new l({parentfeatureset:g,orderbyclause:new u(o.phsyicalgroupbyfields.join(\",\")+\",\"+o._parent.objectIdField+\" ASC\")})}});else{var h=g;if(null!==i){var _=null;i&&(_=o._reformulateWhereClauseWithoutGroupByFields(i)),h=new s({parentfeatureset:h,whereclause:_})}f=new d([\"GETPAGES\"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:o._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:\"manual\",iterator:null,set:[],subfeatureset:new l({parentfeatureset:h,orderbyclause:new u(o.phsyicalgroupbyfields.join(\",\")+\",\"+o._parent.objectIdField+\" ASC\")})}})}return f}))},t.prototype._reformulateWhereClauseWithoutStatsFields=function(e){for(var t=0,i=this._decodedStatsfield;t<i.length;t++){var r=i[t];e=c.reformulateWithoutField(e,r.tofieldname,c.toWhereClause(r.workingexpr,f.FeatureServiceDatabaseType.Standardised),this._parent.getFieldsIndex())}return e},t.prototype._reformulateWhereClauseWithoutGroupByFields=function(e){for(var t=0,i=this._decodedGroupbyfield;t<i.length;t++){var r=i[t];r.tofieldname!==r.name&&(e=c.reformulateWithoutField(e,r.tofieldname,c.toWhereClause(r.expression,f.FeatureServiceDatabaseType.Standardised),this._parent.getFieldsIndex()))}return e},t.prototype._reformulateOrderClauseWithoutGroupByFields=function(e){for(var t=[],i=0,r=this._decodedGroupbyfield;i<r.length;i++){var n=r[i];n.tofieldname!==n.name&&t.push({field:n.tofieldname,newfield:n.name})}return t.length>0?e.replaceFields(t):e},t.prototype._clonePageDefinition=function(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)},t.prototype._refineSetBlock=function(e,t,i){var r=this;try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQuery))return this._expandPagedSet(e,this._maxQuery,0,0,i).then((function(){return r._refineSetBlock(e,t,i)}));this._checkCancelled(i);var n=e._candidates.length;this._refineKnowns(e,t);e._candidates.length;return e._candidates.length,y.resolve(e)}catch(e){return y.reject(e)}},t.prototype._expandPagedSet=function(e,t,i,r,n){return this._expandPagedSetFeatureSet(e,t,i,r,n)},t.prototype._getPhysicalPage=function(e,t,i){var n=this;return!0===e.pagesDefinition.aggregatefeaturesetpagedefinition?y.create((function(t,r){n._sequentialGetPhysicalItem(e,e.pagesDefinition.resultRecordCount,i,[]).then((function(e){t(e)}),r)})):this._getAgregagtePhysicalPage(e,t,i).then((function(e){for(var t=0,i=e;t<i.length;t++){for(var a=i[t],s={geometry:a.geometry,attributes:{}},l=0,o=n._decodedGroupbyfield;l<o.length;l++){var d=o[l];s.attributes[d.tofieldname]=a.attributes[d.name]}for(var u=0,f=n._decodedStatsfield;u<f.length;u++){d=f[u];s.attributes[d.tofieldname]=a.attributes[d.field]}n._featureCache[s.attributes[n.objectIdField]]=new r(s)}return e.length}))},t.prototype._sequentialGetPhysicalItem=function(e,t,i,r){var n=this;return y.create((function(a,s){null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(i)),!0===e.pagesDefinition.internal.fullyResolved?a(r.length):0===t?a(r.length):n._nextAggregateItem(e,t,i,r,(function(s){null===s?a(r.length):(t-=1,a(n._sequentialGetPhysicalItem(e,t,i,r)))}),s)}))},t.prototype._nextAggregateItem=function(e,t,i,r,a,s){var l=this;try{n.tick(e.pagesDefinition.internal.iterator.next()).then((function(n){if(null===n)if(null!==e.pagesDefinition.internal.workingItem){var o=l._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);r.push(o),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(o.attributes[l.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,a(null)}else e.pagesDefinition.internal.fullyResolved=!0,a(null);else{var d=l._generateAggregateHash(n);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[n],id:d};else{if(d!==e.pagesDefinition.internal.workingItem.id){o=l._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return r.push(o),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(o.attributes[l.objectIdField]),t-=1,e.pagesDefinition.internal.workingItem={features:[n],id:d},void a(o)}e.pagesDefinition.internal.workingItem.features.push(n)}l._nextAggregateItem(e,t,i,r,a,s)}}),s)}catch(e){s(e)}},t.prototype._calculateFieldStat=function(e,t,i){for(var r=[],n=0;n<e.features.length;n++)if(null!==t.workingexpr){var a=t.workingexpr.calculateValue(e.features[n]);null!==a&&r.push(a)}else r.push(null);switch(t.typeofstat){case\"MIN\":i.attributes[t.tofieldname]=g.calculateStat(\"min\",r,-1);break;case\"MAX\":i.attributes[t.tofieldname]=g.calculateStat(\"max\",r,-1);break;case\"SUM\":i.attributes[t.tofieldname]=g.calculateStat(\"sum\",r,-1);break;case\"COUNT\":i.attributes[t.tofieldname]=r.length;break;case\"VAR\":i.attributes[t.tofieldname]=g.calculateStat(\"var\",r,-1);break;case\"STDDEV\":i.attributes[t.tofieldname]=g.calculateStat(\"stddev\",r,-1);break;case\"AVG\":i.attributes[t.tofieldname]=g.calculateStat(\"avg\",r,-1)}return!0},t.prototype._calculateAndAppendAggregateItem=function(e){for(var t={attributes:{},geometry:null},i=0,n=this._decodedGroupbyfield;i<n.length;i++){var a=n[i],s=a.singlefield?e.features[0].attributes[a.singlefield]:a.expression.calculateValue(e.features[0]);t.attributes[a.tofieldname]=s}for(var l=0,o=this._decodedStatsfield;l<o.length;l++){var d=o[l];this._calculateFieldStat(e,d,t)}for(var u=[],f=0;f<this._decodedStatsfield.length;f++)u.push(this._calculateFieldStat(e,this._decodedStatsfield[f],t));return this._featureCache[t.attributes[this.objectIdField]]=new r({attributes:t.attributes,geometry:t.geometry}),t},t.prototype._generateAggregateHash=function(e){for(var t=\"\",i=0,r=this._decodedGroupbyfield;i<r.length;i++){var n=r[i],a=n.singlefield?e.attributes[n.singlefield]:n.expression.calculateValue(e);t+=null==a?\":\":\":\"+a.toString()}return _.createMD5Hash(t,_.outputTypes.String)},t.prototype._stat=function(){return y.resolve({calculated:!1})},t.prototype.getFeatureByObjectId=function(){return y.resolve(null)},t}(o);return o._featuresetFunctions.groupby=function(e,t){return new S({parentfeatureset:this,groupbyfields:e,statsfields:t})},S}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/GroupBy.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/OrderbyClause */ \"./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,n,r,i,u,a,o){var s=function(e){function t(t){var n=e.call(this,t)||this;return n._orderbyclause=null,n.declaredClass=\"esri.arcade.featureset.actions.OrderBy\",n._maxProcessing=100,n._orderbyclause=t.orderbyclause,n._parent=t.parentfeatureset,n}return n.__extends(t,e),t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._getFilteredSet(\"\",null,null,t._orderbyclause,e)})).then((function(n){return t._checkCancelled(e),t._wset=n,t._wset})):o.resolve(this._wset)},t.prototype.manualOrderSet=function(e,t){var n=this;return this.getIdColumnDictionary(e,[],-1,t).then((function(e){n._orderbyclause.order(e);for(var t=new u([],[],!0,null),r=0;r<e.length;r++)t._known.push(e[r].id);return t}))},t.prototype.getIdColumnDictionary=function(e,t,n,i){var u=this;if(n<e._known.length-1){var a=this._maxQueryRate();if(\"GETPAGES\"===e._known[n+1])return r.tick(this._parent._expandPagedSet(e,a,0,0,i)).then((function(){return u.getIdColumnDictionary(e,t,n,i)}));for(var s=n+1,c=[];s<e._known.length&&\"GETPAGES\"!==e._known[s];)c.push(e._known[s]),s++;return n+=c.length,r.tick(this._parent._getFeatureBatch(c,i)).then((function(r){u._checkCancelled(i);for(var a=0,o=r;a<o.length;a++){var s=o[a];t.push({id:s.attributes[u.objectIdField],feature:s})}return u.getIdColumnDictionary(e,t,n,i)}))}return e._candidates.length>0?r.tick(this._refineSetBlock(e,this._maxProcessingRate(),i)).then((function(){return u._checkCancelled(i),u.getIdColumnDictionary(e,t,n,i)})):o.resolve(t)},t.prototype._isInFeatureSet=function(e){return this._parent._isInFeatureSet(e)},t.prototype._getFeatures=function(e,t,n,r){return this._parent._getFeatures(e,t,n,r)},t.prototype._featureFromCache=function(e){if(void 0===this._featureCache[e]){var t=this._parent._featureFromCache(e);if(void 0===t)return;return null===t?null:(this._featureCache[e]=t,t)}return this._featureCache[e]},t.prototype._fetchAndRefineFeatures=function(){return o.reject(new Error(\"Fetch and Refine should not be called in this featureset\"))},t.prototype._getFilteredSet=function(e,t,n,r,i){var a=this;return this._ensureLoaded().then((function(){return a._parent._getFilteredSet(e,t,n,null===r?a._orderbyclause:r,i)})).then((function(e){var r;a._checkCancelled(i),r=new u(e._candidates.slice(0),e._known.slice(0),e._ordered,a._clonePageDefinition(e.pagesDefinition));var o=!0;return e._candidates.length>0&&(o=!1),!1===r._ordered?a.manualOrderSet(r,i).then((function(e){return!1===o&&(null===t&&null===n||(e=new u(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,a._clonePageDefinition(e.pagesDefinition)))),e})):r}))},t}(i);return i._featuresetFunctions.orderBy=function(e){return\"\"===e?this:new s({parentfeatureset:this,orderbyclause:new a(e)})},s}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/SpatialFilter.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../sources/Empty */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../geometry/geometryEngineAsync */ \"./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,n,r,i,a,s,o,l){var u=function(e){function t(t){var n=e.call(this,t)||this;return n._relation=\"\",n._relationGeom=null,n._relationString=\"\",n.declaredClass=\"esri.arcade.featureset.actions.SpatialFilter\",n._relationString=t.relationString,n._parent=t.parentfeatureset,n._maxProcessing=40,n._relation=t.relation,n._relationGeom=t.relationGeom,n}return n.__extends(t,e),t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._parent._getFilteredSet(\"esriSpatialRelRelation\"!==t._relation?t._relation:t._relation+\":\"+t._relationString,t._relationGeom,null,null,e)})).then((function(n){return t._checkCancelled(e),t._wset=new a(n._candidates.slice(0),n._known.slice(0),n._ordered,t._clonePageDefinition(n.pagesDefinition)),t._wset})):o.resolve(this._wset)},t.prototype._isInFeatureSet=function(e){var t=this._parent._isInFeatureSet(e);return t===s.IdState.NotInFeatureSet?t:void 0===(t=this._idstates[e])?s.IdState.Unknown:t},t.prototype._getFeature=function(e,t,n){return this._parent._getFeature(e,t,n)},t.prototype._getFeatures=function(e,t,n,r){return this._parent._getFeatures(e,t,n,r)},t.prototype._featureFromCache=function(e){return this._parent._featureFromCache(e)},t.prototype.executeSpatialRelationTest=function(e){if(null===e.geometry)return o.resolve(!1);switch(this._relation){case\"esriSpatialRelEnvelopeIntersects\":var t=s.shapeExtent(this._relationGeom),n=s.shapeExtent(e.geometry);return l.intersects(t,n);case\"esriSpatialRelIntersects\":return l.intersects(this._relationGeom,e.geometry);case\"esriSpatialRelContains\":return l.contains(this._relationGeom,e.geometry);case\"esriSpatialRelOverlaps\":return l.overlaps(this._relationGeom,e.geometry);case\"esriSpatialRelWithin\":return l.within(this._relationGeom,e.geometry);case\"esriSpatialRelTouches\":return l.touches(this._relationGeom,e.geometry);case\"esriSpatialRelCrosses\":return l.crosses(this._relationGeom,e.geometry);case\"esriSpatialRelRelation\":return l.relate(this._relationGeom,e.geometry,this._relationString)}},t.prototype._fetchAndRefineFeatures=function(e,t,n){var r=this,i=new a([],e,!1,null),l=Math.min(t,e.length);return this._parent._getFeatures(i,-1,l,n).then((function(){r._checkCancelled(n);for(var t=[],i=0;i<l;i++){var a=r._parent._featureFromCache(e[i]);t.push(r.executeSpatialRelationTest(a))}return o.all(t)})).then((function(n){for(var i=0;i<t;i++)!0===n[i]?r._idstates[e[i]]=s.IdState.InFeatureSet:r._idstates[e[i]]=s.IdState.NotInFeatureSet;return\"success\"}))},t.prototype._getFilteredSet=function(e,t,n,r,i){var s=this;return this._ensureLoaded().then((function(){return s._parent._getFilteredSet(\"esriSpatialRelRelation\"!==s._relation?s._relation:s._relation+\":\"+s._relationString,s._relationGeom,n,r,i)})).then((function(e){return s._checkCancelled(i),null!==t?new a(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,s._clonePageDefinition(e.pagesDefinition)):new a(e._candidates.slice(0),e._known.slice(0),e._ordered,s._clonePageDefinition(e.pagesDefinition))}))},t.prototype._stat=function(e,t,n,r,i,a,s){var l=this;return\"\"!==n?o.resolve({calculated:!1}):this._parent._stat(e,t,\"esriSpatialRelRelation\"!==this._relation?this._relation:this._relation+\":\"+this._relationString,this._relationGeom,i,a,s).then((function(o){return!1===o.calculated?null===i&&\"\"===n&&null===r?l._manualStat(e,t,a,s):{calculated:!1}:o}))},t.prototype._canDoAggregates=function(e,t,n,r,i){return\"\"!==n||null!==r?o.resolve(!1):null===this._parent?o.resolve(!1):this._parent._canDoAggregates(e,t,\"esriSpatialRelRelation\"!==this._relation?this._relation:this._relation+\":\"+this._relationString,this._relationGeom,i)},t.prototype._getAggregatePagesDataSourceDefinition=function(e,t,n,r,i,a,s){return null===this._parent?o.reject(new Error(\"Should never be called\")):this._parent._getAggregatePagesDataSourceDefinition(e,t,\"esriSpatialRelRelation\"!==this._relation?this._relation:this._relation+\":\"+this._relationString,this._relationGeom,i,a,s)},t}(i);return i._featuresetFunctions.intersects=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelIntersects\",relationGeom:e})},i._featuresetFunctions.envelopeIntersects=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelEnvelopeIntersects\",relationGeom:e})},i._featuresetFunctions.contains=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelContains\",relationGeom:e})},i._featuresetFunctions.overlaps=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelOverlaps\",relationGeom:e})},i._featuresetFunctions.within=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelWithin\",relationGeom:e})},i._featuresetFunctions.touches=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelTouches\",relationGeom:e})},i._featuresetFunctions.crosses=function(e){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelCrosses\",relationGeom:e})},i._featuresetFunctions.relate=function(e,t){return null==e?new r({parentfeatureset:this}):new u({parentfeatureset:this,relation:\"esriSpatialRelRelation\",relationGeom:e,relationString:t})},u}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/SpatialFilter.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/actions/Top.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(t,e,n,r,s,a,o){var i=function(t){function e(e){var n=t.call(this,e)||this;return n._topnum=0,n.declaredClass=\"esri.arcade.featureset.actions.Top\",n._countedin=0,n._maxProcessing=100,n._topnum=e.topnum,n._parent=e.parentfeatureset,n}return n.__extends(e,t),e.prototype._getSet=function(t){var e=this;return null===this._wset?this._ensureLoaded().then((function(){return e._parent._getSet(t)})).then((function(t){return e._wset=new s(t._candidates.slice(0),t._known.slice(0),!1,e._clonePageDefinition(t.pagesDefinition)),e._setKnownLength(e._wset)>e._topnum&&(e._wset._known=e._wset._known.slice(0,e._topnum)),e._setKnownLength(e._wset)>=e._topnum&&(e._wset._candidates=[]),e._wset})):o.resolve(this._wset)},e.prototype._setKnownLength=function(t){return t._known.length>0&&\"GETPAGES\"===t._known[t._known.length-1]?t._known.length-1:t._known.length},e.prototype._isInFeatureSet=function(t){var e=this._parent._isInFeatureSet(t);if(e===a.IdState.NotInFeatureSet)return e;var n=this._idstates[t];return n===a.IdState.InFeatureSet||n===a.IdState.NotInFeatureSet?n:e===a.IdState.InFeatureSet&&void 0===n?this._countedin<this._topnum?(this._idstates[t]=a.IdState.InFeatureSet,this._countedin++,a.IdState.InFeatureSet):(this._idstates[t]=a.IdState.NotInFeatureSet,a.IdState.NotInFeatureSet):a.IdState.Unknown},e.prototype._expandPagedSet=function(t,e,n,r,s){var a=this;if(null===this._parent)return o.reject(new Error(\"Parent Paging not implemented\"));if(e>this._topnum&&(e=this._topnum),this._countedin>=this._topnum&&t.pagesDefinition.internal.set.length<=t.pagesDefinition.resultOffset){var i=t._known.length;return i>0&&\"GETPAGES\"===t._known[i-1]&&(t._known.length=i-1),(i=t._candidates.length)>0&&\"GETPAGES\"===t._candidates[i-1]&&(t._candidates.length=i-1),o.resolve(\"success\")}return this._parent._expandPagedSet(t,e,n,r,s).then((function(e){return a._setKnownLength(t)>a._topnum&&(t._known.length=a._topnum),a._setKnownLength(t)>=a._topnum&&(t._candidates.length=0),e}))},e.prototype._getFeatures=function(t,e,n,r){var a=this,i=[],u=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(t,u))return this._expandPagedSet(t,u,0,0,r).then((function(){return a._getFeatures(t,e,n,r)}));-1!==e&&void 0===this._featureCache[e]&&i.push(e);for(var _=0,h=t._lastFetchedIndex;h<t._known.length&&(++_<=n&&(t._lastFetchedIndex+=1),!(void 0===this._featureCache[t._known[h]]&&(t._known[h]!==e&&i.push(t._known[h]),i.length>u-1)));h++);if(0===i.length)return o.resolve(\"success\");var d=new s([],i,!1,null),c=Math.min(i.length,n);return this._parent._getFeatures(d,-1,c,r).then((function(){for(var t=0;t<c;t++){var e=a._parent._featureFromCache(i[t]);void 0!==e&&(a._featureCache[i[t]]=e)}return\"success\"}))},e.prototype._getFilteredSet=function(t,e,n,r,a){var o=this;return this._ensureLoaded().then((function(){return o._getSet(a)})).then((function(t){return new s(t._candidates.slice(0).concat(t._known.slice(0)),[],!1,o._clonePageDefinition(t.pagesDefinition))}))},e.prototype._refineKnowns=function(t,e){for(var n=0,r=null,s=[],o=0;o<t._candidates.length;o++){var i=this._isInFeatureSet(t._candidates[o]);if(i===a.IdState.InFeatureSet){if(t._known.push(t._candidates[o]),n+=1,null===r?r={start:o,end:o}:r.end===o-1?r.end=o:(s.push(r),r={start:o,end:o}),t._known.length>=this._topnum)break}else if(i===a.IdState.NotInFeatureSet)null===r?r={start:o,end:o}:r.end===o-1?r.end=o:(s.push(r),r={start:o,end:o}),n+=1;else if(i===a.IdState.Unknown)break;if(n>=e)break}null!==r&&s.push(r);for(var u=s.length-1;u>=0;u--)t._candidates.splice(s[u].start,s[u].end-s[u].start+1);this._setKnownLength(t)>this._topnum&&(t._known=t._known.slice(0,this._topnum)),this._setKnownLength(t)>=this._topnum&&(t._candidates=[])},e.prototype._stat=function(){return o.resolve({calculated:!1})},e.prototype._canDoAggregates=function(){return o.resolve(!1)},e}(r);return r._featuresetFunctions.top=function(t){return new i({parentfeatureset:this,topnum:t})},i}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/actions/Top.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,n,o,u,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.declaredClass=\"esri.layers.featureset.sources.Empty\",r._maxProcessing=1e3,r._wset=new o([],[],!1,null),r._parent=t.parentfeatureset,r._databaseType=u.FeatureServiceDatabaseType.Standardised,r}return r.__extends(t,e),t.prototype._getSet=function(){return s.resolve(this._wset)},t.prototype.optimisePagingFeatureQueries=function(){},t.prototype._isInFeatureSet=function(){return u.IdState.NotInFeatureSet},t.prototype._getFeature=function(){return s.reject(new Error(\"No Feature Found in EmptySet\"))},t.prototype.queryAttachments=function(){return s.resolve([])},t.prototype._getFeatures=function(){return s.resolve(\"success\")},t.prototype._featureFromCache=function(){return null},t.prototype._fetchAndRefineFeatures=function(){return s.reject(new Error(\"Fetch and Refine should not be called in this featureset\"))},t.prototype._getFilteredSet=function(){return s.resolve(new o([],[],!1,null))},t.prototype._stat=function(e,t,r,n,o,u,s){return this._manualStat(e,t,u,s)},t.prototype._canDoAggregates=function(){return s.resolve(!1)},t}(n)}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerDynamic.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../../Graphic */ \"./node_modules/arcgis-js-api/Graphic.js\"),__webpack_require__(/*! ../../../request */ \"./node_modules/arcgis-js-api/request.js\"),__webpack_require__(/*! ../../Attachment */ \"./node_modules/arcgis-js-api/arcade/Attachment.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../support/stats */ \"./node_modules/arcgis-js-api/arcade/featureset/support/stats.js\"),__webpack_require__(/*! ../../../core/MD5 */ \"./node_modules/arcgis-js-api/core/MD5.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../geometry/support/jsonUtils */ \"./node_modules/arcgis-js-api/geometry/support/jsonUtils.js\"),__webpack_require__(/*! ../../../layers/FeatureLayer */ \"./node_modules/arcgis-js-api/layers/FeatureLayer.js\"),__webpack_require__(/*! ../../../layers/graphics/featureConversionUtils */ \"./node_modules/arcgis-js-api/layers/graphics/featureConversionUtils.js\"),__webpack_require__(/*! ../../../tasks/QueryTask */ \"./node_modules/arcgis-js-api/tasks/QueryTask.js\"),__webpack_require__(/*! ../../../tasks/operations/query */ \"./node_modules/arcgis-js-api/tasks/operations/query.js\"),__webpack_require__(/*! ../../../tasks/support/FeatureSet */ \"./node_modules/arcgis-js-api/tasks/support/FeatureSet.js\"),__webpack_require__(/*! ../../../tasks/support/Query */ \"./node_modules/arcgis-js-api/tasks/support/Query.js\"),__webpack_require__(/*! ../../../tasks/support/StatisticDefinition */ \"./node_modules/arcgis-js-api/tasks/support/StatisticDefinition.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,i,a,n,s,l,o,u,d,p,c,y,f,h,_,g,m,v,F,S){return function(e){function t(t){var r=e.call(this,t)||this;return r.declaredClass=\"esri.arcade.featureset.sources.FeatureLayerDynamic\",r._removeGeometry=!1,r._overrideFields=null,r.formulaCredential=null,r._pageJustIds=!1,r._requestStandardised=!1,t.spatialReference&&(r.spatialReference=t.spatialReference),r._transparent=!0,r._maxProcessing=1e3,r._layer=t.layer,r._wset=null,void 0!==t.outFields&&(r._overrideFields=t.outFields),void 0!==t.includeGeometry&&(r._removeGeometry=!1===t.includeGeometry),r}return r.__extends(t,e),t.prototype._maxQueryRate=function(){return o.defaultMaxRecords},t.prototype.end=function(){return this._layer},t.prototype.optimisePagingFeatureQueries=function(e){this._pageJustIds=e},t.prototype.convertQueryToLruCacheKey=function(e){var t=o.stableStringify(e.toJSON());return c.createMD5Hash(t,c.outputTypes.String)},t.prototype.load=function(){var e=this;return null===this._loadPromise&&(this._loadPromise=y.create((function(t,r){try{if(!0===e._layer.loaded)return e._initialiseFeatureSet(),void t(e);e._layer.when().then((function(){try{e._initialiseFeatureSet(),t(e)}catch(e){r(e)}}),r),e._layer.load()}catch(e){r(e)}}))),this._loadPromise},t.prototype._initialiseFeatureSet=function(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&\"*\"===this._layer.outFields[0]);else{for(var e=[],t=0,r=this.fields;t<r.length;t++){if(\"oid\"===(u=r[t]).type)e.push(u);else for(var i=0,a=this._layer.outFields;i<a.length;i++){if(a[i].toLowerCase()===u.name.toLowerCase()){e.push(u);break}}}this.fields=e}else;if(null!==this._overrideFields)if(1===this._overrideFields.length&&\"*\"===this._overrideFields[0])this._overrideFields=null;else{e=[];for(var n=[],s=0,l=this.fields;s<l.length;s++){var u;if(\"oid\"===(u=l[s]).type)e.push(u),n.push(u.name);else for(var d=0,p=this._overrideFields;d<p.length;d++){if(p[d].toLowerCase()===u.name.toLowerCase()){e.push(u),n.push(u.name);break}}}this.fields=e,this._overrideFields=n}if(this._layer.source&&this._layer.source.sourceJSON){var c=this._layer.source.sourceJSON.currentVersion;!0===this._layer.source.sourceJSON.useStandardizedQueries?(this._databaseType=o.FeatureServiceDatabaseType.StandardisedNoInterval,null!=c&&c>=10.61&&(this._databaseType=o.FeatureServiceDatabaseType.Standardised)):null!=c&&(c>=10.5&&(this._databaseType=o.FeatureServiceDatabaseType.StandardisedNoInterval,this._requestStandardised=!0),c>=10.61&&(this._databaseType=o.FeatureServiceDatabaseType.Standardised))}this.objectIdField=this._layer.objectIdField,this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this.typeIdField=this._layer.typeIdField,this.types=this._layer.types},t.prototype._isInFeatureSet=function(){return o.IdState.InFeatureSet},t.prototype._refineSetBlock=function(e){return y.resolve(e)},t.prototype._candidateIdTransform=function(e){return e},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._getFilteredSet(\"\",null,null,null,e)})).then((function(e){return t._wset=e,e})):y.resolve(this._wset)},t.prototype._runDatabaseProbe=function(e){var t=this;return y.create((function(r,i){try{t._ensureLoaded().then((function(){try{var a=new F;a.where=e.replace(\"OBJECTID\",t._layer.objectIdField),t._layer.queryObjectIds(a).then((function(){r(!0)}),(function(){try{r(!1)}catch(e){i(e)}}))}catch(e){i(e)}}))}catch(e){i(e)}}))},t.prototype._canUsePagination=function(){return!(!this._layer.capabilities||!this._layer.capabilities.query||!0!==this._layer.capabilities.query.supportsPagination)},t.prototype._cacheableFeatureSetSourceKey=function(){return this._layer.url},t.prototype.pbfSupportedForQuery=function(e){return!e.outStatistics&&this._layer&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsFormatPBF&&!0===this._layer.capabilities.query.supportsQuantizationEditMode},t.prototype.queryPBF=function(e){return e.quantizationParameters={mode:\"edit\"},m.executeQueryPBF(this._layer.parsedUrl,e,{type:\"optimized\"}).then((function(e){return v.fromJSON(_.convertToFeatureSet(e.data)).unquantize()}))},t.prototype.nativeCapabilities=function(){return{title:this._layer.title,source:this,canQueryRelated:!0,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:this._requestStandardised}},t.prototype.executeQuery=function(e,t){var r=this,i=new g({url:this._layer.parsedUrl.path}),a=\"execute\"===t&&this.pbfSupportedForQuery(e),n=null;if(this.recentlyUsedQueries){var s=this.convertQueryToLruCacheKey(e);null===(n=this.recentlyUsedQueries.getFromCache(s))&&(n=!0!==a?i[t](e):this.queryPBF(e),this.recentlyUsedQueries.addToCache(s,n),n=n.catch((function(e){throw r.recentlyUsedQueries.removeFromCache(s),e})))}return null===n&&(n=!0!==a?i[t](e):this.queryPBF(e)),n},t.prototype._getFilteredSet=function(e,t,r,i,a){var n=this;return this.databaseType().then((function(s){if(n.isTable()&&t&&null!==e&&\"\"!==e)return new l([],[],!0,null);if(n._canUsePagination())return n._getFilteredSetUsingPaging(e,t,r,i,a);var o=\"\",d=!1;null!==i&&n._layer.capabilities&&n._layer.capabilities.query&&!0===n._layer.capabilities.query.supportsOrderBy&&(o=i.constructClause(),d=!0);var p=new F;return p.where=null===r?null===t?\"1=1\":\"\":u.toWhereClause(r,s),n._requestStandardised&&(p.sqlFormat=\"standard\"),p.spatialRelationship=n._makeRelationshipEnum(e),p.outSpatialReference=n.spatialReference,p.orderByFields=\"\"!==o?o.split(\",\"):null,p.geometry=null===t?null:t,p.relationParameter=n._makeRelationshipParam(e),n.executeQuery(p,\"executeForIds\").then((function(e){return null===e&&(e=[]),n._checkCancelled(a),new l([],e,d,null)}))}))},t.prototype._expandPagedSet=function(e,t,r,i,a){return this._expandPagedSetFeatureSet(e,t,r,i,a)},t.prototype._getFilteredSetUsingPaging=function(e,t,r,i,a){var n=this;try{var s=\"\",o=!1;return null!==i&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(s=i.constructClause(),o=!0),this.databaseType().then((function(i){var d=null===r?null===t?\"1=1\":\"\":u.toWhereClause(r,i);n._layer.definitionExpression&&(d=\"\"!==d?\"((\"+n._layer.definitionExpression+\") AND (\"+d+\"))\":n._layer.definitionExpression);var p=n._maxQueryRate(),c=n._layer.capabilities.query.maxRecordCount;void 0!==c&&c<p&&(p=c);var y=null;if(!0===n._pageJustIds)y=new l([],[\"GETPAGES\"],o,{spatialRel:n._makeRelationshipEnum(e),relationParam:n._makeRelationshipParam(e),outFields:n._layer.objectIdField,resultRecordCount:p,resultOffset:0,geometry:null===t?null:t,where:d,orderByFields:s,returnGeometry:!1,returnIdsOnly:\"false\",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}});else{var f=!0;!0===n._removeGeometry&&(f=!1);var h=null!==n._overrideFields?n._overrideFields:n._fieldsIncludingObjectId(n._layer.outFields?n._layer.outFields:[\"*\"]);y=new l([],[\"GETPAGES\"],o,{spatialRel:n._makeRelationshipEnum(e),relationParam:n._makeRelationshipParam(e),outFields:h.join(\",\"),resultRecordCount:p,resultOffset:0,geometry:null===t?null:t,where:d,orderByFields:s,returnGeometry:f,returnIdsOnly:\"false\",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}return n._expandPagedSet(y,p,0,1,a).then((function(){return y}))}))}catch(e){return y.reject(e)}},t.prototype._clonePageDefinition=function(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}},t.prototype._getPhysicalPage=function(e,t,r){var i=this;try{var a=e.pagesDefinition.internal.lastRetrieved,n=a,s=e.pagesDefinition.internal.lastPage,l=new F;return this._requestStandardised&&(l.sqlFormat=\"standard\"),l.spatialRelationship=e.pagesDefinition.spatialRel,l.relationParameter=e.pagesDefinition.relationParam,l.outFields=e.pagesDefinition.outFields.split(\",\"),l.num=e.pagesDefinition.resultRecordCount,l.start=e.pagesDefinition.internal.lastPage,l.geometry=e.pagesDefinition.geometry,l.where=e.pagesDefinition.where,l.orderByFields=\"\"!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(\",\"):null,l.returnGeometry=e.pagesDefinition.returnGeometry,l.outSpatialReference=this.spatialReference,this.executeQuery(l,\"execute\").then((function(t){if(i._checkCancelled(r),e.pagesDefinition.internal.lastPage!==s)return\"done\";for(var l=0;l<t.features.length;l++)e.pagesDefinition.internal.set[n+l]=t.features[l].attributes[i._layer.objectIdField];if(!1===i._pageJustIds)for(l=0;l<t.features.length;l++)i._featureCache[t.features[l].attributes[i._layer.objectIdField]]=t.features[l];return(void 0===t.exceededTransferLimit&&t.features.length!==e.pagesDefinition.resultRecordCount||!1===t.exceededTransferLimit)&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=a+t.features.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,\"done\"}))}catch(e){return y.reject(e)}},t.prototype._fieldsIncludingObjectId=function(e){if(null===e)return[this.objectIdField];var t=e.slice(0);if(t.indexOf(\"*\")>-1)return t;for(var r=!1,i=0,a=t;i<a.length;i++){if(a[i].toUpperCase()===this.objectIdField.toUpperCase()){r=!0;break}}return!1===r&&t.push(this.objectIdField),t},t.prototype._getFeatures=function(e,t,r,i){var a=this,n=[];try{if(-1!==t&&void 0===this._featureCache[t]&&n.push(t),!0===this._checkIfNeedToExpandKnownPage(e,this._maxProcessingRate()))return this._expandPagedSet(e,this._maxProcessingRate(),0,0,i).then((function(){return a._getFeatures(e,t,r,i)}));for(var s=0,l=e._lastFetchedIndex;l<e._known.length;l++){if(e._lastFetchedIndex+=1,s++,void 0===this._featureCache[e._known[l]]){var o=!1;if(null!==this._layer._mode&&void 0!==this._layer._mode){var u=this._layer._mode;if(void 0!==u._featureMap[e._known[l]]){var d=u._featureMap[e._known[l]];null!==d&&(o=!0,this._featureCache[e._known[l]]=d)}}if(!1===o&&(e._known[l]!==t&&n.push(e._known[l]),n.length>=this._maxProcessingRate()-1))break}if(s>=r&&0===n.length)break}if(0===n.length)return y.resolve(\"success\");try{var p=new F;return this._requestStandardised&&(p.sqlFormat=\"standard\"),p.objectIds=n,p.outFields=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:[\"*\"]),p.returnGeometry=!0,!0===this._removeGeometry&&(p.returnGeometry=!1),p.outSpatialReference=this.spatialReference,this.executeQuery(p,\"execute\").then((function(e){if(a._checkCancelled(i),void 0!==e.error)return y.reject(new Error(e.error));for(var t=0;t<e.features.length;t++)a._featureCache[e.features[t].attributes[a._layer.objectIdField]]=e.features[t];return\"success\"}))}catch(e){return y.reject(e)}}catch(e){return y.reject(e)}},t.prototype._getDistinctPages=function(e,t,r,i,a,n,s,l,o){var d=this;return this._ensureLoaded().then((function(){return d.databaseType()})).then((function(p){for(var c=r.parseTree.column,f=0;f<d._layer.fields.length;f++)if(d._layer.fields[f].name.toLowerCase()===c.toLowerCase()){c=d._layer.fields[f].name;break}var h=new F;d._requestStandardised&&(h.sqlFormat=\"standard\");var _=null===n?null===a?\"1=1\":\"\":u.toWhereClause(n,p);return d._layer.definitionExpression&&(_=\"\"!==_?\"((\"+d._layer.definitionExpression+\") AND (\"+_+\"))\":d._layer.definitionExpression),h.where=_,h.spatialRelationship=d._makeRelationshipEnum(i),h.relationParameter=d._makeRelationshipParam(i),h.geometry=null===a?null:a,h.returnDistinctValues=!0,h.returnGeometry=!1,h.outFields=[c],d.executeQuery(h,\"execute\").then((function(u){if(d._checkCancelled(o),!u.hasOwnProperty(\"features\"))return y.reject(new Error(\"Unnexected Result querying statistics from layer\"));for(var p=!1,f=0;f<d._layer.fields.length;f++)if(d._layer.fields[f].name===c){\"date\"===d._layer.fields[f].type&&(p=!0);break}for(f=0;f<u.features.length;f++){if(p){var h=u.features[f].attributes[c];null!==h?l.push(new Date(h)):l.push(h)}else l.push(u.features[f].attributes[c]);if(l.length>=s)break}return 0===u.features.length?l:u.features.length===d._layer.capabilities.query.maxRecordCount&&l.length<s?d._getDistinctPages(e+u.features.length,t,r,i,a,n,s,l,o).then((function(e){return{calculated:!0,result:e}})):l}))}))},t.prototype._distinctStat=function(e,t,r,i,a,n,s){return this._getDistinctPages(0,e,t,r,i,a,n,[],s).then((function(e){return{calculated:!0,result:e}}))},t.prototype.isTable=function(){return this._layer.isTable||null===this._layer.geometryType||\"table\"===this._layer.type||\"\"===this._layer.geometryType},t.prototype._countstat=function(e,t,r,i){var a=this;return this.databaseType().then((function(e){var n=new F;if(a._requestStandardised&&(n.sqlFormat=\"standard\"),a.isTable()&&r&&null!==t&&\"\"!==t)return{calculated:!0,result:0};var s=null===i?null===r?\"1=1\":\"\":u.toWhereClause(i,e);return a._layer.definitionExpression&&(s=\"\"!==s?\"((\"+a._layer.definitionExpression+\") AND (\"+s+\"))\":a._layer.definitionExpression),n.where=s,n.where=s,n.spatialRelationship=a._makeRelationshipEnum(t),n.relationParameter=a._makeRelationshipParam(t),n.geometry=null===r?null:r,n.returnGeometry=!1,a.executeQuery(n,\"executeForCount\").then((function(e){return{calculated:!0,result:e}}))}))},t.prototype._stats=function(e,t,r,i,a,n,s){var l=this;return this._ensureLoaded().then((function(){var o=l._layer.capabilities&&l._layer.capabilities.query&&!0===l._layer.capabilities.query.supportsSqlExpression,c=l._layer.capabilities&&l._layer.capabilities.query&&!0===l._layer.capabilities.query.supportsStatistics,f=l._layer.capabilities&&l._layer.capabilities.query&&!0===l._layer.capabilities.query.supportsDistinct;return\"count\"===e?f?l._countstat(e,r,i,a):{calculated:!1}:!1===c||!1===d.isSingleField(t)&&!1===o||!1===t.isStandardized?\"\"!==r||null!==a?{calculated:!1}:l._manualStat(e,t,n,s):\"distinct\"===e?!1===f?\"\"!==r||null!==a?{calculated:!1}:l._manualStat(e,t,n,s):l._distinctStat(e,t,r,i,a,n,s):l.databaseType().then((function(n){if(l.isTable()&&i&&null!==r&&\"\"!==r)return{calculated:!0,result:null};var s=new F;l._requestStandardised&&(s.sqlFormat=\"standard\");var o=null===a?null===i?\"1=1\":\"\":u.toWhereClause(a,n);l._layer.definitionExpression&&(o=\"\"!==o?\"((\"+l._layer.definitionExpression+\") AND (\"+o+\"))\":l._layer.definitionExpression),s.where=o,s.spatialRelationship=l._makeRelationshipEnum(r),s.relationParameter=l._makeRelationshipParam(r),s.geometry=null===i?null:i;var d=new S;d.statisticType=p.decodeStatType(e),d.onStatisticField=u.toWhereClause(t,n),d.outStatisticFieldName=\"ARCADE_STAT_RESULT\",s.returnGeometry=!1;var c=\"ARCADE_STAT_RESULT\";return s.outStatistics=[d],l.executeQuery(s,\"execute\").then((function(e){if(!e.hasOwnProperty(\"features\")||0===e.features.length)return y.reject(new Error(\"Unnexected Result querying statistics from layer\"));for(var t=!1,r=0;r<e.fields.length;r++)if(\"ARCADE_STAT_RESULT\"===e.fields[r].name.toUpperCase()){c=e.fields[r].name,\"date\"===e.fields[r].type&&(t=!0);break}if(t){var i=e.features[0].attributes[c];return null!==i&&(i=new Date(e.features[0].attributes[c])),{calculated:!0,result:i}}return{calculated:!0,result:e.features[0].attributes[c]}}))}))}))},t.prototype._stat=function(e,t,r,i,a,n,s){return this._stats(e,t,r,i,a,n,s)},t.prototype._canDoAggregates=function(e,t){var r=this;return this._ensureLoaded().then((function(){var e=!1,i=r._layer.capabilities&&r._layer.capabilities.query&&!0===r._layer.capabilities.query.supportsSqlExpression;if(void 0!==r._layer.capabilities&&null!==r._layer.capabilities.query&&!0===r._layer.capabilities.query.supportsStatistics&&!0===r._layer.capabilities.query.supportsOrderBy&&(e=!0),e)for(var a=0;a<t.length-1;a++)null!==t[a].workingexpr&&(!1===t[a].workingexpr.isStandardized?e=!1:!1===d.isSingleField(t[a].workingexpr)&&!1===i&&(e=!1));return!1!==e}))},t.prototype._makeRelationshipEnum=function(e){if(e.indexOf(\"esriSpatialRelRelation\")>=0)return\"relation\";switch(e){case\"esriSpatialRelRelation\":return\"relation\";case\"esriSpatialRelIntersects\":return\"intersects\";case\"esriSpatialRelContains\":return\"contains\";case\"esriSpatialRelOverlaps\":return\"overlaps\";case\"esriSpatialRelWithin\":return\"within\";case\"esriSpatialRelTouches\":return\"touches\";case\"esriSpatialRelCrosses\":return\"crosses\";case\"esriSpatialRelEnvelopeIntersects\":return\"envelope-intersects\"}return e},t.prototype._makeRelationshipParam=function(e){return e.indexOf(\"esriSpatialRelRelation\")>=0?e.split(\":\")[1]:\"\"},t.prototype._getAggregatePagesDataSourceDefinition=function(e,t,r,i,a,n,s){var o=this;return this._ensureLoaded().then((function(){return o.databaseType()})).then((function(d){var p=\"\",c=!1,y=!1;null!==n&&o._layer.capabilities&&o._layer.capabilities.query&&!0===o._layer.capabilities.query.supportsOrderBy&&(p=n.constructClause(),y=!0),o._layer.capabilities&&o._layer.capabilities.query&&!1===o._layer.capabilities.query.supportsPagination&&(y=!1,c=!0,p=o._layer.objectIdField);for(var f=[],h=0;h<t.length;h++){var _=new S;_.onStatisticField=null!==t[h].workingexpr?u.toWhereClause(t[h].workingexpr,d):\"\",_.outStatisticFieldName=t[h].field,_.statisticType=t[h].toStatisticsName(),f.push(_)}\"\"===p&&(p=e.join(\",\"));var g=o._maxQueryRate(),m=o._layer.capabilities.query.maxRecordCount;void 0!==m&&m<g&&(g=m);var v=null===a?null===i?\"1=1\":\"\":u.toWhereClause(a,d);return o._layer.definitionExpression&&(v=\"\"!==v?\"((\"+o._layer.definitionExpression+\") AND (\"+v+\"))\":o._layer.definitionExpression),new l([],[\"GETPAGES\"],y,{groupbypage:!0,spatialRel:o._makeRelationshipEnum(r),relationParam:o._makeRelationshipParam(r),outFields:[\"*\"],useOIDpagination:c,generatedOid:s,resultRecordCount:g,resultOffset:0,groupByFieldsForStatistics:e,outStatistics:f,geometry:null===i?null:i,where:v,orderByFields:p,returnGeometry:!1,returnIdsOnly:!1,internal:{lastMaxId:-1,set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}))},t.prototype._getAgregagtePhysicalPage=function(e,t,r){var a=this;try{var n=e.pagesDefinition.where;!0===e.pagesDefinition.useOIDpagination&&(n=\"\"!==n?\"(\"+n+\") AND (\"+e.pagesDefinition.generatedOid+\">\"+e.pagesDefinition.internal.lastMaxId.toString()+\")\":e.pagesDefinition.generatedOid+\">\"+e.pagesDefinition.internal.lastMaxId.toString());var s=e.pagesDefinition.internal.lastRetrieved,l=s,o=e.pagesDefinition.internal.lastPage,u=new F;return this._requestStandardised&&(u.sqlFormat=\"standard\"),u.where=n,u.spatialRelationship=e.pagesDefinition.spatialRel,u.relationParameter=e.pagesDefinition.relationParam,u.outFields=e.pagesDefinition.outFields,u.outStatistics=e.pagesDefinition.outStatistics,u.geometry=e.pagesDefinition.geometry,u.groupByFieldsForStatistics=e.pagesDefinition.groupByFieldsForStatistics,u.num=e.pagesDefinition.resultRecordCount,u.start=e.pagesDefinition.internal.lastPage,u.returnGeometry=e.pagesDefinition.returnGeometry,u.orderByFields=\"\"!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(\",\"):null,this.isTable()&&u.geometry&&u.spatialRelationship?y.resolve([]):this.executeQuery(u,\"execute\").then((function(t){if(a._checkCancelled(r),!t.hasOwnProperty(\"features\"))return y.reject(new Error(\"Unnexected Result querying aggregates from layer\"));var n=[];if(e.pagesDefinition.internal.lastPage!==o)return[];for(var u=0;u<t.features.length;u++)e.pagesDefinition.internal.set[l+u]=t.features[u].attributes[e.pagesDefinition.generatedOid];for(u=0;u<t.features.length;u++)n.push(new i({attributes:t.features[u].attributes,geometry:null}));return!0===e.pagesDefinition.useOIDpagination?0===t.features.length?e.pagesDefinition.internal.fullyResolved=!0:e.pagesDefinition.internal.lastMaxId=t.features[t.features.length-1].attributes[e.pagesDefinition.generatedOid]:(void 0===t.exceededTransferLimit&&t.features.length!==e.pagesDefinition.resultRecordCount||!1===t.exceededTransferLimit)&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=s+t.features.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,n}))}catch(e){return y.reject(e)}},t.create=function(e,r,i,a){return new t({layer:new h({url:e,outFields:null===r?[\"*\"]:r}),spatialReference:i,lrucache:a})},t.prototype.relationshipMetaData=function(){return this._layer&&this._layer.source&&this._layer.source.sourceJSON&&this._layer.source.sourceJSON.relationships?this._layer.source.sourceJSON.relationships:[]},t.prototype.serviceUrl=function(){return o.extractServiceUrl(this._layer.parsedUrl.path)},t.prototype.queryAttachments=function(e,t,r,i){var a=this;if(this._layer.capabilities.data.supportsAttachment&&this._layer.capabilities.operations.supportsQueryAttachments){var s={objectIds:[e]};return(t&&t>0||r&&r>0)&&(s.size=[t&&t>0?t:0,r&&r>0?r:t+1]),i&&i.length>0&&(s.attachmentTypes=i),this._layer.queryAttachments(s).then((function(t){var r=[];return t&&t[e]&&t[e].forEach((function(t){var i=a._layer.parsedUrl.path+\"/\"+e.toString()+\"/attachments/\"+t.id.toString();r.push(new n(t.id,t.name,t.contentType,t.size,i))})),r}))}return y.resolve([])},t.prototype.queryRelatedFeatures=function(e){var t={f:\"json\",relationshipId:e.relationshipId.toString(),definitionExpression:e.where,outFields:e.outFields.join(\",\"),returnGeometry:e.returnGeometry.toString()};return void 0!==e.resultOffset&&null!==e.resultOffset&&(t.resultOffset=e.resultOffset.toString()),void 0!==e.resultRecordCount&&null!==e.resultRecordCount&&(t.resultRecordCount=e.resultRecordCount.toString()),e.orderByFields&&(t.orderByFields=e.orderByFields.join(\",\")),e.objectIds.length>0&&(t.objectIds=e.objectIds.join(\",\")),e.outSpatialReference&&(t.outSR=JSON.stringify(e.outSpatialReference.toJSON())),a(this._layer.parsedUrl.path+\"/queryRelatedRecords\",{responseType:\"json\",query:t}).then((function(e){if(e.data){var t={},r=e.data;if(r&&r.relatedRecordGroups)for(var a=r.spatialReference,n=0,s=r.relatedRecordGroups;n<s.length;n++){for(var l=s[n],o=l.objectId,u=[],d=0,p=l.relatedRecords;d<p.length;d++){var c=p[d];c.geometry&&(c.geometry.spatialReference=a);var h=new i({geometry:c.geometry?f.fromJSON(c.geometry):null,attributes:c.attributes});u.push(h)}t[o]={features:u,exceededTransferLimit:!0===r.exceededTransferLimit}}return t}return y.reject(\"Invalid Request\")}))},t.prototype.getFeatureByObjectId=function(e,t){var r=new g({url:this._layer.parsedUrl.path}),i=new F;return i.outFields=t,i.returnGeometry=!1,i.outSpatialReference=this.spatialReference,i.where=this.objectIdField+\"=\"+e.toString(),r.execute(i).then((function(e){return 1===e.features.length?e.features[0]:null}))},t}(s)}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerDynamic.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerMemory.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../../Graphic */ \"./node_modules/arcgis-js-api/Graphic.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../geometry/Geometry */ \"./node_modules/arcgis-js-api/geometry/Geometry.js\"),__webpack_require__(/*! ../../../layers/FeatureLayer */ \"./node_modules/arcgis-js-api/layers/FeatureLayer.js\"),__webpack_require__(/*! ../../../layers/support/FeatureType */ \"./node_modules/arcgis-js-api/layers/support/FeatureType.js\"),__webpack_require__(/*! ../../../layers/support/Field */ \"./node_modules/arcgis-js-api/layers/support/Field.js\"),__webpack_require__(/*! ../../../tasks/support/Query */ \"./node_modules/arcgis-js-api/tasks/support/Query.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,i,a,s,n,l,o,u,p,h,y,c){return function(e){function t(t){var r=e.call(this,t)||this;return r.declaredClass=\"esri.arcade.featureset.sources.FeatureLayerMemory\",r._removeGeometry=!1,r._overrideFields=null,r._forceIsTable=!1,t.spatialReference&&(r.spatialReference=t.spatialReference),r._transparent=!0,r._maxProcessing=1e3,r._layer=t.layer,r._wset=null,!0===t.isTable&&(r._forceIsTable=!0),void 0!==t.outFields&&(r._overrideFields=t.outFields),void 0!==t.includeGeometry&&(r._removeGeometry=!1===t.includeGeometry),r}return r.__extends(t,e),t.prototype._maxQueryRate=function(){return n.defaultMaxRecords},t.prototype.end=function(){return this._layer},t.prototype.optimisePagingFeatureQueries=function(){},t.prototype.load=function(){var e=this;return null===this._loadPromise&&(this._loadPromise=o.create((function(t,r){if(!0===e._layer.loaded)return e._initialiseFeatureSet(),void t(e);e._layer.when().then((function(){try{e._initialiseFeatureSet(),t(e)}catch(e){r(e)}}),r),e._layer.load()}))),this._loadPromise},t.prototype._initialiseFeatureSet=function(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&\"*\"===this._layer.outFields[0]);else{for(var e=[],t=0,r=this.fields;t<r.length;t++){if(\"oid\"===(u=r[t]).type)e.push(u);else for(var i=0,a=this._layer.outFields;i<a.length;i++){if(a[i].toLowerCase()===u.name.toLowerCase()){e.push(u);break}}}this.fields=e}else;if(null!==this._overrideFields)if(1===this._overrideFields.length&&\"*\"===this._overrideFields[0])this._overrideFields=null;else{e=[];for(var s=[],l=0,o=this.fields;l<o.length;l++){var u;if(\"oid\"===(u=o[l]).type)e.push(u),s.push(u.name);else for(var p=0,h=this._overrideFields;p<h.length;p++){if(h[p].toLowerCase()===u.name.toLowerCase()){e.push(u),s.push(u.name);break}}}this.fields=e,this._overrideFields=s}this.objectIdField=this._layer.objectIdField,this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this._databaseType=n.FeatureServiceDatabaseType.Standardised,this.typeIdField=this._layer.typeIdField,this.types=this._layer.types},t.prototype.isTable=function(){return this._forceIsTable||this._layer.isTable||\"table\"===this._layer.type||!this._layer.geometryType},t.prototype._isInFeatureSet=function(){return n.IdState.InFeatureSet},t.prototype._candidateIdTransform=function(e){return e},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._getFilteredSet(\"\",null,null,null,e)})).then((function(e){return t._wset=e,e})):o.resolve(this._wset)},t.prototype._changeFeature=function(e){for(var t={},r=0,a=this.fields;r<a.length;r++){var s=a[r];t[s.name]=e.attributes[s.name]}return new i({geometry:!0===this._removeGeometry?null:e.geometry,attributes:t})},t.prototype._getFilteredSet=function(e,t,r,i,a){var u=this,p=\"\",h=!1;if(null!==i&&(p=i.constructClause(),h=!0),this.isTable()&&t&&null!==e&&\"\"!==e){var y=new s([],[],!0,null);return o.resolve(y)}var f=new c;return f.where=null===r?null===t?\"1=1\":\"\":l.toWhereClause(r,n.FeatureServiceDatabaseType.Standardised),f.spatialRelationship=this._makeRelationshipEnum(e),f.outSpatialReference=this.spatialReference,f.orderByFields=\"\"!==p?p.split(\",\"):null,f.geometry=null===t?null:t,f.returnGeometry=!0,f.relationParameter=this._makeRelationshipParam(e),this._layer.queryFeatures(f).then((function(e){if(null===e)return new s([],[],h,null);u._checkCancelled(a);var t=[];return e.features.forEach((function(e){var r=e.attributes[u._layer.objectIdField];t.push(r),u._featureCache[r]=u._changeFeature(e)})),new s([],t,h,null)}))},t.prototype._makeRelationshipEnum=function(e){if(e.indexOf(\"esriSpatialRelRelation\")>=0)return\"relation\";switch(e){case\"esriSpatialRelRelation\":return\"relation\";case\"esriSpatialRelIntersects\":return\"intersects\";case\"esriSpatialRelContains\":return\"contains\";case\"esriSpatialRelOverlaps\":return\"overlaps\";case\"esriSpatialRelWithin\":return\"within\";case\"esriSpatialRelTouches\":return\"touches\";case\"esriSpatialRelCrosses\":return\"crosses\";case\"esriSpatialRelEnvelopeIntersects\":return\"envelope-intersects\"}return e},t.prototype._makeRelationshipParam=function(e){return e.indexOf(\"esriSpatialRelRelation\")>=0?e.split(\":\")[1]:\"\"},t.prototype._queryAllFeatures=function(){var e=this;if(this._wset)return o.resolve(this._wset);var t=new c;return t.where=\"1=1\",this._ensureLoaded().then((function(){if(e._layer.source&&e._layer.source.items){var r=[];return e._layer.source.items.forEach((function(t){var i=t.attributes[e._layer.objectIdField];r.push(i),e._featureCache[i]=e._changeFeature(t)})),e._wset=new s([],r,!1,null),e._wset}return e._layer.queryFeatures(t).then((function(t){var r=[];return t.features.forEach((function(t){var i=t.attributes[e._layer.objectIdField];r.push(i),e._featureCache[i]=e._changeFeature(t)})),e._wset=new s([],r,!1,null),e._wset}))}))},t.prototype._getFeatures=function(e,t,r){var i=[];-1!==t&&void 0===this._featureCache[t]&&i.push(t);for(var a=e._lastFetchedIndex;a<e._known.length&&(e._lastFetchedIndex+=1,!(void 0===this._featureCache[e._known[a]]&&(e._known[a]!==t&&i.push(e._known[a]),i.length>r)));a++);return 0===i.length?o.resolve(\"success\"):o.reject(new Error(\"Unaccounted for Features. Not in Feature Collection\"))},t.prototype._refineSetBlock=function(e){return o.resolve(e)},t.prototype._stat=function(){return o.resolve({calculated:!1})},t.prototype._canDoAggregates=function(){return o.resolve(!1)},t.prototype.relationshipMetaData=function(){return[]},t._cloneAttr=function(e){var t={};for(var r in e)t[r]=e[r];return t},t.prototype.nativeCapabilities=function(){return{title:this._layer.title,canQueryRelated:!1,source:this,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:!0}},t.create=function(e,r){var i=e.layerDefinition.objectIdField,a=e.layerDefinition.typeIdField?e.layerDefinition.typeIdField:\"\",s=[];if(e.layerDefinition.types)for(var n=0,l=e.layerDefinition.types;n<l.length;n++){var o=l[n];s.push(h.fromJSON(o))}var c=e.layerDefinition.geometryType;void 0===c&&(c=e.featureSet.geometryType||\"\");var f=e.featureSet.features,d=r.toJSON();if(\"\"===i||void 0===i){for(var _=!1,v=0,m=e.layerDefinition.fields;v<m.length;v++){if(\"oid\"===(j=m[v]).type||\"esriFieldTypeOID\"===j.type){i=j.name,_=!0;break}}if(!1===_){for(var F=\"FID\",g=!0,b=0;g;){for(var S=!0,w=0,R=e.layerDefinition.fields;w<R.length;w++){if((j=R[w]).name===F){S=!1;break}}!0===S?g=!1:F=\"FID\"+(++b).toString()}e.layerDefinition.fields.push({type:\"esriFieldTypeOID\",name:F,alias:F});for(var I=[],T=0;T<f.length;T++)I.push({geometry:e.featureSet.features[T].geometry,attributes:e.featureSet.features[T].attributes?this._cloneAttr(e.featureSet.features[T].attributes):{}}),I[T].attributes[F]=T;f=I,i=F}}for(var k=[],D=0,C=e.layerDefinition.fields;D<C.length;D++){(j=C[D])instanceof y?k.push(j):k.push(y.fromJSON(j))}var G=c;switch(G){case\"esriGeometryPoint\":G=\"point\";break;case\"esriGeometryPolyline\":G=\"polyline\";break;case\"esriGeometryPolygon\":G=\"polygon\";break;case\"esriGeometryExtent\":G=\"extent\";break;case\"esriGeometryMultipoint\":G=\"multipoint\"}for(var x=0,P=f;x<P.length;x++){var j;(j=P[x]).geometry&&j.geometry instanceof u==!1&&(j.geometry.type=G,void 0===j.geometry.spatialReference&&(j.geometry.spatialReference=d))}var O={outFields:[\"*\"],source:f,fields:k,types:s,typeIdField:a,objectIdField:i,spatialReference:r};return O.geometryType=G||\"point\",new t({layer:new p(O),spatialReference:r,isTable:null===G||\"\"===G})},t.prototype.queryAttachments=function(){return o.resolve([])},t.prototype.getFeatureByObjectId=function(e){var t=new c;return t.where=this.objectIdField+\"=\"+e.toString(),this._layer.queryFeatures(t).then((function(e){return 1===e.features.length?e.features[0]:null}))},t}(a)}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerMemory.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerRelated.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../../../Graphic */ \"./node_modules/arcgis-js-api/Graphic.js\"),__webpack_require__(/*! ../support/FeatureSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../tasks/support/RelationshipQuery */ \"./node_modules/arcgis-js-api/tasks/support/RelationshipQuery.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,i,n,a,s,l,o){return function(e){function t(t){var r=e.call(this,t)||this;return r.declaredClass=\"esri.arcade.featureset.sources.FeatureLayerRelated\",r._findObjectId=-1,r._requestStandardised=!1,r._removeGeometry=!1,r._overrideFields=null,r.featureObjectId=null,r.relatedLayer=null,r.relationship=null,t.spatialReference&&(r.spatialReference=t.spatialReference),r._transparent=!0,r._maxProcessing=1e3,r._layer=t.layer,r._wset=null,r._findObjectId=t.objectId,r.featureObjectId=t.objectId,r.relationship=t.relationship,r.relatedLayer=t.relatedLayer,void 0!==t.outFields&&(r._overrideFields=t.outFields),void 0!==t.includeGeometry&&(r._removeGeometry=!1===t.includeGeometry),r}return r.__extends(t,e),t.prototype._maxQueryRate=function(){return s.defaultMaxRecords},t.prototype.end=function(){return this._layer},t.prototype.optimisePagingFeatureQueries=function(){},t.prototype.load=function(){var e=this;return null===this._loadPromise&&(this._loadPromise=l.create((function(t,r){l.all([e._layer.load(),e.relatedLayer.load()]).then((function(){e._initialiseFeatureSet(),t(e)}),r)}))),this._loadPromise},t.prototype.nativeCapabilities=function(){return this.relatedLayer.nativeCapabilities()},t.prototype._initialiseFeatureSet=function(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this.relatedLayer.geometryType,this.fields=this.relatedLayer.fields.slice(0),null!==this._overrideFields)if(1===this._overrideFields.length&&\"*\"===this._overrideFields[0])this._overrideFields=null;else{for(var e=[],t=[],r=0,i=this.fields;r<i.length;r++){var n=i[r];if(\"oid\"===n.type)e.push(n),t.push(n.name);else for(var a=0,s=this._overrideFields;a<s.length;a++){if(s[a].toLowerCase()===n.name.toLowerCase()){e.push(n),t.push(n.name);break}}}this.fields=e,this._overrideFields=t}var l=this._layer.nativeCapabilities();l&&(this._databaseType=l.databaseType,this._requestStandardised=l.requestStandardised),this.objectIdField=this.relatedLayer.objectIdField,this.hasM=this.relatedLayer.supportsM,this.hasZ=this.relatedLayer.supportsZ,this.typeIdField=this.relatedLayer.typeIdField,this.types=this.relatedLayer.types},t.prototype.databaseType=function(){var e=this;return this.relatedLayer.databaseType().then((function(){return e._databaseType=e.relatedLayer._databaseType,e._databaseType}))},t.prototype.isTable=function(){return this.relatedLayer.isTable()},t.prototype._isInFeatureSet=function(){return s.IdState.InFeatureSet},t.prototype._candidateIdTransform=function(e){return e},t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._getFilteredSet(\"\",null,null,null,e)})).then((function(e){return t._wset=e,e})):l.resolve(this._wset)},t.prototype._changeFeature=function(e){for(var t={},r=0,n=this.fields;r<n.length;r++){var a=n[r];t[a.name]=e.attributes[a.name]}return new i({geometry:!0===this._removeGeometry?null:e.geometry,attributes:t})},t.prototype._getFilteredSet=function(e,t,r,i,n){var s=this;return this.databaseType().then((function(){if(s.isTable()&&t&&null!==e&&\"\"!==e)return new a([],[],!0,null);var l=s._layer.nativeCapabilities();if(!1===l.canQueryRelated)return new a([],[],!0,null);if(l.capabilities.queryRelated&&l.capabilities.queryRelated.supportsPagination)return s._getFilteredSetUsingPaging(e,t,r,i,n);var d=\"\",u=!1;null!==i&&l.capabilities&&l.capabilities.queryRelated&&!0===l.capabilities.queryRelated.supportsOrderBy&&(d=i.constructClause(),u=!0);var p=new o;p.objectIds=[s._findObjectId];var c=null!==s._overrideFields?s._overrideFields:s._fieldsIncludingObjectId(s.relatedLayer.fields?s.relatedLayer.fields.map((function(e){return e.name})):[\"*\"]);p.outFields=c,p.relationshipId=s.relationship.id,p.where=\"1=1\";var f=!0;return!0===s._removeGeometry&&(f=!1),p.returnGeometry=f,s._requestStandardised&&(p.sqlFormat=\"standard\"),p.outSpatialReference=s.spatialReference,p.orderByFields=\"\"!==d?d.split(\",\"):null,l.source.queryRelatedFeatures(p).then((function(i){s._checkCancelled(n);for(var l=i[s._findObjectId]?i[s._findObjectId].features:[],o=[],d=0;d<l.length;d++)s._featureCache[l[d].attributes[s._layer.objectIdField]]=l[d],o.push(l[d].attributes[s._layer.objectIdField]);var p=t&&null!==e&&\"\"!==e,c=null!=r;return new a(p||c?o:[],p||c?[]:o,u,null)}))}))},t.prototype._fieldsIncludingObjectId=function(e){if(null===e)return[this.objectIdField];var t=e.slice(0);if(t.indexOf(\"*\")>-1)return t;for(var r=!1,i=0,n=t;i<n.length;i++){if(n[i].toUpperCase()===this.objectIdField.toUpperCase()){r=!0;break}}return!1===r&&t.push(this.objectIdField),t},t.prototype._getFilteredSetUsingPaging=function(e,t,r,i,n){var s=this;try{var o=\"\",d=!1,u=this._layer.nativeCapabilities();return null!==i&&u&&u.capabilities.queryRelated&&!0===u.capabilities.queryRelated.supportsOrderBy&&(o=i.constructClause(),d=!0),this.databaseType().then((function(){var i=s._maxQueryRate(),l=u.capabilities.query.maxRecordCount;void 0!==l&&l<i&&(i=l);var p,c=t&&null!==e&&\"\"!==e,f=null!=r,y=!0;!0===s._removeGeometry&&(y=!1);var h=null!==s._overrideFields?s._overrideFields:s._fieldsIncludingObjectId(s.relatedLayer.fields?s.relatedLayer.fields.map((function(e){return e.name})):[\"*\"]);return p=new a(c||f?[\"GETPAGES\"]:[],c||f?[]:[\"GETPAGES\"],d,{outFields:h.join(\",\"),resultRecordCount:i,resultOffset:0,objectIds:[s._findObjectId],where:\"1=1\",orderByFields:o,returnGeometry:y,returnIdsOnly:\"false\",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}),s._expandPagedSet(p,i,0,0,n).then((function(){return p}))}))}catch(e){return l.reject(e)}},t.prototype._expandPagedSet=function(e,t,r,i,n){return this._expandPagedSetFeatureSet(e,t,r,i,n)},t.prototype._clonePageDefinition=function(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}},t.prototype._getPhysicalPage=function(e,t,r){var i=this;try{var n=e.pagesDefinition.internal.lastRetrieved,a=n,s=e.pagesDefinition.internal.lastPage,d=this._layer.nativeCapabilities(),u=new o;return!0===this._requestStandardised&&(u.sqlFormat=\"standard\"),u.relationshipId=this.relationship.id,u.objectIds=e.pagesDefinition.objectIds,u.resultOffset=e.pagesDefinition.internal.lastPage,u.resultRecordCount=e.pagesDefinition.resultRecordCount,u.outFields=e.pagesDefinition.outFields.split(\",\"),u.where=e.pagesDefinition.where,u.orderByFields=\"\"!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(\",\"):null,u.returnGeometry=e.pagesDefinition.returnGeometry,u.outSpatialReference=this.spatialReference,d.source.queryRelatedFeatures(u).then((function(t){if(i._checkCancelled(r),e.pagesDefinition.internal.lastPage!==s)return 0;for(var l=t[i._findObjectId]?t[i._findObjectId].features:[],o=0;o<l.length;o++)e.pagesDefinition.internal.set[a+o]=l[o].attributes[i._layer.objectIdField];for(o=0;o<l.length;o++)i._featureCache[l[o].attributes[i._layer.objectIdField]]=l[o];var d=!t[i._findObjectId]||!1===t[i._findObjectId].exceededTransferLimit;return l.length!==e.pagesDefinition.resultRecordCount&&d&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=n+l.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,l.length}))}catch(e){return l.reject(e)}},t.prototype._getFeatures=function(e,t,r,i){var n=this,a=[];-1!==t&&void 0===this._featureCache[t]&&a.push(t);var s=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(e,s))return this._expandPagedSet(e,s,0,0,i).then((function(){return n._getFeatures(e,t,r,i)}));for(var o=0,d=e._lastFetchedIndex;d<e._known.length&&(++o<=r&&(e._lastFetchedIndex+=1),!(\"GETPAGES\"!==e._known[d]&&void 0===this._featureCache[e._known[d]]&&(e._known[d]!==t&&a.push(e._known[d]),a.length>r)))&&!(o>=r&&0===a.length);d++);return 0===a.length?l.resolve(\"success\"):l.reject(new Error(\"Unaccounted for Features. Not in Feature Collection\"))},t.prototype._refineSetBlock=function(e,t,r){return l.resolve(e)},t.prototype._stat=function(e,t,r,i,n,a,s){return l.resolve({calculated:!1})},t.prototype._canDoAggregates=function(e,t,r,i,n){return l.resolve(!1)},t.prototype.relationshipMetaData=function(){return this.relatedLayer.relationshipMetaData()},t.prototype.serviceUrl=function(){return this.relatedLayer.serviceUrl()},t.prototype.queryAttachments=function(e,t,r,i){return this.relatedLayer.queryAttachments(e,t,r,i)},t.prototype.getFeatureByObjectId=function(e,t){return this.relatedLayer.getFeatureByObjectId(e,t)},t}(n)}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerRelated.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../support/FeatureSetIterator */ \"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSetIterator.js\"),__webpack_require__(/*! ../support/IdSet */ \"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\"),__webpack_require__(/*! ../support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ./cache */ \"./node_modules/arcgis-js-api/arcade/featureset/support/cache.js\"),__webpack_require__(/*! ./stats */ \"./node_modules/arcgis-js-api/arcade/featureset/support/stats.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../../../geometry/geometryEngineAsync */ \"./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js\"),__webpack_require__(/*! ../../../geometry/SpatialReference */ \"./node_modules/arcgis-js-api/geometry/SpatialReference.js\"),__webpack_require__(/*! ../../../layers/support/FieldsIndex */ \"./node_modules/arcgis-js-api/layers/support/FieldsIndex.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,n,r,i,a,o,s,u,c,l,h){return function(){function e(e){this.recentlyUsedQueries=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=i.FeatureServiceDatabaseType.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass=\"esri.arcade.featureset.support.FeatureSet\",this._featureCache=[],this.types=null,this.fields=null,this.geometryType=\"\",this.objectIdField=\"\",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache)}return e.prototype.optimisePagingFeatureQueries=function(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)},e.prototype._hasMemorySource=function(){return!0},e.prototype.prop=function(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)},e.prototype.end=function(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent},e.prototype._ensureLoaded=function(){return this.load()},e.prototype.load=function(){var e=this;return null===this._loadPromise&&(this._loadPromise=s.create((function(t,n){if(!0===e._parent.loaded)return e._initialiseFeatureSet(),void t(e);e._parent.load().then((function(){try{e._initialiseFeatureSet(),t(e)}catch(e){n(e)}}),n)}))),this._loadPromise},e.prototype._initialiseFeatureSet=function(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField=\"\",this.objectIdField=\"\",this.spatialReference=new l({wkid:4326}),this.geometryType=i.layerGeometryEsriConstants.point)},e.prototype.getField=function(e,t){var n;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some((function(t){return t&&t.name.toLowerCase()===e&&(n=t),!!n}))),n},e.prototype.getFieldsIndex=function(){return null===this._fieldsIndex&&(this._fieldsIndex=new h(this.fields)),this._fieldsIndex},e.prototype._maxProcessingRate=function(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())},e.prototype._maxQueryRate=function(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery},e.prototype._checkCancelled=function(e){if(null!==e&&e.aborted)throw new Error(\"Operation has been cancelled.\")},e.prototype.nativeCapabilities=function(){return this._parent.nativeCapabilities()},e.prototype._canDoAggregates=function(e,t,n,r,i){return null===this._parent?s.resolve(!1):this._parent._canDoAggregates(e,t,n,r,i)},e.prototype._getAggregatePagesDataSourceDefinition=function(e,t,n,r,i,a,o){return null===this._parent?s.reject(new Error(\"Should never be called\")):this._parent._getAggregatePagesDataSourceDefinition(e,t,n,r,i,a,o)},e.prototype._getAgregagtePhysicalPage=function(e,t,n){return null===this._parent?s.reject(new Error(\"Should never be called\")):this._parent._getAgregagtePhysicalPage(e,t,n)},e.prototype.databaseType=function(){var e=this;if(this._databaseType===i.FeatureServiceDatabaseType.NotEvaluated){if(null!==a.applicationCache){var t=a.applicationCache.getDatabaseType(this._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==this._databaseTypeProbed)return this._databaseTypeProbed;var n=[{thetype:i.FeatureServiceDatabaseType.SqlServer,testwhere:\"(CAST( \\'2015-01-01\\' as DATETIME) = CAST( \\'2015-01-01\\' as DATETIME)) AND OBJECTID<0\"},{thetype:i.FeatureServiceDatabaseType.Oracle,testwhere:\"(TO_DATE(\\'2003-11-18\\',\\'YYYY-MM-DD\\') = TO_DATE(\\'2003-11-18\\',\\'YYYY-MM-DD\\')) AND OBJECTID<0\"},{thetype:i.FeatureServiceDatabaseType.StandardisedNoInterval,testwhere:\"(date \\'2015-01-01 10:10:10\\' = date \\'2015-01-01 10:10:10\\') AND OBJECTID<0\"}],r=s.create((function(t,r){e._getDatabaseTypeImpl(n,0).then((function(n){e._databaseType=n,t(e._databaseType)}),(function(e){r(e)}))}));return null!==a.applicationCache&&(a.applicationCache.setDatabaseType(this._cacheableFeatureSetSourceKey(),r),r=r.catch((function(t){throw a.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),t}))),this._databaseTypeProbed=r,this._databaseTypeProbed}return s.resolve(this._databaseType)},e.prototype._cacheableFeatureSetSourceKey=function(){return\"MUSTBESET\"},e.prototype._getDatabaseTypeImpl=function(e,t){var n=this;return t>=e.length?s.resolve(i.FeatureServiceDatabaseType.StandardisedNoInterval):this._runDatabaseProbe(e[t].testwhere).then((function(r){return!0===r?e[t].thetype:n._getDatabaseTypeImpl(e,t+1)}))},e.prototype._runDatabaseProbe=function(e){return null!==this._parent?this._parent._runDatabaseProbe(e):s.reject(new Error(\"Not Implemented\"))},e.prototype.isTable=function(){return this._parent.isTable()},e.prototype._featureFromCache=function(e){if(void 0!==this._featureCache[e])return this._featureCache[e]},e.prototype._isInFeatureSet=function(e){return i.IdState.Unknown},e.prototype._getSet=function(e){throw new Error(\"Not implemented in abstract class\")},e.prototype._getFeature=function(e,t,n){var r=this;try{return this._checkCancelled(n),void 0!==this._featureFromCache(t)?s.resolve(this._featureFromCache(t)):this._getFeatures(e,t,this._maxProcessingRate(),n).then((function(){return r._checkCancelled(n),void 0!==r._featureFromCache(t)?r._featureFromCache(t):s.reject(new Error(\"Feature Not Found\"))}))}catch(e){return s.reject(e)}},e.prototype._getFeatureBatch=function(e,t){var n=this;try{this._checkCancelled(t);var i=new r([],e,!1,null),a=[];return this._getFeatures(i,-1,e.length,t).then((function(){n._checkCancelled(t);for(var r=0,i=e;r<i.length;r++){var o=i[r];void 0!==n._featureFromCache(o)&&a.push(n._featureFromCache(o))}return a}))}catch(e){return s.reject(e)}},e.prototype._getFeatures=function(e,t,n,r){return s.resolve(\"success\")},e.prototype._getFilteredSet=function(e,t,n,r,i){throw new Error(\"Not implemented in abstract class\")},e.prototype._refineSetBlock=function(e,t,n){var r=this;try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQueryRate()))return this._expandPagedSet(e,this._maxQueryRate(),0,0,n).then((function(){return r._refineSetBlock(e,t,n)}));this._checkCancelled(n);var i=e._candidates.length;this._refineKnowns(e,t);var a=i-e._candidates.length;return 0===e._candidates.length?s.resolve(e):a>=t?s.resolve(e):this._refineIfParentKnown(e,t-a,n).then((function(){if(r._checkCancelled(n),r._refineKnowns(e,t-a),(a=i-e._candidates.length)<t&&e._candidates.length>0){var o=t-a,s=r._prepareFetchAndRefineSet(e._candidates);return r._fetchAndRefineFeatures(s,s.length>o?o:e._candidates.length,n).then((function(){return r._checkCancelled(n),r._refineKnowns(e,t-a),e}))}return e}))}catch(e){return s.reject(e)}},e.prototype._fetchAndRefineFeatures=function(e,t,n){return null},e.prototype._prepareFetchAndRefineSet=function(e){for(var t=[],n=0;n<e.length;n++)this._isPhysicalFeature(e[n])&&t.push(e[n]);return t},e.prototype._isPhysicalFeature=function(e){return null===this._parent||this._parent._isPhysicalFeature(e)},e.prototype._refineKnowns=function(e,t){var n=0,r=null,a=[];t=this._maxQueryRate();for(var o=0;o<e._candidates.length&&\"GETPAGES\"!==e._candidates[o];o++){var s=!1,u=this._candidateIdTransform(e._candidates[o]);u!==e._candidates[o]&&(s=!0);var c=this._isInFeatureSet(u);if(c===i.IdState.InFeatureSet)!0===s?e._known.indexOf(u)<0&&(e._known.push(u),n+=1):(e._known.push(e._candidates[o]),n+=1),null===r?r={start:o,end:o}:r.end===o-1?r.end=o:(a.push(r),r={start:o,end:o});else if(c===i.IdState.NotInFeatureSet)null===r?r={start:o,end:o}:r.end===o-1?r.end=o:(a.push(r),r={start:o,end:o}),n+=1;else if(c===i.IdState.Unknown&&(n+=1,!0===e._ordered))break;if(n>=t)break}null!==r&&a.push(r);for(var l=a.length-1;l>=0;l--)e._candidates.splice(a[l].start,a[l].end-a[l].start+1)},e.prototype._refineIfParentKnown=function(e,t,n){var i=new r([],[],e._ordered,null);return i._candidates=e._candidates.slice(0),this._parent._refineSetBlock(i,t,n)},e.prototype._candidateIdTransform=function(e){return this._parent._candidateIdTransform(e)},e.prototype._checkIfNeedToExpandKnownPage=function(e,t){if(null===e.pagesDefinition)return!1;for(var n=0,r=e._lastFetchedIndex;r<e._known.length;r++){if(\"GETPAGES\"===e._known[r])return!0;if(void 0===this._featureCache[e._known[r]]&&(n+=1)>=t)break}return!1},e.prototype._checkIfNeedToExpandCandidatePage=function(e,t){if(null===e.pagesDefinition)return!1;for(var n=0,r=0;r<e._candidates.length;r++){if(\"GETPAGES\"===e._candidates[r])return!0;if((n+=1)>=t)break}return!1},e.prototype._expandPagedSet=function(e,t,n,r,i){return null===this._parent?s.reject(new Error(\"Parent Paging not implemented\")):this._parent._expandPagedSet(e,t,n,r,i)},e.prototype._expandPagedSetFeatureSet=function(e,t,n,r,i){var a=this;return e._known.length>0&&\"GETPAGES\"===e._known[e._known.length-1]&&(r=1),0===r&&e._candidates.length>0&&\"GETPAGES\"===e._candidates[e._candidates.length-1]&&(r=2),0===r?s.resolve(\"finished\"):this._getPage(e,r,i).then((function(r){return n+r<t?a._expandPagedSet(e,t,n+r,0,i):\"success\"}))},e.prototype._getPage=function(e,t,n){var r=this,i=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){i.length=i.length-1;for(var a=0,o=0;o<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+o>=e.pagesDefinition.internal.set.length);o++)i[i.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+o],a++;e.pagesDefinition.resultOffset+=a;var u=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(u=!0),!1===u&&i.push(\"GETPAGES\"),s.resolve(a)}return this._getPhysicalPage(e,t,n).then((function(){return r._getPage(e,t,n)}))},e.prototype._getPhysicalPage=function(e,t,n){return null},e.prototype._clonePageDefinition=function(e){return null===this._parent?null:this._parent._clonePageDefinition(e)},e.prototype._first=function(e){return this.iterator(e).next()},e.prototype.first=function(e){return this._first(e)},e.prototype.calculateStatistic=function(e,t,n,r){var i=this;return this._ensureLoaded().then((function(){return i._stat(e,t,\"\",null,null,n,r).then((function(a){return!1===a.calculated?i._manualStat(e,t,n,r).then((function(e){return e.result})):a.result}))}))},e.prototype._manualStat=function(e,t,n,r){switch(e.toLowerCase()){case\"count\":return o.count(this,r).then((function(e){return{calculated:!0,result:e}}));case\"distinct\":return o.distinct(this,t,n).then((function(e){return{calculated:!0,result:e}}));case\"avg\":case\"mean\":return o.mean(this,t,r).then((function(e){return{calculated:!0,result:e}}));case\"stdev\":return o.stdev(this,t,r).then((function(e){return{calculated:!0,result:e}}));case\"variance\":return o.variance(this,t,r).then((function(e){return{calculated:!0,result:e}}));case\"sum\":return o.sum(this,t,r).then((function(e){return{calculated:!0,result:e}}));case\"min\":return o.min(this,t,r).then((function(e){return{calculated:!0,result:e}}));case\"max\":return o.max(this,t,r).then((function(e){return{calculated:!0,result:e}}));default:return s.resolve({calculated:!0,result:0})}},e.prototype._stat=function(e,t,n,r,i,a,o){var s=this;return this._parent._stat(e,t,n,r,i,a,o).then((function(u){return!1===u.calculated?null===i&&\"\"===n&&null===r?s._manualStat(e,t,a,o):{calculated:!1}:u}))},e.prototype._unionAllGeomSelf=function(e){var t=this,n=this.iterator(this._defaultTracker(e)),r=[];return s.create((function(e,i){t._unionShapeInBatches(r,n,e,i)}))},e.prototype._unionAllGeom=function(e){var t=this;return s.create((function(n,r){var i=t.iterator(t._defaultTracker(e));t._unionShapeInBatches([],i,n,r)}))},e.prototype._unionShapeInBatches=function(e,t,n,r){var i=this;t.next().then((function(a){try{null!==a&&null!==a.geometry&&e.push(a.geometry),e.length>30||null===a&&e.length>1?c.union(e).then((function(o){try{null===a?n(o):(e=[o],i._unionShapeInBatches(e,t,n,r))}catch(e){r(e)}}),r):null===a?1===e.length?n(e[0]):n(null):i._unionShapeInBatches(e,t,n,r)}catch(e){r(e)}}),r)},e.prototype.iterator=function(e){return new n(this,e)},e.prototype.intersection=function(t,n){return void 0===n&&(n=!1),e._featuresetFunctions.intersection.bind(this)(t,n)},e.prototype.difference=function(t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),e._featuresetFunctions.difference.bind(this)(t,n,r)},e.prototype.symmetricDifference=function(t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),e._featuresetFunctions.symmetricDifference.bind(this)(t,n,r)},e.prototype.morphShape=function(t,n,r,i){return void 0===r&&(r=\"unknown\"),void 0===i&&(i=null),e._featuresetFunctions.morphShape.bind(this)(t,n,r,i)},e.prototype.morphShapeAndAttributes=function(t,n,r){return void 0===r&&(r=\"unknown\"),e._featuresetFunctions.morphShapeAndAttributes.bind(this)(t,n,r)},e.prototype.union=function(t,n){return void 0===n&&(n=!1),e._featuresetFunctions.union.bind(this)(t,n)},e.prototype.intersects=function(t){return e._featuresetFunctions.intersects.bind(this)(t)},e.prototype.envelopeIntersects=function(t){return e._featuresetFunctions.envelopeIntersects.bind(this)(t)},e.prototype.contains=function(t){return e._featuresetFunctions.contains.bind(this)(t)},e.prototype.overlaps=function(t){return e._featuresetFunctions.overlaps.bind(this)(t)},e.prototype.relate=function(t,n){return e._featuresetFunctions.relate.bind(this)(t,n)},e.prototype.within=function(t){return e._featuresetFunctions.within.bind(this)(t)},e.prototype.touches=function(t){return e._featuresetFunctions.touches.bind(this)(t)},e.prototype.top=function(t){return e._featuresetFunctions.top.bind(this)(t)},e.prototype.crosses=function(t){return e._featuresetFunctions.crosses.bind(this)(t)},e.prototype.buffer=function(t,n,r,i){return void 0===i&&(i=!0),e._featuresetFunctions.buffer.bind(this)(t,n,r,i)},e.prototype.filter=function(t,n){return void 0===n&&(n=null),e._featuresetFunctions.filter.bind(this)(t,n)},e.prototype.orderBy=function(t){return e._featuresetFunctions.orderBy.bind(this)(t)},e.prototype.dissolve=function(t,n){return e._featuresetFunctions.dissolve.bind(this)(t,n)},e.prototype.groupby=function(t,n){return e._featuresetFunctions.groupby.bind(this)(t,n)},e.prototype.reduce=function(e,t,n){var r=this;return void 0===t&&(t=null),s.create((function(i,a){r._reduceImpl(r.iterator(r._defaultTracker(n)),e,t,0,i,a,0)}))},e.prototype._reduceImpl=function(e,t,n,r,i,a,o){var u=this;try{if(++o>1e3)return void setTimeout((function(){o=0,u._reduceImpl(e,t,n,r,i,a,o)}));e.next().then((function(c){try{if(null===c)i(n);else{var l=t(n,c,r,u);s.isPromiseLike(l)?l.then((function(n){u._reduceImpl(e,t,n,r+1,i,a,o)}),a):u._reduceImpl(e,t,l,r+1,i,a,o)}}catch(e){a(e)}}),a)}catch(e){a(e)}},e.prototype.removeField=function(t){return e._featuresetFunctions.removeField.bind(this)(t)},e.prototype.addField=function(t,n,r){return void 0===r&&(r=null),e._featuresetFunctions.addField.bind(this)(t,n,r)},e.prototype.sumArea=function(e,t,n){void 0===t&&(t=!1);var r=i.convertSquareUnitsToCode(e);return this.reduce((function(e,n){return null===n.geometry?0:t?c.geodesicArea(n.geometry,r).then((function(t){return e+t})):c.planarArea(n.geometry,r).then((function(t){return e+t}))}),0,n)},e.prototype.sumLength=function(e,t,n){void 0===t&&(t=!1);var r=i.convertLinearUnitsToCode(e);return this.reduce((function(e,n){return null===n.geometry?0:t?c.geodesicLength(n.geometry,r).then((function(t){return e+t})):c.planarLength(n.geometry,r).then((function(t){return e+t}))}),0,n)},e.prototype._substituteVars=function(e,t){if(null!==t){var n={};for(var r in t)n[r.toLowerCase()]=t[r];e.parameters=n}},e.prototype.distinct=function(e,t,n,r){var i=this;return void 0===t&&(t=1e3),void 0===n&&(n=null),this.load().then((function(){var a=u.WhereClause.create(e,i.getFieldsIndex());return i._substituteVars(a,n),i.calculateStatistic(\"distinct\",a,t,i._defaultTracker(r))}))},e.prototype.min=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"min\",i,-1,r._defaultTracker(n))}))},e.prototype.max=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"max\",i,-1,r._defaultTracker(n))}))},e.prototype.avg=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"avg\",i,-1,r._defaultTracker(n))}))},e.prototype.sum=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"sum\",i,-1,r._defaultTracker(n))}))},e.prototype.stdev=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"stdev\",i,-1,r._defaultTracker(n))}))},e.prototype.variance=function(e,t,n){var r=this;return void 0===t&&(t=null),this.load().then((function(){var i=u.WhereClause.create(e,r.getFieldsIndex());return r._substituteVars(i,t),r.calculateStatistic(\"variance\",i,-1,r._defaultTracker(n))}))},e.prototype.count=function(e){var t=this;return this.load().then((function(){return t.calculateStatistic(\"count\",u.WhereClause.create(\"1\",t.getFieldsIndex()),-1,t._defaultTracker(e))}))},e.prototype._defaultTracker=function(e){return e||{aborted:!1}},e.prototype.forEach=function(e,t){var n=this;return s.create((function(r,i){n._forEachImpl(n.iterator(n._defaultTracker(t)),e,n,r,i,0)}))},e.prototype._forEachImpl=function(e,t,n,r,i,a){var o=this;try{if(++a>1e3)return void setTimeout((function(){a=0,o._forEachImpl(e,t,n,r,i,a)}),0);e.next().then((function(u){try{if(null===u)r(n);else{var c=t(u);null==c?o._forEachImpl(e,t,n,r,i,a):s.isPromiseLike(c)?c.then((function(){try{o._forEachImpl(e,t,n,r,i,a)}catch(e){i(e)}}),i):o._forEachImpl(e,t,n,r,i,a)}}catch(e){i(e)}}),i)}catch(e){i(e)}},e.prototype.convertToJSON=function(e){for(var t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}},n=0;n<this.fields.length;n++)t.layerDefinition.fields.push(i.esriFieldToJson(this.fields[n]));return this.reduce((function(e,n){var r={geometry:n.geometry&&n.geometry.toJSON(),attributes:{}};for(var i in n.attributes)r.attributes[i]=n.attributes[i];return t.featureSet.features.push(r),1}),0,e).then((function(){return t}))},e.prototype.castToText=function(){return\"object, FeatureSet\"},e.prototype.queryAttachments=function(e,t,n,r){return this._parent.queryAttachments(e,t,n,r)},e.prototype.serviceUrl=function(){return this._parent.serviceUrl()},e.prototype.subtypes=function(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map((function(e){return{name:e.name,code:e.id}})):[]}:null},e.prototype.relationshipMetaData=function(){return this._parent.relationshipMetaData()},e.prototype.schema=function(){for(var e=[],t=0,n=this.fields;t<n.length;t++){var r=n[t];e.push(i.esriFieldToJson(r))}return{objectIdField:this.objectIdField,typeIdField:this.typeIdField,geometryType:void 0===i.layerGeometryEsriRestConstants[this.geometryType]?\"\":i.layerGeometryEsriRestConstants[this.geometryType],hasZ:!0===this.hasZ,hasM:!0===this.hasM,fields:e}},e.prototype.convertToText=function(e,t){var n=this;return\"schema\"===e?this._ensureLoaded().then((function(){return JSON.stringify(n.schema())})):\"featureset\"===e?this._ensureLoaded().then((function(){var e=[];return n.reduce((function(t,n){var r={geometry:n.geometry?n.geometry.toJSON():null,attributes:n.attributes};return null!==r.geometry&&r.geometry.spatialReference&&delete r.geometry.spatialReference,e.push(r),1}),0,t).then((function(){var t=n.schema();return t.features=e,t.spatialReference=n.spatialReference.toJSON(),JSON.stringify(t)}))})):s.resolve(this.castToText())},e.prototype.getFeatureByObjectId=function(e,t){return this._parent.getFeatureByObjectId(e,t)},e._featuresetFunctions={},e}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSet.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSetIterator.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(n,e,t){return function(){function n(n,e){this._lastId=-1,this._progress=e,this._parent=n}return n.prototype.reset=function(){this._lastId=-1},n.prototype.nextBatch=function(n){var e=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(t){return e.nextBatch(n)}),(function(t){return e.nextBatch(n)}));var r={returnpromise:null,hasset:!1},s=[];return r.returnpromise=t.create((function(t,a){e._parent._getSet(e._progress).then((function(_){var i=_._known.length-1;if(\"GETPAGES\"===_._known[_._known.length-1]&&(i-=1),e._lastId+n<i&&_._known.length>0&&\"GETPAGES\"===_._known[_._known.length-1])e._parent._expandPagedSet(_,e._parent._maxQueryRate(),0,0,e._progress).then((function(t){return r.hasset=!0,e._parent._mainSetInUse=null,e.nextBatch(n)}),(function(n){r.hasset=!0,e._parent._mainSetInUse=null,a(n)}));else{if(i>=e._lastId+n||0===_._candidates.length){for(var o=0;o<n;o++){var u=o+e._lastId+1;if(u>=_._known.length)break;s[o]=_._known[u]}return e._lastId+=s.length,0===s.length&&(r.hasset=!0,e._parent._mainSetInUse=null,t([])),void e._parent._getFeatureBatch(s,e._progress).then((function(n){r.hasset=!0,e._parent._mainSetInUse=null,t(n)}),(function(n){r.hasset=!0,e._parent._mainSetInUse=null,a(n)}))}e._parent._refineSetBlock(_,e._parent._maxProcessingRate(),e._progress).then((function(){r.hasset=!0,e._parent._mainSetInUse=null,e.nextBatch(n).then(t,a)}),(function(n){r.hasset=!0,e._parent._mainSetInUse=null,a(n)}))}}),(function(n){r.hasset=!0,e._parent._mainSetInUse=null,a(n)}))})),!1===r.hasset&&(this._parent._mainSetInUse=r.returnpromise,r.hasset=!0),r.returnpromise},n.prototype.next=function(){var n=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(e){return n.next()}),(function(e){return n.next()}));var e={returnpromise:null,hasset:!1};return e.returnpromise=t.create((function(t,r){n._parent._getSet(n._progress).then((function(s){n._lastId<s._known.length-1?\"GETPAGES\"===s._known[n._lastId+1]?n._parent._expandPagedSet(s,n._parent._maxQueryRate(),0,0,n._progress).then((function(t){return e.hasset=!0,n._parent._mainSetInUse=null,n.next()})).then(t,r):(n._lastId+=1,n._parent._getFeature(s,s._known[n._lastId],n._progress).then((function(r){e.hasset=!0,n._parent._mainSetInUse=null,t(r)}),(function(t){e.hasset=!0,n._parent._mainSetInUse=null,r(t)}))):s._candidates.length>0?n._parent._refineSetBlock(s,n._parent._maxProcessingRate(),n._progress).then((function(){e.hasset=!0,n._parent._mainSetInUse=null,n.next().then(t,r)}),(function(t){e.hasset=!0,n._parent._mainSetInUse=null,r(t)})):(e.hasset=!0,n._parent._mainSetInUse=null,t(null))}),(function(t){e.hasset=!0,n._parent._mainSetInUse=null,r(t)}))})),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise},n.prototype.count=function(){var n=this;return-1!==this._parent._totalCount?t.resolve(this._parent._totalCount):this._parent._getSet(this._progress).then((function(e){return n._refineAllSets(e)})).then((function(e){return n._parent._totalCount=e._known.length,t.resolve(n._parent._totalCount)}))},n.prototype._refineAllSets=function(n){var e=this;return n._known.length>0&&\"GETPAGES\"===n._known[n._known.length-1]?this._parent._expandPagedSet(n,this._parent._maxQueryRate(),0,1,this._progress).then((function(t){return e._refineAllSets(n)})).then((function(n){return t.resolve(n)})):n._candidates.length>0?\"GETPAGES\"===n._known[n._candidates.length-1]?this._parent._expandPagedSet(n,this._parent._maxQueryRate(),0,2,this._progress).then((function(t){return e._refineAllSets(n)})).then((function(n){return t.resolve(n)})):this._parent._refineSetBlock(n,this._parent._maxProcessingRate(),this._progress).then((function(n){return n._candidates.length>0?e._refineAllSets(n):t.resolve(n)})):t.resolve(n)},n}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/FeatureSetIterator.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js\":function(module,exports,__webpack_require__){eval(\"var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function(i,n){return function(i,n,e,t){this._candidates=null,this._known=null,this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=i,this._known=n,this._ordered=e,this.pagesDefinition=t}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/IdSet.js?\")},\"./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function(t,e){function r(t,e){return t===e?0:null===t?-1:null===e?1:t<e?-1:1}return function(){function t(t){var e=t.split(\",\");this._fields=[],this._directions=[];for(var r=0;r<e.length;r++){var i=e[r].match(/\\\\S+/g);this._fields.push(i[0]),2===i.length?\"asc\"===i[1].toLowerCase()?this._directions.push(1):this._directions.push(0):this._directions.push(1)}}return t.prototype.constructClause=function(){for(var t=\"\",e=0;e<this._fields.length;e++)0!==e&&(t+=\",\"),t+=this._fields[e],1===this._directions[e]?t+=\" ASC\":t+=\" DESC\";return t},t.prototype.order=function(t){var e=this;t.sort((function(t,i){for(var s=0;s<e._fields.length;s++){var n=e.featureValue(t.feature,e._fields[s],s),o=e.featureValue(i.feature,e._fields[s],s),u=0;if(0!==(u=1===e._directions[s]?r(n,o):-1*r(n,o)))return u}return 0}))},t.prototype.scanForField=function(t){for(var e=0;e<this._fields.length;e++)if(this._fields[e].toLowerCase().trim()===t.toLowerCase().trim())return!0;return!1},t.prototype.replaceFields=function(e){for(var r=\"\",i=0;i<this._fields.length;i++){0!==i&&(r+=\",\");for(var s=this._fields[i],n=0,o=e;n<o.length;n++){var u=o[n];if(s.toLowerCase()===u.field.toLowerCase()){s=u.newfield;break}}r+=s,1===this._directions[i]?r+=\" ASC\":r+=\" DESC\"}return new t(r)},t.prototype.featureValue=function(t,e,r){var i=t.attributes[e];if(void 0!==i)return i;for(var s in t.attributes)if(e.toLowerCase()===s.toLowerCase())return this._fields[r]=s,t.attributes[s];return null},t}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/StatsField.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ./shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ./sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,r,t,n,a){return function(){function e(){}return e.prototype.clone=function(){var r=new e;return r.field=this.field,r.tofieldname=this.tofieldname,r.typeofstat=this.typeofstat,r.workingexpr=this.workingexpr,r},e.parseStatField=function(r,i,s){var o=new e;o.field=r;var l=a.WhereClause.create(i,s),u=function(e){if(\"function\"===e.parseTree.type){if(0===e.parseTree.args.value.length)return{name:e.parseTree.name,expr:null};if(e.parseTree.args.value.length>1)throw new Error(\"Statistic does not have 1 or 0 Parameters\");var r=a.WhereClause.create(n.toWhereClauseFromTree(e.parseTree.args.value[0],t.FeatureServiceDatabaseType.Standardised,e.parameters),e.fieldsIndex);return{name:e.parseTree.name,expr:r}}return null}(l);if(null===u)throw new Error(\"Invalid Statistic Function\");var p=u.name.toUpperCase().trim();if(\"MIN\"===p){if(o.typeofstat=\"MIN\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else if(\"MAX\"===p){if(o.typeofstat=\"MAX\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else if(\"COUNT\"===p)o.typeofstat=\"COUNT\",o.workingexpr=u.expr;else if(\"STDEV\"===p){if(o.typeofstat=\"STDDEV\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else if(\"SUM\"===p){if(o.typeofstat=\"SUM\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else if(\"MEAN\"===p){if(o.typeofstat=\"AVG\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else if(\"AVG\"===p){if(o.typeofstat=\"AVG\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}else{if(\"VAR\"!==p)throw new Error(\"Invalid Statistic Function\");if(o.typeofstat=\"VAR\",o.workingexpr=u.expr,null===l)throw new Error(\"Invalid Statistic Function Parameters\")}return o},e.prototype.toStatisticsName=function(){switch(this.typeofstat.toUpperCase()){case\"MIN\":return\"min\";case\"MAX\":return\"max\";case\"SUM\":return\"sum\";case\"COUNT\":return\"count\";case\"VAR\":return\"var\";case\"STDDEV\":return\"stddev\";case\"AVG\":return\"avg\";default:return\"count\"}},e}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/StatsField.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/cache.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function(t,e){return function(){function t(){this._databaseTypeMetaData={},this._layerInfo={}}return t.prototype.clearDatabaseType=function(t){void 0===this._databaseTypeMetaData[t]&&delete this._databaseTypeMetaData[t]},t.prototype.getDatabaseType=function(t){return\"MUSTBESET\"===t?null:void 0===this._databaseTypeMetaData[t]?null:this._databaseTypeMetaData[t]},t.prototype.setDatabaseType=function(t,e){this._databaseTypeMetaData[t]=e},t.prototype.getLayerInfo=function(t){return void 0===this._layerInfo[t]?null:this._layerInfo[t]},t.prototype.setLayerInfo=function(t,e){this._layerInfo[t]=e},t.prototype.clearLayerInfo=function(t){void 0!==this._layerInfo[t]&&delete this._layerInfo[t]},t.applicationCache=null,t}()}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/cache.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ./shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,r,a,t,n){function s(e,r){return o(e.parseTree,r,e.parameters)}function o(e,r,a,t,n){var s,l,f,p;switch(void 0===t&&(t=null),void 0===n&&(n=null),e.type){case\"interval\":return d(o(e.value,r,a,t,n),e.qualifier,e.op);case\"case_expression\":var g=\" CASE \";\"simple\"===e.format&&(g+=o(e.operand,r,a,t,n));for(var h=0;h<e.clauses.length;h++)g+=\" WHEN \"+o(e.clauses[h].operand,r,a,t,n)+\" THEN \"+o(e.clauses[h].value,r,a,t,n);return null!==e.else&&(g+=\" ELSE \"+o(e.else,r,a,t,n)),g+=\" END \";case\"param\":var v=a[e.value.toLowerCase()];if(\"string\"==typeof v)return\"\\'\"+a[e.value.toLowerCase()].toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\";if(v instanceof Date)return u(v,r);if(v instanceof Array){var T=[];for(h=0;h<v.length;h++)\"string\"==typeof v[h]?T.push(\"\\'\"+v[h].toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\"):v[h]instanceof Date?T.push(u(v[h],r)):T.push(v[h].toString());return T}return v.toString();case\"expr_list\":l=[];for(var S=0,E=e.value;S<E.length;S++){var m=E[S];l.push(o(m,r,a,t,n))}return l;case\"unary_expr\":return\" ( NOT \"+o(e.expr,r,a,t,n)+\" ) \";case\"binary_expr\":switch(e.operator){case\"AND\":return\" (\"+o(e.left,r,a,t,n)+\" AND \"+o(e.right,r,a,t,n)+\") \";case\"OR\":return\" (\"+o(e.left,r,a,t,n)+\" OR \"+o(e.right,r,a,t,n)+\") \";case\"IS\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\" (\"+o(e.left,r,a,t,n)+\" IS NULL )\";case\"ISNOT\":if(\"null\"!==e.right.type)throw new Error(\"Unsupported RHS for IS\");return\" (\"+o(e.left,r,a,t,n)+\" IS NOT NULL )\";case\"IN\":return s=[],\"expr_list\"===e.right.type?(s=o(e.right,r,a,t,n),\" (\"+o(e.left,r,a,t,n)+\" IN (\"+s.join(\",\")+\")) \"):(p=o(e.right,r,a,t,n))instanceof Array?\" (\"+o(e.left,r,a,t,n)+\" IN (\"+p.join(\",\")+\")) \":\" (\"+o(e.left,r,a,t,n)+\" IN (\"+p+\")) \";case\"NOT IN\":return s=[],\"expr_list\"===e.right.type?(s=o(e.right,r,a,t,n),\" (\"+o(e.left,r,a,t,n)+\" NOT IN (\"+s.join(\",\")+\")) \"):(p=o(e.right,r,a,t,n))instanceof Array?\" (\"+o(e.left,r,a,t,n)+\" NOT IN (\"+p.join(\",\")+\")) \":\" (\"+o(e.left,r,a,t,n)+\" NOT IN (\"+p+\")) \";case\"BETWEEN\":return f=o(e.right,r,a,t,n),\" (\"+o(e.left,r,a,t,n)+\" BETWEEN \"+f[0]+\" AND \"+f[1]+\" ) \";case\"NOTBETWEEN\":return f=o(e.right,r,a,t,n),\" (\"+o(e.left,r,a,t,n)+\" NOT BETWEEN \"+f[0]+\" AND \"+f[1]+\" ) \";case\"LIKE\":return\"\"!==e.escape?\" (\"+o(e.left,r,a,t,n)+\" LIKE \"+o(e.right,r,a,t,n)+\" ESCAPE \\'\"+e.escape+\"\\') \":\" (\"+o(e.left,r,a,t,n)+\" LIKE \"+o(e.right,r,a,t,n)+\") \";case\"NOT LIKE\":return\"\"!==e.escape?\" (\"+o(e.left,r,a,t,n)+\" NOT LIKE \"+o(e.right,r,a,t,n)+\" ESCAPE \\'\"+e.escape+\"\\') \":\" (\"+o(e.left,r,a,t,n)+\" NOT LIKE \"+o(e.right,r,a,t,n)+\") \";case\"<>\":case\"<\":case\">\":case\">=\":case\"<=\":case\"=\":case\"*\":case\"-\":case\"+\":case\"/\":return\" (\"+o(e.left,r,a,t,n)+\" \"+e.operator+\" \"+o(e.right,r,a,t,n)+\") \"}throw new Error(\"Not Supported Operator \"+e.operator);case\"null\":return\"null\";case\"bool\":return!0===e.value?\"1\":\"0\";case\"string\":return\"\\'\"+e.value.toString().replace(/\\'/g,\"\\'\\'\")+\"\\'\";case\"timestamp\":case\"date\":return u(e.value,r);case\"number\":return e.value.toString();case\"current_time\":return i(\"date\"===e.mode,r);case\"column_ref\":return t&&t.toLowerCase()===e.column.toLowerCase()?\"(\"+n+\")\":e.column;case\"function\":var D=o(e.args,r,a,t,n);return c(e.name,D,r)}throw new Error(\"Unsupported sql syntax \"+e.type)}function c(e,r,a){switch(e.toLowerCase().trim()){case\"abs\":if(1!==r.length)throw new Error(\"Invalid Parameter for call to ABS\");return\"abs(\"+r[0]+\")\";case\"ceiling\":case\"ceil\":if(1!==r.length)throw new Error(\"Invalid Parameter for call to CEILING\");switch(a){case t.FeatureServiceDatabaseType.Standardised:case t.FeatureServiceDatabaseType.StandardisedNoInterval:default:return\"CEILING(\"+r[0]+\")\"}case\"floor\":if(1!==r.length)throw new Error(\"Invalid Parameter for call to Floor\");return\"FLOOR(\"+r[0]+\")\";case\"log\":if(1!==r.length)throw new Error(\"Invalid Parameter for call to LOG\");return\"LOG(\"+r[0]+\")\";case\"log10\":if(1!==r.length)throw new Error(\"Invalid Parameter for call to LOG10\");return\"LOG10(\"+r[0]+\")\";case\"power\":if(2!==r.length)throw new Error(\"Invalid Parameter for call to POWER\");return\"POWER(\"+r[0]+\",\"+r[1]+\")\";case\"round\":if(2===r.length)return\"ROUND(\"+r[0]+\",\"+r[1]+\")\";if(1===r.length)return\"ROUND(\"+r[0]+\")\";throw new Error(\"Invalid Parameter for call to ROUND\");case\"truncate\":if(r.length<1||r.length>2)throw new Error(\"Invalid Parameter for TRUNCATE function\");switch(a){case t.FeatureServiceDatabaseType.SqlServer:return\"ROUND(\"+r[0]+(1===r.length?\"0\":\",\"+r[1])+\",1)\";default:return\"TRUNCATE(\"+r[0]+(1===r.length?\")\":\",\"+r[1]+\")\")}case\"char_length\":case\"len\":if(1!==r.length)throw new Error(\"Invalid Parameter for CHAR_LENGTH function\");switch(a){case t.FeatureServiceDatabaseType.SqlServer:return\"LEN(\"+r[0]+\")\";case t.FeatureServiceDatabaseType.Oracle:return\"LENGTH(\"+r[0]+\")\";default:return\"CHAR_LENGTH(\"+r[0]+\")\"}case\"concat\":if(r.length<1)throw new Error(\"Invalid Parameter for CONCAT function\");for(var n=\"CONCAT(\",s=0;s<r.length;s++)0!==s&&(n+=\",\"),n+=r[s];return n+=\")\";case\"lower\":case\"lcase\":if(1!==r.length)throw new Error(\"Invalid Parameter for Lower function\");return\"LOWER(\"+r[0]+\")\";case\"upper\":case\"ucase\":if(1!==r.length)throw new Error(\"Invalid Parameter for Upper function\");return\"UPPER(\"+r[0]+\")\";case\"substring\":var o=\"\";switch(a){case t.FeatureServiceDatabaseType.Oracle:return o=\"SUBSTR(\"+r[0]+\",\"+r[1],3===r.length&&(o+=\",\"+r[2]),o+=\")\";case t.FeatureServiceDatabaseType.SqlServer:return o=3===r.length?\"SUBSTRING(\"+r[0]+\",\"+r[1]+\",\"+r[2]+\")\":\"SUBSTRING(\"+r[0]+\",  \"+r[1]+\", LEN(\"+r[0]+\") - \"+r[1]+\")\";default:return o=\"SUBSTRING(\"+r[0]+\" FROM \"+r[1],3===r.length&&(o+=\" FOR \"+r[2]),o+=\")\"}case\"extract\":return\"EXTRACT(\"+r[0].replace(/\\\\\\'/g,\"\")+\" FROM \"+r[1]+\")\"}throw new Error(\"Function Not Recognised\")}function u(e,r){var n=a.MomentLibrary.Moment(e),s=0===n.minute()&&0===n.hour()&&0===n.second()&&0===n.millisecond();switch(r){case t.FeatureServiceDatabaseType.FILEGDB:case t.FeatureServiceDatabaseType.Standardised:case t.FeatureServiceDatabaseType.StandardisedNoInterval:return s?\"date \\'\"+n.format(\"YYYY-MM-DD\")+\"\\'\":\"date \\'\"+n.format(\"YYYY-MM-DD HH:mm:ss\")+\"\\'\";case t.FeatureServiceDatabaseType.Oracle:return s?\"TO_DATE(\\'\"+n.format(\"YYYY-MM-DD\")+\"\\',\\'YYYY-MM-DD\\')\":\"TO_DATE(\\'\"+n.format(\"YYYY-MM-DD HH:mm:ss\")+\"\\',\\'YYYY-MM-DD HH24:MI:SS\\')\";case t.FeatureServiceDatabaseType.SqlServer:return\"\\'\"+n.format(s?\"YYYY-MM-DD\":\"YYYY-MM-DD HH:mm:ss\")+\"\\'\";case t.FeatureServiceDatabaseType.PGDB:return\"#\"+n.format(s?\"MM-DD-YYYY\":\"MM-DD-YYYY HH:mm:ss\")+\"#\";case t.FeatureServiceDatabaseType.Postgres:return\"TIMESTAMP \\'\"+n.format(s?\"YYYY-MM-DD\":\"YYYY-MM-DD HH:mm:ss\")+\"\\'\";default:return\"date \\'\"+n.format(\"YYYY-MM-DD HH:mm:ss\")+\"\\'\"}}function i(e,r){switch(r){case t.FeatureServiceDatabaseType.FILEGDB:case t.FeatureServiceDatabaseType.Standardised:case t.FeatureServiceDatabaseType.StandardisedNoInterval:case t.FeatureServiceDatabaseType.Oracle:return e?\"CURRENT_DATE\":\"CURRENT_TIMESTAMP\";case t.FeatureServiceDatabaseType.SqlServer:return e?\"CAST(GETDATE() AS DATE)\":\"GETDATE()\";case t.FeatureServiceDatabaseType.PGDB:case t.FeatureServiceDatabaseType.Postgres:default:return e?\"CURRENT_DATE\":\"CURRENT_TIMESTAMP\"}}Object.defineProperty(r,\"__esModule\",{value:!0}),r.toWhereClause=s,r.toWhereClauseFromTree=function(e,r,a){return o(e,r,a)},r.reformulateWithoutField=function(e,r,a,s){return n.WhereClause.create(o(e.parseTree,t.FeatureServiceDatabaseType.Standardised,e.parameters,r,a),s)},r.combine=function(e,r,a){return void 0===a&&(a=\"AND\"),n.WhereClause.create(\"((\"+s(e,t.FeatureServiceDatabaseType.Standardised)+\")\"+a+\"(\"+s(r,t.FeatureServiceDatabaseType.Standardised)+\"))\",e.fieldsIndex)},r.translateFunctionToDatabaseSpecific=c,r.makeDateString=u,r.makeToday=i,r.predictType=function(e,r,a){void 0===a&&(a={});for(var t={},n={},s={esriFieldTypeSmallInteger:\"integer\",esriFieldTypeInteger:\"integer\",esriFieldTypeSingle:\"double\",esriFieldTypeDouble:\"double\",esriFieldTypeString:\"string\",esriFieldTypeDate:\"date\",esriFieldTypeOID:\"integer\",oid:\"integer\",long:\"integer\",\"small-integer\":\"integer\",integer:\"integer\",single:\"double\",double:\"double\",date:\"date\",string:\"string\"},o=0,c=r;o<c.length;o++){var u=s[(i=c[o]).type];t[i.name.toLowerCase()]=void 0===u?\"\":u}for(var i in a){u=s[a[i]];n[i.toLowerCase()]=void 0===u?\"\":u}switch(function e(r,a,t,n){var s;switch(a.type){case\"interval\":return\"integer\";case\"case_expression\":var o=[];if(\"simple\"===a.format){for(var c=0;c<a.clauses.length;c++)o.push(e(r,a.clauses[c].value,t,n));null!==a.else&&o.push(e(r,a.else,t,n))}else{for(c=0;c<a.clauses.length;c++)o.push(e(r,a.else,t,n));null!==a.else&&o.push(e(r,a.else,t,n))}return f(o);case\"param\":var u=n[a.value.toLowerCase()];if(void 0===u&&t){var i=t[a.value.toLowerCase()];if(void 0===i)return\"\";if(null===i)return\"\";if(\"string\"==typeof i||i instanceof String)return\"string\";if(\"boolean\"==typeof i)return\"boolean\";if(i instanceof Date)return\"date\";if(\"number\"==typeof i)return i%1==0?\"integer\":\"double\"}return void 0===u?\"\":u;case\"expr_list\":for(var l=[],p=0,d=a.value;p<d.length;p++){var g=d[p];l.push(e(r,g,t,n))}return l;case\"unary_expr\":return\"boolean\";case\"binary_expr\":switch(a.operator){case\"AND\":case\"OR\":return\"boolean\";case\"IS\":case\"ISNOT\":if(\"null\"!==a.right.type)throw new Error(\"Unsupported RHS for IS\");return\"boolean\";case\"IN\":case\"NOT IN\":case\"BETWEEN\":case\"NOTBETWEEN\":case\"LIKE\":case\"NOT LIKE\":return\"boolean\";case\"<>\":case\"<\":case\">\":case\">=\":case\"<=\":case\"=\":return\"boolean\";case\"*\":case\"-\":case\"+\":case\"/\":return f([e(r,a.left,t,n),e(r,a.right,t,n)]);default:throw new Error(\"Not Supported Operator \"+a.operator)}case\"null\":return\"\";case\"bool\":return\"boolean\";case\"string\":return\"string\";case\"number\":return null===a.value?\"\":a.value%1==0?\"integer\":\"double\";case\"date\":case\"timestamp\":case\"current_time\":return\"date\";case\"column_ref\":var h=r[a.column.toLowerCase()];return void 0===h?\"\":h;case\"function\":switch(a.name.toLowerCase()){case\"position\":case\"extract\":case\"char_length\":return\"integer\";case\"round\":return(s=e(r,a.args,t,n))instanceof Array?s.length>0?s[0]:\"\":s;case\"sign\":return(s=e(r,a.args,t,n))instanceof Array&&(s=f(s)),\"integer\"===s||\"double\"===s?s:\"double\";case\"ceiling\":case\"floor\":case\"abs\":var v=e(r,a.args,t,n);return v instanceof Array?f(v):v;case\"area\":case\"length\":case\"log\":case\"log10\":case\"sin\":case\"cos\":case\"tan\":case\"asin\":case\"acos\":case\"atan\":case\"power\":return\"double\";case\"substring\":case\"trim\":case\"concat\":case\"lower\":case\"upper\":return\"string\";case\"truncate\":return\"double\";case\"round\":return(s=e(r,a.args,t,n))instanceof Array?s.length>0?s[0]:\"\":s}return\"\"}throw new Error(\"Unsupported sql syntax \"+a.type)}(t,e.parseTree,e.parameters,n)){case\"double\":return\"double\";case\"integer\":return\"integer\";case\"double\":return\"double\";case\"date\":return\"date\";case\"string\":return\"string\"}return\"\"};var l={boolean:1,string:2,integer:3,double:4,date:5};function f(e){if(e){for(var r=\"\",a=0,t=e;a<t.length;a++){var n=t[a];\"\"!==n&&(r=\"\"===r?n:l[r]<l[n]?n:r)}return r}return\"\"}function p(e){var r=\"\";return r+=e.period.toUpperCase()}function d(e,r,a){return\"INTERVAL \"+a+\" \"+e+\" \"+(\"interval-period\"===r.type?p(r):p(r.start)+\" TO \"+p(r.end))}r.scanForField=function(e,r){return function e(r,a){if(null==r)return!1;switch(r.type){case\"when_clause\":return e(r.operand,a)||e(r.value,a);case\"case_expression\":for(var t=0,n=r.clauses;t<n.length;t++){var s=n[t];if(e(s,a))return!0}return!(\"simple\"!==r.format||!e(r.operand,a))||!(null===r.else||!e(r.else,a));case\"param\":return!1;case\"expr_list\":for(var o=0,c=r.value;o<c.length;o++){s=c[o];if(e(s,a))return!0}return!1;case\"unary_expr\":return e(r.expr,a);case\"binary_expr\":return e(r.left,a)||e(r.right,a);case\"null\":case\"bool\":case\"date\":case\"timestamp\":case\"string\":case\"number\":return!1;case\"column_ref\":return a.toLowerCase()===r.column.toLowerCase();case\"function\":return e(r.args,a)}return!1}(e.parseTree,r)},r.isSingleField=function(e){return\"column_ref\"===e.parseTree.type},r.convertIntervalToSql=d}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js?')},\"./node_modules/arcgis-js-api/arcade/featureset/support/stats.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ./shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ./sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ../../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(t,n,e,r,u,a){function c(t){for(var n=0,e=0;e<t.length;e++)n+=t[e];return n/t.length}function i(t){for(var n=c(t),e=0,r=0;r<t.length;r++)e+=Math.pow(n-t[r],2);return e/t.length}function l(t){for(var n=c(t),e=0,r=0;r<t.length;r++)e+=Math.pow(n-t[r],2);return e/(t.length-1)}function o(t){for(var n=0,e=0;e<t.length;e++)n+=t[e];return n}function s(t,n,r,u){void 0===u&&(u=!1);try{var c=t.iterator(r);return a.create((function(t,r){!function t(n,r,u,a,c,i){e.tick(n.next().then((function(e){try{if(null!==e){var l=u.calculateValue(e);return null===l?!1===a&&(r[r.length]=l):r[r.length]=l,t(n,r,u,a,c,i)}c(r)}catch(t){i(t)}}),i))}(c,[],n,u,t,r)}))}catch(t){return a.reject(t)}}Object.defineProperty(n,\"__esModule\",{value:!0}),n.decodeStatType=function(t){switch(t.toLowerCase()){case\"distinct\":return\"distinct\";case\"avg\":case\"mean\":return\"avg\";case\"min\":return\"min\";case\"sum\":return\"sum\";case\"max\":return\"max\";case\"stdev\":case\"stddev\":return\"stddev\";case\"var\":case\"variance\":return\"var\";case\"count\":return\"count\"}return\"\"},n.calculateStat=function(t,n,e){switch(void 0===e&&(e=1e3),t.toLowerCase()){case\"distinct\":return function(t,n){for(var e=[],u={},a=[],c=0;c<t.length;c++){if(void 0!==t[c]&&null!==t[c]){var i=t[c];if(r.isNumber(i)||r.isString(i))void 0===u[i]&&(e.push(i),u[i]=1);else{for(var l=!1,o=0;o<a.length;o++)!0===r.equalityTest(a[o],i)&&(l=!0);!1===l&&(a.push(i),e.push(i))}}if(e.length>=n&&-1!==n)return e}return e}(n,e);case\"avg\":case\"mean\":return c(n);case\"min\":return Math.min.apply(Math,n);case\"sum\":return o(n);case\"max\":return Math.max.apply(Math,n);case\"stdev\":case\"stddev\":return Math.sqrt(i(n));case\"var\":case\"variance\":return i(n);case\"count\":return n.length}return 0},n.min=function(t,n,e){return s(t,n,e,!0).then((function(t){return 0===t.length?null:Math.min.apply(Math,t)}))},n.max=function(t,n,e){return s(t,n,e,!0).then((function(t){return 0===t.length?null:Math.max.apply(Math,t)}))},n.mean=function(t,n,e){var r=\"\";return!1===u.isSingleField(n)&&(r=u.predictType(n,t.fields,null)),s(t,n,e,!0).then((function(t){if(0===t.length)return null;var n,e=c(t);return null===e?e:\"integer\"===r?(n=+(n=e),isFinite(n)?n-n%1||(n<0?-0:0===n?n:0):n):e}))},n.variance=function(t,n,e){return s(t,n,e,!0).then((function(t){return 0===t.length?null:l(t)}))},n.stdev=function(t,n,e){return s(t,n,e,!0).then((function(t){return 0===t.length?null:Math.sqrt(l(t))}))},n.sum=function(t,n,e){return s(t,n,e,!0).then((function(t){return 0===t.length?null:o(t)}))},n.count=function(t,n){try{return t.iterator(n).count()}catch(t){return a.reject(t)}},n.distinct=function(t,n,e,r){return void 0===e&&(e=1e3),void 0===r&&(r=null),function(t,n,e,r){try{return function t(n,e,r,u,a){return n.next().then((function(c){if(null!==c){var i=u.calculateValue(c);return null!=i&&void 0===e[i]&&(r.push(i),e[i]=1),r.length>=a&&-1!==a?r:t(n,e,r,u,a)}return r}))}(t.iterator(r),{},[],n,e)}catch(t){return a.reject(t)}}(t,n,e,r)}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/featureset/support/stats.js?')},\"./node_modules/arcgis-js-api/arcade/functions/featuresetbase.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../ArcadePortal */ \"./node_modules/arcgis-js-api/arcade/ArcadePortal.js\"),__webpack_require__(/*! ../Dictionary */ \"./node_modules/arcgis-js-api/arcade/Dictionary.js\"),__webpack_require__(/*! ../Dictionary */ \"./node_modules/arcgis-js-api/arcade/Dictionary.js\"),__webpack_require__(/*! ../Feature */ \"./node_modules/arcgis-js-api/arcade/Feature.js\"),__webpack_require__(/*! ../featureSetCollection */ \"./node_modules/arcgis-js-api/arcade/featureSetCollection.js\"),__webpack_require__(/*! ../featureSetUtils */ \"./node_modules/arcgis-js-api/arcade/featureSetUtils.js\"),__webpack_require__(/*! ../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ../featureset/actions/Adapted */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/Adapted.js\"),__webpack_require__(/*! ../featureset/actions/AttributeFilter */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/AttributeFilter.js\"),__webpack_require__(/*! ../featureset/actions/OrderBy */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/OrderBy.js\"),__webpack_require__(/*! ../featureset/actions/Top */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/Top.js\"),__webpack_require__(/*! ../featureset/sources/Empty */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js\"),__webpack_require__(/*! ../featureset/sources/FeatureLayerMemory */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/FeatureLayerMemory.js\"),__webpack_require__(/*! ../featureset/support/OrderbyClause */ \"./node_modules/arcgis-js-api/arcade/featureset/support/OrderbyClause.js\"),__webpack_require__(/*! ../featureset/support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\"),__webpack_require__(/*! ../featureset/support/sqlUtils */ \"./node_modules/arcgis-js-api/arcade/featureset/support/sqlUtils.js\"),__webpack_require__(/*! ./fieldStats */ \"./node_modules/arcgis-js-api/arcade/functions/fieldStats.js\"),__webpack_require__(/*! ../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\"),__webpack_require__(/*! ../../layers/FeatureLayer */ \"./node_modules/arcgis-js-api/layers/FeatureLayer.js\"),__webpack_require__(/*! ../../layers/support/Field */ \"./node_modules/arcgis-js-api/layers/support/Field.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,r,n,a,i,l,s,o,u,f,d,c,p,m,g,y,h,F,v,S,I,E){function A(e,t,r){var n=e.getVariables();if(n.length>0){for(var a=[],i=0;i<n.length;i++){var l={name:n[i]};a.push(t.evaluateIdentifier(r,l))}return v.all(a).then((function(t){for(var r={},a=0;a<n.length;a++)r[n[a]]=t[a];return e.parameters=r,e}))}return v.resolve(e)}function b(e,t,r){for(var n in void 0===r&&(r=null),e)if(n.toLowerCase()===t.toLowerCase())return e[n];return r}function D(e){if(null===e)return null;var t={type:b(e,\"type\",\"\"),name:b(e,\"name\",\"\")};if(\"range\"===t.type)t.range=b(e,\"range\",[]);else{t.codedValues=[];for(var r=0,n=b(e,\"codedValues\",[]);r<n.length;r++){var a=n[r];t.codedValues.push({name:b(a,\"name\",\"\"),code:b(a,\"code\",null)})}}return t}function w(e){if(null===e)return null;var t={},r=b(e,\"wkt\",null);null!==r&&(t.wkt=r);var n=b(e,\"wkid\",null);return null!==n&&(t.wkid=n),t}function x(e){if(null===e)return null;var t={hasZ:b(e,\"hasz\",!1),hasM:b(e,\"hasm\",!1)},r=b(e,\"spatialreference\",null);r&&(t.spatialReference=w(r));var n=b(e,\"x\",null);if(null!==n)return t.x=n,t.y=b(e,\"y\",null),t;var a=b(e,\"rings\",null);if(null!==a)return t.rings=a,t;var i=b(e,\"paths\",null);if(null!==i)return t.paths=i,t;var l=b(e,\"points\",null);if(null!==l)return t.points=l,t;for(var s=0,o=[\"xmin\",\"xmax\",\"ymin\",\"ymax\",\"zmin\",\"zmax\",\"mmin\",\"mmax\"];s<o.length;s++){var u=o[s],f=b(e,u,null);null!==f&&(t[u]=f)}return t}Object.defineProperty(t,\"__esModule\",{value:!0}),t.registerFunctions=function(e){\"async\"===e.mode&&(e.functions.featuresetbyid=function(t,r){return e.standardFunctionAsync(t,r,(function(e,t,r){if(o.pcCheck(r,2,4),r[0]instanceof l){var n=o.toString(r[1]),a=o.defaultUndefined(r[2],null),i=o.toBoolean(o.defaultUndefined(r[3],!0));if(null===a&&(a=[\"*\"]),!1===o.isArray(a))throw new Error(\"Invalid Parameter\");return r[0].featureSetById(n,i,a)}throw new Error(\"Invalid Parameter\")}))},e.signatures.push({name:\"featuresetbyid\",min:\"2\",max:\"4\"}),e.functions.featuresetbyportalitem=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){if(o.pcCheck(a,2,5),null===a[0])throw new Error(\"Portal is required\");if(a[0]instanceof r){var i=o.toString(a[1]),l=o.toString(a[2]),u=o.defaultUndefined(a[3],null),f=o.toBoolean(o.defaultUndefined(a[4],!0));if(null===u&&(u=[\"*\"]),!1===o.isArray(u))throw new Error(\"Invalid Parameter\");var d=null;return t.services&&t.services.portal&&(d=t.services.portal),d=s.getPortal(a[0],d),s.constructFeatureSetFromPortalItem(i,l,t.spatialReference,u,f,d,t.lrucache)}if(!1===o.isString(a[0]))throw new Error(\"Portal is required\");var c=o.toString(a[0]),p=o.toString(a[1]),m=o.defaultUndefined(a[2],null),g=o.toBoolean(o.defaultUndefined(a[3],!0));if(null===m&&(m=[\"*\"]),!1===o.isArray(m))throw new Error(\"Invalid Parameter\");if(t.services&&t.services.portal)return s.constructFeatureSetFromPortalItem(c,p,t.spatialReference,m,g,t.services.portal,t.lrucache);throw new Error(\"Portal is required\")}))},e.signatures.push({name:\"featuresetbyportalitem\",min:\"2\",max:\"5\"}),e.functions.featuresetbyname=function(t,r){return e.standardFunctionAsync(t,r,(function(e,t,r){if(o.pcCheck(r,2,4),r[0]instanceof l){var n=o.toString(r[1]),a=o.defaultUndefined(r[2],null),i=o.toBoolean(o.defaultUndefined(r[3],!0));if(null===a&&(a=[\"*\"]),!1===o.isArray(a))throw new Error(\"Invalid Parameter\");return r[0].featureSetByName(n,i,a)}throw new Error(\"Invalid Parameter\")}))},e.signatures.push({name:\"featuresetbyname\",min:\"2\",max:\"4\"}),e.functions.featureset=function(t,r){return e.standardFunction(t,r,(function(e,r,a){o.pcCheck(a,1,1);var i,l=a[0],s={layerDefinition:{geometryType:\"\",objectIdField:\"\",typeIdField:\"\",fields:[]},featureSet:{geometryType:\"\",features:[]}};if(o.isString(l))void 0!==(l=JSON.parse(l)).layerDefinition?(s.layerDefinition=l.layerDefinition,s.featureSet=l.featureSet,l.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=l.layerDefinition.spatialReference)):(s.featureSet.features=l.features,s.featureSet.geometryType=l.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=l.objectIdFieldName,s.layerDefinition.typeIdField=l.typeIdFieldName,s.layerDefinition.fields=l.fields,l.spatialReference&&(s.layerDefinition.spatialReference=l.spatialReference));else{if(!(a[0]instanceof n))throw new Error(\"Invalid Parameter\");var u=b(l=JSON.parse(a[0].castToText()),\"layerdefinition\");if(null!==u){s.layerDefinition.geometryType=b(u,\"geometrytype\",\"\"),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=b(u,\"objectidfield\",\"\"),s.layerDefinition.typeIdField=b(u,\"typeidfield\",\"\"),(A=b(u,\"spatialreference\",null))&&(s.layerDefinition.spatialReference=w(A));for(var f=0,d=b(u,\"fields\",[]);f<d.length;f++){var c={name:b(T=d[f],\"name\",\"\"),alias:b(T,\"alias\",\"\"),type:b(T,\"type\",\"\"),nullable:b(T,\"nullable\",!0),editable:b(T,\"editable\",!0),length:b(T,\"length\",null),domain:D(b(T,\"domain\"))};s.layerDefinition.fields.push(c)}var p=b(l,\"featureset\",null);if(p){for(var g={},y=0,h=s.layerDefinition.fields;y<h.length;y++){g[(E=h[y]).name.toLowerCase()]=E.name}for(var F=0,v=b(p,\"features\",[]);F<v.length;F++){var S={},I=b(W=v[F],\"attributes\",{});for(var E in I)S[g[E.toLowerCase()]]=I[E];s.featureSet.features.push({attributes:S,geometry:x(b(W,\"geometry\",null))})}}}else{var A;s.layerDefinition.geometryType=b(l,\"geometrytype\",\"\"),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=b(l,\"objectidfieldname\",\"\"),s.layerDefinition.typeIdField=b(l,\"typeidfieldname\",\"\"),(A=b(l,\"spatialreference\",null))&&(s.layerDefinition.spatialReference=w(A));for(var N=0,C=b(l,\"fields\",[]);N<C.length;N++){var T;c={name:b(T=C[N],\"name\",\"\"),alias:b(T,\"alias\",\"\"),type:b(T,\"type\",\"\"),nullable:b(T,\"nullable\",!0),editable:b(T,\"editable\",!0),length:b(T,\"length\",null),domain:D(b(T,\"domain\"))};s.layerDefinition.fields.push(c)}g={};for(var L=0,R=s.layerDefinition.fields;L<R.length;L++){g[(E=R[L]).name.toLowerCase()]=E.name}for(var k=0,O=b(l,\"features\",[]);k<O.length;k++){var W;S={},I=b(W=O[k],\"attributes\",{});for(var E in I)S[g[E.toLowerCase()]]=I[E];s.featureSet.features.push({attributes:S,geometry:x(b(W,\"geometry\",null))})}}}if(!1==(!!(i=s).layerDefinition&&!!i.featureSet&&!1!==function(e,t){for(var r=0,n=t;r<n.length;r++)if(n[r]===e)return!0;return!1}(i.layerDefinition.geometryType,[\"\",\"esriGeometryPoint\",\"esriGeometryPolyline\",\"esriGeometryPolygon\",\"esriGeometryMultipoint\",\"esriGeometryEnvelope\"])&&null!==i.layerDefinition.objectIdField&&\"\"!==i.layerDefinition.objectIdField&&!1!==o.isArray(i.layerDefinition.fields)&&!1!==o.isArray(i.featureSet.features)))throw new Error(\"Invalid Parameter\");return m.create(s,t.spatialReference)}))},e.signatures.push({name:\"featureset\",min:\"1\",max:\"1\"}),e.functions.filter=function(t,r){return e.standardFunctionAsync(t,r,(function(r,n,a){return o.pcCheck(a,2,2),o.isFeatureSet(a[0])?a[0].load().then((function(r){var n=S.WhereClause.create(a[1],r.getFieldsIndex()),i=n.getVariables();if(i.length>0){for(var l=[],s=0;s<i.length;s++){var o={name:i[s]};l.push(e.evaluateIdentifier(t,o))}return v.all(l).then((function(e){for(var t={},r=0;r<i.length;r++)t[i[r]]=e[r];return n.parameters=t,new f({parentfeatureset:a[0],whereclause:n})}))}return v.resolve(new f({parentfeatureset:a[0],whereclause:n}))})):e.failDefferred(\"Filter cannot accept this parameter type\")}))},e.signatures.push({name:\"filter\",min:\"2\",max:\"2\"}),e.functions.orderby=function(t,r){return e.standardFunctionAsync(t,r,(function(t,r,n){if(o.pcCheck(n,2,2),o.isFeatureSet(n[0])){var a=new g(n[1]);return v.resolve(new d({parentfeatureset:n[0],orderbyclause:a}))}return e.failDefferred(\"Order cannot accept this parameter type\")}))},e.signatures.push({name:\"orderby\",min:\"2\",max:\"2\"}),e.functions.top=function(t,r){return e.standardFunctionAsync(t,r,(function(t,r,n){return o.pcCheck(n,2,2),o.isFeatureSet(n[0])?v.resolve(new c({parentfeatureset:n[0],topnum:n[1]})):o.isArray(n[0])?o.toNumber(n[1])>=n[0].length?n[0].slice(0):n[0].slice(0,o.toNumber(n[1])):o.isImmutableArray(n[0])?o.toNumber(n[1])>=n[0].length()?n[0].slice(0):n[0].slice(0,o.toNumber(n[1])):e.failDefferred(\"Top cannot accept this parameter type\")}))},e.signatures.push({name:\"top\",min:\"2\",max:\"2\"}),e.functions.first=function(t,r){return e.standardFunctionAsync(t,r,(function(e,t,r){return o.pcCheck(r,1,1),o.isFeatureSet(r[0])?r[0].first(e.abortSignal).then((function(e){if(null!==e){var t=i.createFromGraphicLikeObject(e.geometry,e.attributes,r[0]);t._underlyingGraphic=e,e=t}return e})):o.isArray(r[0])?0===r[0].length?v.resolve(null):v.resolve(r[0][0]):o.isImmutableArray(r[0])?0===r[0].length()?v.resolve(null):v.resolve(r[0].get(0)):null}))},e.signatures.push({name:\"first\",min:\"1\",max:\"1\"}),e.functions.attachments=function(t,r){return e.standardFunctionAsync(t,r,(function(e,r,a){o.pcCheck(a,1,2);var l={minsize:-1,maxsize:-1,types:null};if(a.length>1)if(a[1]instanceof n){if(a[1].hasField(\"minsize\")&&(l.minsize=o.toNumber(a[1].field(\"minsize\"))),a[1].hasField(\"maxsize\")&&(l.maxsize=o.toNumber(a[1].field(\"maxsize\"))),a[1].hasField(\"types\")){var u=o.toStringArray(a[1].field(\"types\"),!1);u.length>0&&(l.types=u)}}else if(null!==a[1])throw new Error(\"Invalid Parameter\");if(a[0]instanceof i){var f=a[0]._layer;return f instanceof I&&(f=s.constructFeatureSet(f,t.spatialReference,[\"*\"],!0,t.lrucache)),null===f?[]:!1===o.isFeatureSet(f)?[]:f.load().then((function(){return f.queryAttachments(a[0].field(f.objectIdField),l.minsize,l.maxsize,l.types)}))}if(null===a[0])return[];throw new Error(\"Invalid Parameter\")}))},e.signatures.push({name:\"attachments\",min:\"1\",max:\"2\"}),e.functions.featuresetbyrelationshipname=function(t,r){return e.standardFunctionAsync(t,r,(function(e,r,n){o.pcCheck(n,2,4);var a=n[0],l=o.toString(n[1]),u=o.defaultUndefined(n[2],null),f=o.toBoolean(o.defaultUndefined(n[3],!0));if(null===u&&(u=[\"*\"]),!1===o.isArray(u))throw new Error(\"Invalid Parameter\");if(null===n[0])return null;if(!(n[0]instanceof i))throw new Error(\"Invalid Parameter\");var d=a._layer;return d instanceof I&&(d=s.constructFeatureSet(d,t.spatialReference,[\"*\"],!0,t.lrucache)),null===d?null:!1===o.isFeatureSet(d)?null:d.load().then((function(e){var r=e.relationshipMetaData().filter((function(e){return e.name===l}));if(0===r.length)return null;if(void 0!==r[0].relationshipTableId&&null!==r[0].relationshipTableId&&r[0].relationshipTableId>-1)return s.constructFeatureSetFromRelationship(e,r[0],a.field(e.objectIdField),e.spatialReference,u,f,t.lrucache);var n=e.serviceUrl();return n?(n=\"/\"===n.charAt(n.length-1)?n+r[0].relatedTableId.toString():n+\"/\"+r[0].relatedTableId.toString(),s.constructFeatureSetFromUrl(n,e.spatialReference,u,f,t.lrucache).then((function(t){return t.load().then((function(){return t.relationshipMetaData()})).then((function(n){if(n=n.filter((function(e){return e.id===r[0].id})),!1===a.hasField(r[0].keyField)||null===a.field(r[0].keyField))return e.getFeatureByObjectId(a.field(e.objectIdField),[r[0].keyField]).then((function(e){if(e){var a=S.WhereClause.create(n[0].keyField+\"= @id\",t.getFieldsIndex());return a.parameters={id:e.attributes[r[0].keyField]},t.filter(a)}return new p({parentfeatureset:t})}));var i=S.WhereClause.create(n[0].keyField+\"= @id\",t.getFieldsIndex());return i.parameters={id:a.field(r[0].keyField)},t.filter(i)}))}))):null}))}))},e.signatures.push({name:\"featuresetbyrelationshipname\",min:\"2\",max:\"4\"}),e.functions.featuresetbyassociation=function(t,r){return e.standardFunctionAsync(t,r,(function(e,r,n){o.pcCheck(n,2,3);var a=n[0],l=o.toString(o.defaultUndefined(n[1],\"\")).toLowerCase(),f=o.isString(n[2])?o.toString(n[2]):null;if(null===n[0])return null;if(!(n[0]instanceof i))throw new Error(\"Invalid Parameter\");var d=a._layer;return d instanceof I&&(d=s.constructFeatureSet(d,t.spatialReference,[\"*\"],!0,t.lrucache)),null===d?null:!1===o.isFeatureSet(d)?null:d.load().then((function(){var e=d.serviceUrl();return s.constructAssociationMetaDataFeatureSetFromUrl(e,t.spatialReference)})).then((function(e){var t=null,r=null,n=!1;if(null!==f&&\"\"!==f&&void 0!==f){for(var i=0,s=e.terminals;i<s.length;i++){var c=s[i];c.terminalName===f&&(r=c.terminalId)}null===r&&(n=!0)}for(var p=e.associations.getFieldsIndex(),m=p.get(\"TOGLOBALID\").name,g=p.get(\"FROMGLOBALID\").name,h=p.get(\"TOTERMINALID\").name,F=p.get(\"FROMTERMINALID\").name,v=p.get(\"FROMNETWORKSOURCEID\").name,I=p.get(\"TONETWORKSOURCEID\").name,A=p.get(\"ASSOCIATIONTYPE\").name,b=p.get(\"ISCONTENTVISIBLE\").name,D=p.get(\"OBJECTID\").name,w=0,x=d.fields;w<x.length;w++){var N=x[w];if(\"global-id\"===N.type){t=a.field(N.name);break}}var C=null,T=new u.SqlExpressionAdapted(new E({name:\"percentalong\",alias:\"percentalong\",type:\"double\"}),S.WhereClause.create(\"0\",e.associations.getFieldsIndex())),L=new u.SqlExpressionAdapted(new E({name:\"side\",alias:\"side\",type:\"string\"}),S.WhereClause.create(\"\\'\\'\",e.associations.getFieldsIndex())),R={};for(var k in e.lkp)R[k]=e.lkp[k].sourceId;var O=new u.StringToCodeAdapted(new E({name:\"classname\",alias:\"classname\",type:\"string\"}),null,R),W=\"\";switch(l){case\"midspan\":W=\"((\"+m+\"=\\'\"+t+\"\\') OR ( \"+g+\"=\\'\"+t+\"\\')) AND (\"+A+\" IN (5))\",O.codefield=S.WhereClause.create(\"CASE WHEN (\"+m+\"=\\'\"+t+\"\\') THEN \"+v+\" ELSE \"+I+\" END\",e.associations.getFieldsIndex());var P=y.cloneField(u.AdaptedFeatureSet.findField(e.associations.fields,g));P.name=\"globalid\",P.alias=\"globalid\",C=new u.SqlExpressionAdapted(P,S.WhereClause.create(\"CASE WHEN (\"+g+\"=\\'\"+t+\"\\') THEN \"+m+\" ELSE \"+g+\" END\",e.associations.getFieldsIndex())),T=e.unVersion>=4?new u.OriginalField(u.AdaptedFeatureSet.findField(e.associations.fields,p.get(\"PERCENTALONG\").name)):new u.SqlExpressionAdapted(new E({name:\"percentalong\",alias:\"percentalong\",type:\"double\"}),S.WhereClause.create(\"0\",e.associations.getFieldsIndex()));break;case\"junctionedge\":W=\"((\"+m+\"=\\'\"+t+\"\\') OR ( \"+g+\"=\\'\"+t+\"\\')) AND (\"+A+\" IN (4,6))\",O.codefield=S.WhereClause.create(\"CASE WHEN (\"+m+\"=\\'\"+t+\"\\') THEN \"+v+\" ELSE \"+I+\" END\",e.associations.getFieldsIndex());var M=y.cloneField(u.AdaptedFeatureSet.findField(e.associations.fields,g));M.name=\"globalid\",M.alias=\"globalid\",C=new u.SqlExpressionAdapted(M,S.WhereClause.create(\"CASE WHEN (\"+g+\"=\\'\"+t+\"\\') THEN \"+m+\" ELSE \"+g+\" END\",e.associations.getFieldsIndex())),L=new u.SqlExpressionAdapted(new E({name:\"side\",alias:\"side\",type:\"string\"}),S.WhereClause.create(\"CASE WHEN (\"+A+\"=4) THEN \\'from\\' ELSE \\'to\\' END\",e.associations.getFieldsIndex()));break;case\"connected\":var B=m+\"=\\'@T\\'\",U=g+\"=\\'@T\\'\";null!==r&&(B+=\" AND \"+h+\"=@A\",U+=\" AND \"+F+\"=@A\"),W=\"((\"+B+\") OR (\"+U+\"))\",W=o.multiReplace(W,\"@T\",t),B=o.multiReplace(B,\"@T\",t),null!==r&&(B=o.multiReplace(B,\"@A\",r.toString()),W=o.multiReplace(W,\"@A\",r.toString())),O.codefield=S.WhereClause.create(\"CASE WHEN \"+B+\" THEN \"+v+\" ELSE \"+I+\" END\",e.associations.getFieldsIndex());var G=y.cloneField(u.AdaptedFeatureSet.findField(e.associations.fields,g));G.name=\"globalid\",G.alias=\"globalid\",C=new u.SqlExpressionAdapted(G,S.WhereClause.create(\"CASE WHEN \"+B+\" THEN \"+g+\" ELSE \"+m+\" END\",e.associations.getFieldsIndex()));break;case\"container\":W=m+\"=\\'\"+t+\"\\' AND \"+A+\" = 2\",null!==r&&(W+=\" AND \"+h+\" = \"+r.toString()),O.codefield=v,W=\"( \"+W+\" )\",C=new u.FieldRename(u.AdaptedFeatureSet.findField(e.associations.fields,g),\"globalid\",\"globalid\");case\"content\":W=\"(\"+g+\"=\\'\"+t+\"\\' AND \"+A+\" = 2)\",null!==r&&(W+=\" AND \"+F+\" = \"+r.toString()),O.codefield=I,W=\"( \"+W+\" )\",C=new u.FieldRename(u.AdaptedFeatureSet.findField(e.associations.fields,m),\"globalid\",\"globalid\");break;case\"structure\":W=\"(\"+m+\"=\\'\"+t+\"\\' AND \"+A+\" = 3)\",null!==r&&(W+=\" AND \"+h+\" = \"+r.toString()),O.codefield=v,W=\"( \"+W+\" )\",C=new u.FieldRename(u.AdaptedFeatureSet.findField(e.associations.fields,g),\"globalid\",\"globalId\");break;case\"attached\":W=\"(\"+g+\"=\\'\"+t+\"\\' AND \"+A+\" = 3)\",null!==r&&(W+=\" AND \"+F+\" = \"+r.toString()),O.codefield=I,W=\"( \"+W+\" )\",C=new u.FieldRename(u.AdaptedFeatureSet.findField(e.associations.fields,m),\"globalid\",\"globalId\");break;default:throw new Error(\"Invalid Parameter\")}return n&&(W=\"1 <> 1\"),new u.AdaptedFeatureSet({parentfeatureset:e.associations,adaptedFields:[new u.OriginalField(u.AdaptedFeatureSet.findField(e.associations.fields,D)),new u.OriginalField(u.AdaptedFeatureSet.findField(e.associations.fields,b)),C,L,O,T],extraFilter:W?S.WhereClause.create(W,e.associations.getFieldsIndex()):null})}))}))},e.signatures.push({name:\"featuresetbyassociation\",min:\"2\",max:\"6\"}),e.functions.groupby=function(t,r){return e.standardFunctionAsync(t,r,(function(r,n,i){return o.pcCheck(i,3,3),o.isFeatureSet(i[0])?i[0].load().then((function(r){var n=[],l=[],s=!1,u=[];if(o.isString(i[1]))u.push(i[1]);else if(i[1]instanceof a)u.push(i[1]);else if(o.isArray(i[1]))u=i[1];else{if(!o.isImmutableArray(i[1]))return e.failDefferred(\"Illegal Value: GroupBy\");u=i[1].toArray()}for(var f=0,d=u;f<d.length;f++){var c=d[f];if(o.isString(c)){var p=S.WhereClause.create(o.toString(c),r.getFieldsIndex()),m=!0===h.isSingleField(p)?o.toString(c):\"%%%%FIELDNAME\";n.push({name:m,expression:p}),\"%%%%FIELDNAME\"===m&&(s=!0)}else{if(!(c instanceof a))return e.failDefferred(\"Illegal Value: GroupBy\");var g=c.hasField(\"name\")?c.field(\"name\"):\"%%%%FIELDNAME\";p=c.hasField(\"expression\")?c.field(\"expression\"):\"\";if(\"%%%%FIELDNAME\"===g&&(s=!0),!g)return e.failDefferred(\"Illegal Value: GroupBy\");n.push({name:g,expression:S.WhereClause.create(p||g,r.getFieldsIndex())})}}if(u=[],o.isString(i[2]))u.push(i[2]);else if(o.isArray(i[2]))u=i[2];else if(o.isImmutableArray(i[2]))u=i[2].toArray();else{if(!(i[2]instanceof a))return e.failDefferred(\"Illegal Value: GroupBy\");u.push(i[2])}for(var y=0,F=u;y<F.length;y++){if(!((c=F[y])instanceof a))return e.failDefferred(\"Illegal Value: GroupBy\");var I=c.hasField(\"name\")?c.field(\"name\"):\"\",E=c.hasField(\"statistic\")?c.field(\"statistic\"):\"\";p=c.hasField(\"expression\")?c.field(\"expression\"):\"\";if(!I||!E||!p)return e.failDefferred(\"Illegal Value: GroupBy\");l.push({name:I,statistic:E.toLowerCase(),expression:S.WhereClause.create(p,r.getFieldsIndex())})}if(s){for(var b={},D=0,w=r.fields;D<w.length;D++){b[(O=w[D]).name.toLowerCase()]=1}for(var x=0,N=n;x<N.length;x++){\"%%%%FIELDNAME\"!==(O=N[x]).name&&(b[O.name.toLowerCase()]=1)}for(var C=0,T=l;C<T.length;C++){\"%%%%FIELDNAME\"!==(O=T[C]).name&&(b[O.name.toLowerCase()]=1)}for(var L=0,R=0,k=n;R<k.length;R++){var O;if(\"%%%%FIELDNAME\"===(O=k[R]).name){for(;1===b[\"field_\"+L.toString()];)L++;b[\"field_\"+L.toString()]=1,O.name=\"FIELD_\"+L.toString()}}}for(var W=[],P=0,M=n;P<M.length;P++){var B=M[P];W.push(A(B.expression,e,t))}for(var U=0,G=l;U<G.length;U++){B=G[U];W.push(A(B.expression,e,t))}return W.length>0?v.all(W).then((function(){return v.resolve(i[0].groupby(n,l))})):v.resolve(i[0].groupby(n,l))})):e.failDefferred(\"Illegal Value: GroupBy\")}))},e.signatures.push({name:\"groupby\",min:\"3\",max:\"3\"}),e.functions.distinct=function(t,r){return e.standardFunctionAsync(t,r,(function(r,n,i){return o.isFeatureSet(i[0])?(o.pcCheck(i,2,2),i[0].load().then((function(r){var n=[],l=[];if(o.isString(i[1]))l.push(i[1]);else if(i[1]instanceof a)l.push(i[1]);else if(o.isArray(i[1]))l=i[1];else{if(!o.isImmutableArray(i[1]))return e.failDefferred(\"Illegal Value: GroupBy\");l=i[1].toArray()}for(var s=!1,u=0,f=l;u<f.length;u++){var d=f[u];if(o.isString(d)){var c=S.WhereClause.create(o.toString(d),r.getFieldsIndex()),p=!0===h.isSingleField(c)?o.toString(d):\"%%%%FIELDNAME\";n.push({name:p,expression:c}),\"%%%%FIELDNAME\"===p&&(s=!0)}else{if(!(d instanceof a))return e.failDefferred(\"Illegal Value: GroupBy\");var m=d.hasField(\"name\")?d.field(\"name\"):\"%%%%FIELDNAME\";c=d.hasField(\"expression\")?d.field(\"expression\"):\"\";if(\"%%%%FIELDNAME\"===m&&(s=!0),!m)return e.failDefferred(\"Illegal Value: GroupBy\");n.push({name:m,expression:S.WhereClause.create(c||m,r.getFieldsIndex())})}}if(s){for(var g={},y=0,F=r.fields;y<F.length;y++){g[(x=F[y]).name.toLowerCase()]=1}for(var I=0,E=n;I<E.length;I++){\"%%%%FIELDNAME\"!==(x=E[I]).name&&(g[x.name.toLowerCase()]=1)}for(var b=0,D=0,w=n;D<w.length;D++){var x;if(\"%%%%FIELDNAME\"===(x=w[D]).name){for(;1===g[\"field_\"+b.toString()];)b++;g[\"field_\"+b.toString()]=1,x.name=\"FIELD_\"+b.toString()}}}for(var N=[],C=0,T=n;C<T.length;C++){var L=T[C];N.push(A(L.expression,e,t))}return N.length>0?v.all(N).then((function(){return v.resolve(i[0].groupby(n,[]))})):v.resolve(i[0].groupby(n,[]))}))):function(e,t,r,n){if(1===n.length){if(o.isArray(n[0]))return F.calculateStat(e,n[0],-1);if(o.isImmutableArray(n[0]))return F.calculateStat(e,n[0].toArray(),-1)}return F.calculateStat(e,n,-1)}(\"distinct\",0,0,i)}))})}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/functions/featuresetbase.js?')},\"./node_modules/arcgis-js-api/arcade/functions/featuresetgeom.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../kernel */ \"./node_modules/arcgis-js-api/arcade/kernel.js\"),__webpack_require__(/*! ../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ../featureset/actions/SpatialFilter */ \"./node_modules/arcgis-js-api/arcade/featureset/actions/SpatialFilter.js\"),__webpack_require__(/*! ../featureset/sources/Empty */ \"./node_modules/arcgis-js-api/arcade/featureset/sources/Empty.js\"),__webpack_require__(/*! ../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../geometry/Geometry */ \"./node_modules/arcgis-js-api/geometry/Geometry.js\"),__webpack_require__(/*! ../../geometry/geometryEngineAsync */ \"./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,t,n,r,a,i,s,l,o){function u(e){return e instanceof l}function c(e,t,c,f,p){return p(e,t,(function(e,t,p){if(p.length<2)return f(new Error(\"Missing Parameters\"));if(null===(p=r.autoCastFeatureToGeometry(p))[0]&&null===p[1])return s.resolve(!1);if(r.isFeatureSet(p[0]))return p[1]instanceof l?s.resolve(new a({parentfeatureset:p[0],relation:c,relationGeom:p[1]})):null===p[1]?s.resolve(new i({parentfeatureset:p[0]})):f(\"Spatial Relation cannot accept this parameter type\");if(u(p[0])){if(u(p[1])){var d=null;switch(c){case\"esriSpatialRelEnvelopeIntersects\":d=o.intersects(n.shapeExtent(p[0]),n.shapeExtent(p[1]));break;case\"esriSpatialRelIntersects\":d=o.intersects(p[0],p[1]);break;case\"esriSpatialRelContains\":d=o.contains(p[0],p[1]);break;case\"esriSpatialRelOverlaps\":d=o.overlaps(p[0],p[1]);break;case\"esriSpatialRelWithin\":d=o.within(p[0],p[1]);break;case\"esriSpatialRelTouches\":d=o.touches(p[0],p[1]);break;case\"esriSpatialRelCrosses\":d=o.crosses(p[0],p[1])}return null!==d?d:s.reject(new Error(\"Unrecognised Relationship\"))}return r.isFeatureSet(p[1])?s.resolve(new a({parentfeatureset:p[1],relation:c,relationGeom:p[0]})):null===p[1]?s.resolve(!1):f(\"Spatial Relation cannot accept this parameter type\")}return null!==p[0]?f(\"Spatial Relation cannot accept this parameter type\"):r.isFeatureSet(p[1])?s.resolve(new i({parentfeatureset:p[1]})):p[1]instanceof l||null===p[1]?s.resolve(!1):void 0}))}Object.defineProperty(t,\"__esModule\",{value:!0}),t.registerFunctions=function(e){\"async\"===e.mode&&(e.functions.intersects=function(t,n){return c(t,n,\"esriSpatialRelIntersects\",e.failDefferred,e.standardFunctionAsync)},e.functions.envelopeintersects=function(t,n){return c(t,n,\"esriSpatialRelEnvelopeIntersects\",e.failDefferred,e.standardFunctionAsync)},e.signatures.push({name:\"envelopeintersects\",min:\"2\",max:\"2\"}),e.functions.contains=function(t,n){return c(t,n,\"esriSpatialRelContains\",e.failDefferred,e.standardFunctionAsync)},e.functions.overlaps=function(t,n){return c(t,n,\"esriSpatialRelOverlaps\",e.failDefferred,e.standardFunctionAsync)},e.functions.within=function(t,n){return c(t,n,\"esriSpatialRelWithin\",e.failDefferred,e.standardFunctionAsync)},e.functions.touches=function(t,n){return c(t,n,\"esriSpatialRelTouches\",e.failDefferred,e.standardFunctionAsync)},e.functions.crosses=function(t,n){return c(t,n,\"esriSpatialRelCrosses\",e.failDefferred,e.standardFunctionAsync)},e.functions.relate=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if(n=r.autoCastFeatureToGeometry(n),r.pcCheck(n,3,3),u(n[0])&&u(n[1]))return o.relate(n[0],n[1],r.toString(n[2]));if(n[0]instanceof l&&null===n[1])return!1;if(n[1]instanceof l&&null===n[0])return!1;if(r.isFeatureSet(n[0])&&null===n[1])return new i({parentfeatureset:n[0]});if(r.isFeatureSet(n[1])&&null===n[0])return new i({parentfeatureset:n[1]});if(r.isFeatureSet(n[0])&&n[1]instanceof l)return n[0].relate(n[1],r.toString(n[2]));if(r.isFeatureSet(n[1])&&n[0]instanceof l)return n[1].relate(n[0],r.toString(n[2]));if(null===n[0]&&null===n[1])return!1;throw new Error(\"Illegal Argument\")}))})}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/functions/featuresetgeom.js?')},\"./node_modules/arcgis-js-api/arcade/functions/featuresetstats.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ./fieldStats */ \"./node_modules/arcgis-js-api/arcade/functions/fieldStats.js\"),__webpack_require__(/*! ../../core/promiseUtils */ \"./node_modules/arcgis-js-api/core/promiseUtils.js\"),__webpack_require__(/*! ../../core/sql/WhereClause */ \"./node_modules/arcgis-js-api/core/sql/WhereClause.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(n,t,e,r,u,a){function i(n,t,i,o,s,f){if(1===o.length){if(e.isArray(o[0]))return u.resolve(r.calculateStat(n,o[0],e.defaultUndefined(o[1],-1)));if(e.isImmutableArray(o[0]))return u.resolve(r.calculateStat(n,o[0].toArray(),e.defaultUndefined(o[1],-1)))}else if(2===o.length){if(e.isArray(o[0]))return u.resolve(r.calculateStat(n,o[0],e.defaultUndefined(o[1],-1)));if(e.isImmutableArray(o[0]))return u.resolve(r.calculateStat(n,o[0].toArray(),e.defaultUndefined(o[1],-1)));if(e.isFeatureSet(o[0]))return o[0].load().then((function(r){return c(a.WhereClause.create(o[1],r.getFieldsIndex()),f,s).then((function(r){return o[0].calculateStatistic(n,r,e.defaultUndefined(o[2],1e3),t.abortSignal)}))}))}else if(3===o.length&&e.isFeatureSet(o[0]))return o[0].load().then((function(r){return c(a.WhereClause.create(o[1],r.getFieldsIndex()),f,s).then((function(r){return o[0].calculateStatistic(n,r,e.defaultUndefined(o[2],1e3),t.abortSignal)}))}));return u.resolve(r.calculateStat(n,o,-1))}function c(n,t,e){try{var r=n.getVariables();if(r.length>0){for(var a=[],i=0;i<r.length;i++){var c={name:r[i]};a.push(t.evaluateIdentifier(e,c))}return u.all(a).then((function(t){for(var e={},u=0;u<r.length;u++)e[r[u]]=t[u];return n.parameters=e,n}))}return u.resolve(n)}catch(n){return u.reject(n)}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.registerFunctions=function(n){\"async\"===n.mode&&(n.functions.stdev=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"stdev\",e,0,u,t,n)}))},n.functions.variance=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"variance\",e,0,u,t,n)}))},n.functions.average=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"mean\",e,0,u,t,n)}))},n.functions.mean=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"mean\",e,0,u,t,n)}))},n.functions.sum=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"sum\",e,0,u,t,n)}))},n.functions.min=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"min\",e,0,u,t,n)}))},n.functions.max=function(t,e){return n.standardFunctionAsync(t,e,(function(e,r,u){return i(\"max\",e,0,u,t,n)}))},n.functions.count=function(t,r){return n.standardFunctionAsync(t,r,(function(n,t,r){if(e.pcCheck(r,1,1),e.isFeatureSet(r[0]))return r[0].count(n.abortSignal);if(e.isArray(r[0])||e.isString(r[0]))return r[0].length;if(e.isImmutableArray(r[0]))return r[0].length();throw new Error(\"Invalid Parameters for Count\")}))})}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/functions/featuresetstats.js?')},\"./node_modules/arcgis-js-api/arcade/functions/featuresetstring.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! ../Dictionary */ \"./node_modules/arcgis-js-api/arcade/Dictionary.js\"),__webpack_require__(/*! ../Feature */ \"./node_modules/arcgis-js-api/arcade/Feature.js\"),__webpack_require__(/*! ../languageUtils */ \"./node_modules/arcgis-js-api/arcade/languageUtils.js\"),__webpack_require__(/*! ../featureset/support/shared */ \"./node_modules/arcgis-js-api/arcade/featureset/support/shared.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(n,e,t,r,o,a){function i(n){return n&&n.domain?\"coded-value\"===n.domain.type||\"codedValue\"===n.domain.type?t.convertObjectToArcadeDictionary({type:\"codedValue\",name:n.domain.name,dataType:a.layerFieldEsriConstants[n.field.type],codedValues:n.domain.codedValues.map((function(n){return{name:n.name,code:n.code}}))}):t.convertObjectToArcadeDictionary({type:\"range\",name:n.domain.name,dataType:a.layerFieldEsriConstants[n.field.type],min:n.domain.min,max:n.domain.max}):null}Object.defineProperty(e,\"__esModule\",{value:!0}),e.registerFunctions=function(n){\"async\"===n.mode&&(n.functions.domain=function(e,t){return n.standardFunctionAsync(e,t,(function(n,e,t){if(o.pcCheck(t,2,3),t[0]instanceof r)return i(t[0].fullDomain(o.toString(t[1]),void 0===t[2]?void 0:o.toNumber(t[2])));if(o.isFeatureSet(t[0]))return t[0]._ensureLoaded().then((function(){return i(o.getDomain(o.toString(t[1]),t[0],null,void 0===t[2]?void 0:o.toNumber(t[2])))}));throw new Error(\"Invalid Parameter\")}))},n.functions.subtypes=function(e,a){return n.standardFunctionAsync(e,a,(function(n,e,a){if(o.pcCheck(a,1,1),a[0]instanceof r){var i=a[0].subtypes();return i?t.convertObjectToArcadeDictionary(i):null}if(o.isFeatureSet(a[0]))return a[0]._ensureLoaded().then((function(){var n=a[0].subtypes();return n?t.convertObjectToArcadeDictionary(n):null}));throw new Error(\"Invalid Parameter\")}))},n.functions.domainname=function(e,t){return n.standardFunctionAsync(e,t,(function(n,e,t){if(o.pcCheck(t,2,4),t[0]instanceof r)return t[0].domainValueLookup(o.toString(t[1]),t[2],void 0===t[3]?void 0:o.toNumber(t[3]));if(o.isFeatureSet(t[0]))return t[0]._ensureLoaded().then((function(){var n=o.getDomain(o.toString(t[1]),t[0],null,void 0===t[3]?void 0:o.toNumber(t[3]));return o.getDomainValue(n,t[2])}));throw new Error(\"Invalid Parameter\")}))},n.signatures.push({name:\"domainname\",min:\"2\",max:\"4\"}),n.functions.domaincode=function(e,t){return n.standardFunctionAsync(e,t,(function(n,e,t){if(o.pcCheck(t,2,4),t[0]instanceof r)return t[0].domainCodeLookup(o.toString(t[1]),t[2],void 0===t[3]?void 0:o.toNumber(t[3]));if(o.isFeatureSet(t[0]))return t[0]._ensureLoaded().then((function(){var n=o.getDomain(o.toString(t[1]),t[0],null,void 0===t[3]?void 0:o.toNumber(t[3]));return o.getDomainCode(n,t[2])}));throw new Error(\"Invalid Parameter\")}))},n.signatures.push({name:\"domaincode\",min:\"2\",max:\"4\"})),n.functions.text=function(e,t){return n.standardFunctionAsync(e,t,(function(n,e,t){if(o.pcCheck(t,1,2),!o.isFeatureSet(t[0]))return o.toStringExplicit(t[0],t[1]);var r=o.defaultUndefined(t[1],\"\");return\"\"===r?t[0].castToText():\"schema\"===r.toLowerCase()?t[0].convertToText(\"schema\",n.abortSignal):\"featureset\"===r.toLowerCase()?t[0].convertToText(\"featureset\",n.abortSignal):void 0}))},n.functions.schema=function(e,a){return n.standardFunctionAsync(e,a,(function(n,e,a){if(o.pcCheck(a,1,1),o.isFeatureSet(a[0]))return a[0].load().then((function(){return t.convertObjectToArcadeDictionary(a[0].schema())}));if(a[0]instanceof r){var i=a[0].schema();return i?t.convertObjectToArcadeDictionary(i):null}throw new Error(\"Invalid Parameter\")}))}}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/arcade/functions/featuresetstring.js?')},\"./node_modules/arcgis-js-api/core/MD5.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function(r,t){Object.defineProperty(t,\"__esModule\",{value:!0}),t.outputTypes={Base64:0,Hex:1,String:2,Raw:3};function e(r,t){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}function n(r,t,n,u,o,a){return e((c=e(e(t,r),e(u,a)))<<(i=o)|c>>>32-i,n);var c,i}function u(r,t,e,u,o,a,c){return n(t&e|~t&u,r,t,o,a,c)}function o(r,t,e,u,o,a,c){return n(t&u|e&~u,r,t,o,a,c)}function a(r,t,e,u,o,a,c){return n(t^e^u,r,t,o,a,c)}function c(r,t,e,u,o,a,c){return n(e^(t|~u),r,t,o,a,c)}t.createMD5Hash=function(r,n){void 0===n&&(n=t.outputTypes.Hex);var i=n||t.outputTypes.Base64,f=function(r,t){r[t>>5]|=128<<t%32,r[14+(t+64>>>9<<4)]=t;for(var n=1732584193,i=-271733879,f=-1732584194,s=271733878,p=0;p<r.length;p+=16){var h=n,v=i,g=f,l=s;n=u(n,i,f,s,r[p+0],7,-680876936),s=u(s,n,i,f,r[p+1],12,-389564586),f=u(f,s,n,i,r[p+2],17,606105819),i=u(i,f,s,n,r[p+3],22,-1044525330),n=u(n,i,f,s,r[p+4],7,-176418897),s=u(s,n,i,f,r[p+5],12,1200080426),f=u(f,s,n,i,r[p+6],17,-1473231341),i=u(i,f,s,n,r[p+7],22,-45705983),n=u(n,i,f,s,r[p+8],7,1770035416),s=u(s,n,i,f,r[p+9],12,-1958414417),f=u(f,s,n,i,r[p+10],17,-42063),i=u(i,f,s,n,r[p+11],22,-1990404162),n=u(n,i,f,s,r[p+12],7,1804603682),s=u(s,n,i,f,r[p+13],12,-40341101),f=u(f,s,n,i,r[p+14],17,-1502002290),n=o(n,i=u(i,f,s,n,r[p+15],22,1236535329),f,s,r[p+1],5,-165796510),s=o(s,n,i,f,r[p+6],9,-1069501632),f=o(f,s,n,i,r[p+11],14,643717713),i=o(i,f,s,n,r[p+0],20,-373897302),n=o(n,i,f,s,r[p+5],5,-701558691),s=o(s,n,i,f,r[p+10],9,38016083),f=o(f,s,n,i,r[p+15],14,-660478335),i=o(i,f,s,n,r[p+4],20,-405537848),n=o(n,i,f,s,r[p+9],5,568446438),s=o(s,n,i,f,r[p+14],9,-1019803690),f=o(f,s,n,i,r[p+3],14,-187363961),i=o(i,f,s,n,r[p+8],20,1163531501),n=o(n,i,f,s,r[p+13],5,-1444681467),s=o(s,n,i,f,r[p+2],9,-51403784),f=o(f,s,n,i,r[p+7],14,1735328473),n=a(n,i=o(i,f,s,n,r[p+12],20,-1926607734),f,s,r[p+5],4,-378558),s=a(s,n,i,f,r[p+8],11,-2022574463),f=a(f,s,n,i,r[p+11],16,1839030562),i=a(i,f,s,n,r[p+14],23,-35309556),n=a(n,i,f,s,r[p+1],4,-1530992060),s=a(s,n,i,f,r[p+4],11,1272893353),f=a(f,s,n,i,r[p+7],16,-155497632),i=a(i,f,s,n,r[p+10],23,-1094730640),n=a(n,i,f,s,r[p+13],4,681279174),s=a(s,n,i,f,r[p+0],11,-358537222),f=a(f,s,n,i,r[p+3],16,-722521979),i=a(i,f,s,n,r[p+6],23,76029189),n=a(n,i,f,s,r[p+9],4,-640364487),s=a(s,n,i,f,r[p+12],11,-421815835),f=a(f,s,n,i,r[p+15],16,530742520),n=c(n,i=a(i,f,s,n,r[p+2],23,-995338651),f,s,r[p+0],6,-198630844),s=c(s,n,i,f,r[p+7],10,1126891415),f=c(f,s,n,i,r[p+14],15,-1416354905),i=c(i,f,s,n,r[p+5],21,-57434055),n=c(n,i,f,s,r[p+12],6,1700485571),s=c(s,n,i,f,r[p+3],10,-1894986606),f=c(f,s,n,i,r[p+10],15,-1051523),i=c(i,f,s,n,r[p+1],21,-2054922799),n=c(n,i,f,s,r[p+8],6,1873313359),s=c(s,n,i,f,r[p+15],10,-30611744),f=c(f,s,n,i,r[p+6],15,-1560198380),i=c(i,f,s,n,r[p+13],21,1309151649),n=c(n,i,f,s,r[p+4],6,-145523070),s=c(s,n,i,f,r[p+11],10,-1120210379),f=c(f,s,n,i,r[p+2],15,718787259),i=c(i,f,s,n,r[p+9],21,-343485551),n=e(n,h),i=e(i,v),f=e(f,g),s=e(s,l)}return[n,i,f,s]}(function(r){for(var t=[],e=0,n=8*r.length;e<n;e+=8)t[e>>5]|=(255&r.charCodeAt(e/8))<<e%32;return t}(r),8*r.length);switch(i){case t.outputTypes.Raw:return f;case t.outputTypes.Hex:return function(r){for(var t=\"0123456789abcdef\",e=[],n=0,u=4*r.length;n<u;n++)e.push(t.charAt(r[n>>2]>>n%4*8+4&15)+t.charAt(r[n>>2]>>n%4*8&15));return e.join(\"\")}(f);case t.outputTypes.String:return function(r){for(var t=[],e=0,n=32*r.length;e<n;e+=8)t.push(String.fromCharCode(r[e>>5]>>>e%32&255));return t.join(\"\")}(f);case t.outputTypes.Base64:return function(r){for(var t=[],e=0,n=4*r.length;e<n;e+=3)for(var u=(r[e>>2]>>e%4*8&255)<<16|(r[e+1>>2]>>(e+1)%4*8&255)<<8|r[e+2>>2]>>(e+2)%4*8&255,o=0;o<4;o++)8*e+6*o>32*r.length?t.push(\"=\"):t.push(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt(u>>6*(3-o)&63));return t.join(\"\")}(f)}}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/core/MD5.js?')},\"./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js\":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// COPYRIGHT © 2020 Esri\\n//\\n// All rights reserved under the copyright laws of the United States\\n// and applicable international laws, treaties, and conventions.\\n//\\n// This material is licensed for use under the Esri Master License\\n// Agreement (MLA), and is bound by the terms of that agreement.\\n// You may redistribute and use this code without modification,\\n// provided you adhere to the terms of the MLA and include this\\n// copyright notice.\\n//\\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\\n//\\n// For additional information, contact:\\n// Environmental Systems Research Institute, Inc.\\n// Attn: Contracts and Legal Services Department\\n// 380 New York Street\\n// Redlands, California, USA 92373\\n// USA\\n//\\n// email: contracts@esri.com\\n//\\n// See http://js.arcgis.com/4.16/esri/copyright.txt for details.\\n\\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__.dj.c(module.i),exports,__webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.js\"),__webpack_require__(/*! ../geometry */ \"./node_modules/arcgis-js-api/geometry.js\"),__webpack_require__(/*! ../core/workers */ \"./node_modules/arcgis-js-api/core/workers.js\")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(e,n,t,r,i){function o(e){var n;return Array.isArray(e)?null===(n=e[0])||void 0===n?void 0:n.spatialReference:null==e?void 0:e.spatialReference}function u(e){return e?Array.isArray(e)?e.map(u):e.toJSON?e.toJSON():e:e}function a(e){return Array.isArray(e)?e.map((function(e){return r.fromJSON(e)})):r.fromJSON(e)}var c;function s(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(e){return c||(c=i.open(\"geometryEngineWorker\",{strategy:\"distributed\"})),[2,c]}))}))}function f(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return[2,t.sent().invoke(\"executeGEOperation\",{operation:e,parameters:u(n)})]}}))}))}function l(e){return\"xmin\"in e?e.center:\"x\"in e?e:e.extent.center}Object.defineProperty(n,\"__esModule\",{value:!0}),n.extendedSpatialReferenceInfo=function(e){return f(\"extendedSpatialReferenceInfo\",[e])},n.clip=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"clip\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.cut=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"cut\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.contains=function(e,n){return f(\"contains\",[o(e),e,n])},n.crosses=function(e,n){return f(\"crosses\",[o(e),e,n])},n.distance=function(e,n,t){return f(\"distance\",[o(e),e,n,t])},n.equals=function(e,n){return f(\"equals\",[o(e),e,n])},n.intersects=function(e,n){return f(\"intersects\",[o(e),e,n])},n.touches=function(e,n){return f(\"touches\",[o(e),e,n])},n.within=function(e,n){return f(\"within\",[o(e),e,n])},n.disjoint=function(e,n){return f(\"disjoint\",[o(e),e,n])},n.overlaps=function(e,n){return f(\"overlaps\",[o(e),e,n])},n.relate=function(e,n,t){return f(\"relate\",[o(e),e,n,t])},n.isSimple=function(e){return f(\"isSimple\",[o(e),e])},n.simplify=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(n){switch(n.label){case 0:return[4,f(\"simplify\",[o(e),e])];case 1:return[2,a(n.sent())]}}))}))},n.convexHull=function(e,n){return void 0===n&&(n=!1),t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"convexHull\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.difference=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"difference\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.symmetricDifference=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"symmetricDifference\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.intersect=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"intersect\",[o(e),e,n])];case 1:return[2,a(t.sent())]}}))}))},n.union=function(e,n){return void 0===n&&(n=null),t.__awaiter(this,void 0,void 0,(function(){var r;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"union\",[o(r=function(e,n){var t;return Array.isArray(e)?t=e:((t=[]).push(e),null!=n&&t.push(n)),t}(e,n)),r])];case 1:return[2,a(t.sent())]}}))}))},n.offset=function(e,n,r,i,u,c){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"offset\",[o(e),e,n,r,i,u,c])];case 1:return[2,a(t.sent())]}}))}))},n.buffer=function(e,n,r,i){return void 0===i&&(i=!1),t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"buffer\",[o(e),e,n,r,i])];case 1:return[2,a(t.sent())]}}))}))},n.geodesicBuffer=function(e,n,r,i,u,c){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"geodesicBuffer\",[o(e),e,n,r,i,u,c])];case 1:return[2,a(t.sent())]}}))}))},n.nearestCoordinate=function(e,n,i){return void 0===i&&(i=!0),t.__awaiter(this,void 0,void 0,(function(){var u;return t.__generator(this,(function(a){switch(a.label){case 0:return[4,f(\"nearestCoordinate\",[o(e),e,n,i])];case 1:return u=a.sent(),[2,t.__assign(t.__assign({},u),{coordinate:r.Point.fromJSON(u.coordinate)})]}}))}))},n.nearestVertex=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var i;return t.__generator(this,(function(u){switch(u.label){case 0:return[4,f(\"nearestVertex\",[o(e),e,n])];case 1:return i=u.sent(),[2,t.__assign(t.__assign({},i),{coordinate:r.Point.fromJSON(i.coordinate)})]}}))}))},n.nearestVertices=function(e,n,i,u){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(a){switch(a.label){case 0:return[4,f(\"nearestVertices\",[o(e),e,n,i,u])];case 1:return[2,a.sent().map((function(e){return t.__assign(t.__assign({},e),{coordinate:r.Point.fromJSON(e.coordinate)})}))]}}))}))},n.rotate=function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,u,a;return t.__generator(this,(function(t){switch(t.label){case 0:if(null==e)throw new Error(\"Illegal Argument Exception\");return i=e.spatialReference,r=null!=r?r:l(e),a=(u=e.constructor).fromJSON,[4,f(\"rotate\",[i,e,n,r])];case 1:return(o=a.apply(u,[t.sent()])).spatialReference=i,[2,o]}}))}))},n.flipHorizontal=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,u;return t.__generator(this,(function(t){switch(t.label){case 0:if(null==e)throw new Error(\"Illegal Argument Exception\");return r=e.spatialReference,n=null!=n?n:l(e),u=(o=e.constructor).fromJSON,[4,f(\"flipHorizontal\",[r,e,n])];case 1:return(i=u.apply(o,[t.sent()])).spatialReference=r,[2,i]}}))}))},n.flipVertical=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,u;return t.__generator(this,(function(t){switch(t.label){case 0:if(null==e)throw new Error(\"Illegal Argument Exception\");return r=e.spatialReference,n=null!=n?n:l(e),u=(o=e.constructor).fromJSON,[4,f(\"flipVertical\",[r,e,n])];case 1:return(i=u.apply(o,[t.sent()])).spatialReference=r,[2,i]}}))}))},n.generalize=function(e,n,r,i){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"generalize\",[o(e),e,n,r,i])];case 1:return[2,a(t.sent())]}}))}))},n.densify=function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"densify\",[o(e),e,n,r])];case 1:return[2,a(t.sent())]}}))}))},n.geodesicDensify=function(e,n,r,i){return void 0===i&&(i=0),t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,f(\"geodesicDensify\",[o(e),e,n,r,i])];case 1:return[2,a(t.sent())]}}))}))},n.planarArea=function(e,n){return f(\"planarArea\",[o(e),e,n])},n.planarLength=function(e,n){return f(\"planarLength\",[o(e),e,n])},n.geodesicArea=function(e,n,t){return f(\"geodesicArea\",[o(e),e,n,t])},n.geodesicLength=function(e,n,t){return f(\"geodesicLength\",[o(e),e,n,t])}}).apply(null, __WEBPACK_AMD_DEFINE_ARRAY__),\\n\\t\\t\\t\\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\\n\\n//# sourceURL=webpack:///./node_modules/arcgis-js-api/geometry/geometryEngineAsync.js?')}}]);","extractedComments":[]}